{"config":{"lang":["en"],"separator":"[\\s\\-\\.]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#claude-code-media-generator","title":"Claude Code Media Generator","text":"<p> AI-Powered Video &amp; Image Generation </p> <p> Create stunning videos and images using Google Veo &amp; Imagen APIs </p> <p>\ud83d\udea7 Under Development</p> <p>Core features are production-ready. Currently focusing on documentation improvements and planned features design.</p> <p>Get Started  View on GitHub  Documentation </p>"},{"location":"#why-claude-code-media-generator","title":"Why Claude Code Media Generator?","text":"<ul> <li> <p> 8 Video Generation Modes</p> <p>From text-to-video to advanced video extension, style transfer, and object manipulation. All powered by Google Veo 3.1.</p> <p> Explore all modes</p> </li> <li> <p> Reference Image System</p> <p>Use up to 3 reference images for subject preservation or apply style transfer from any image.</p> <p> Learn more</p> </li> <li> <p> Cloud-Native Architecture</p> <p>Direct GCS storage integration. Auto-upload for seamless video extension workflows.</p> <p> GCS Setup Guide</p> </li> <li> <p> Smart Presets</p> <p>Quick, Quality, Extend, Budget \u2014 choose the right balance of speed, quality, and cost.</p> <p> View presets</p> </li> </ul>"},{"location":"#video-generation-modes","title":"Video Generation Modes","text":"<ul> <li> <p> Text-to-Video</p> <p>Generate video from text prompt only</p> </li> <li> <p> Image-to-Video</p> <p>Animate a single image with AI</p> </li> <li> <p> First &amp; Last Frames</p> <p>Interpolate between two keyframes</p> </li> <li> <p> Video Extension</p> <p>Add 7 more seconds to any video</p> </li> <li> <p> Reference Asset</p> <p>Preserve subject across generations</p> </li> <li> <p> Reference Style</p> <p>Apply artistic style from an image</p> </li> <li> <p> Insert Objects</p> <p>Add objects using mask (Veo 3.1)</p> </li> <li> <p> Remove Objects</p> <p>Remove objects using mask (Veo 3.1)</p> </li> </ul> <p> View all 8 modes in detail</p>"},{"location":"#quick-start","title":"Quick Start","text":"Skill (Recommended) Script <p>The easiest way - use the <code>/generative</code> skill in Claude Code:</p> <pre><code># Generate an image\n/generative image \"A beautiful sunset over mountains\"\n\n# Generate a video\n/generative video \"Ocean waves crashing on the beach\"\n\n# With options\n/generative video \"Cinematic sunset\" --preset quality\n</code></pre> <p> Learn more about Skills</p> <p>For automation and advanced users:</p> <pre><code># Option 1: Environment variable\nexport GOOGLE_API_KEY=\"your-api-key\"\n\n# Generate video\npython video_gen.py \"A cat playing in a sunlit garden\"\n\n# With quality preset\npython video_gen.py \"Cinematic sunset over mountains\" --preset quality\n</code></pre> <p> Advanced Usage</p>"},{"location":"#important-gcs-bucket-naming","title":"Important: GCS Bucket Naming","text":"<p>Mandatory Naming Convention</p> <p>When using Vertex AI API Key, your GCS bucket MUST follow this exact pattern:</p> <pre><code>gs://YOUR_PROJECT_ID-media-output/\n</code></pre> <p>Using any other bucket name will result in permission denied errors. This is a security boundary enforced by Vertex AI.</p> <p>Example:</p> <pre><code># \u2705 Correct pattern\n--storage-uri \"gs://gen-lang-client-0344941103-media-output/videos/\"\n\n# \u274c Wrong - will fail\n--storage-uri \"gs://my-custom-bucket/videos/\"\n</code></pre> <p> Full GCS Setup Guide</p>"},{"location":"#pricing-overview","title":"Pricing Overview","text":"Model Type Price/Second 5-sec Video veo-3.1-generate-preview Standard $0.35 $1.75 veo-3.1-fast-generate-preview Fast $0.15 $0.75 veo-3.0-generate-preview Previous Gen $0.25 $1.25 veo-2.0-generate-preview Legacy $0.35 $1.75 <p>Cost Saving Tip</p> <p>Use <code>--preset budget</code> to automatically select the most cost-effective model for your use case.</p>"},{"location":"#project-status","title":"Project Status","text":"Component Version Status video_gen.py v2.27  Production Ready image_gen.py v1.4  Stable check_api.py v2.1  Stable Documentation v3.10  Updated Claude Code Skill v3.2.1  Available Agent v1.0  Available MCP Server \u2014  Planned"},{"location":"#development-roadmap","title":"Development Roadmap","text":"<ul> <li> <p> Phase 1: Core Features \u2705</p> <ul> <li>8 video generation modes</li> <li>Image generation (Imagen/Gemini)</li> <li>Smart validation &amp; auto-correction</li> <li>GCS storage integration</li> </ul> </li> <li> <p> Phase 2: Enhanced Workflows \u2705</p> <ul> <li>Video extension from URLs</li> <li>Auto FPS conversion (24fps)</li> <li>Reference image system</li> <li>Smart defaults from metadata</li> </ul> </li> <li> <p> Phase 3: Claude Code \u2705</p> <ul> <li><code>/generative</code> unified skill</li> <li>Help system (5 topics)</li> <li>Config wizard</li> <li>Agent for auto-detection</li> </ul> </li> <li> <p> Phase 4: Planned Features</p> <ul> <li>Remix Mode (<code>--remix video.mp4</code>)</li> <li>Outpainting (<code>--outpaint left,right</code>)</li> <li>Camera Control (<code>--camera pan-left</code>)</li> <li>Audio Control (style/mood)</li> </ul> </li> </ul>"},{"location":"#explore-documentation","title":"Explore Documentation","text":"<ul> <li> <p> Using Skills</p> <p>The easiest way to generate media - <code>/generative</code> skill for Claude Code.</p> <p> Start with Skills</p> </li> <li> <p> Getting Started</p> <p>Installation, authentication setup, and creating your first video in minutes.</p> <p> Get Started</p> </li> <li> <p> Video Generation</p> <p>All 8 modes, model comparison, reference images, and advanced features.</p> <p> Video docs</p> </li> <li> <p> Image Generation</p> <p>Text-to-image with Gemini &amp; Imagen models, aspect ratios, and templates.</p> <p> Image docs</p> </li> <li> <p> Advanced Usage</p> <p>Direct scripts, automation, CI/CD integration for power users.</p> <p> Advanced docs</p> </li> <li> <p> Guides</p> <p>GCS storage, presets, troubleshooting, and more.</p> <p> View guides</p> </li> </ul>"},{"location":"#star-history","title":"Star History","text":"<p>Made with  using Google Vertex AI</p> <p>Star on GitHub  Report Issue </p>"},{"location":"advanced/","title":"Advanced Usage","text":"<p>For power users, automation, and CI/CD integration.</p>"},{"location":"advanced/#when-to-use-direct-scripts","title":"When to Use Direct Scripts","text":"<p>While the <code>/generative</code> skill is recommended for most users, direct scripts are better for:</p> Use Case Why Use Scripts Automation Shell scripts, cron jobs, batch processing CI/CD GitHub Actions, Jenkins, automated pipelines Custom Workflows Complex multi-step processes Headless Servers No Claude Code available Fine-Grained Control Specific parameters for each call"},{"location":"advanced/#available-scripts","title":"Available Scripts","text":"Script Purpose Documentation <code>video_gen.py</code> Video generation CLI video_gen.py Reference <code>image_gen.py</code> Image generation CLI image_gen.py Reference <code>check_api.py</code> API verification tool check_api.py Reference"},{"location":"advanced/#quick-comparison","title":"Quick Comparison","text":""},{"location":"advanced/#skill-recommended-for-interactive-use","title":"Skill (Recommended for Interactive Use)","text":"<pre><code>/generative video \"A sunset over the ocean\"\n</code></pre>"},{"location":"advanced/#script-for-automation","title":"Script (For Automation)","text":"<pre><code>python video_gen.py \"A sunset over the ocean\" \\\n  --model veo-3.1-generate-preview \\\n  --duration 8 \\\n  --aspect-ratio 16:9 \\\n  --preset quality\n</code></pre>"},{"location":"advanced/#basic-script-usage","title":"Basic Script Usage","text":""},{"location":"advanced/#video-generation","title":"Video Generation","text":"<pre><code># Simple text-to-video\npython video_gen.py \"A cat playing in a garden\"\n\n# With options\npython video_gen.py \"A cat playing in a garden\" \\\n  --model veo-3.1-generate-preview \\\n  --duration 8 \\\n  --preset quality\n</code></pre>"},{"location":"advanced/#image-generation","title":"Image Generation","text":"<pre><code># Simple text-to-image\npython image_gen.py \"A futuristic city at sunset\"\n\n# With options\npython image_gen.py \"A futuristic city at sunset\" \\\n  --aspect-ratio 16:9 \\\n  --image-size 2K\n</code></pre>"},{"location":"advanced/#api-check","title":"API Check","text":"<pre><code># Verify API connectivity\npython check_api.py --key \"$GOOGLE_API_KEY\"\n\n# List available models\npython check_api.py --key \"$GOOGLE_API_KEY\" --list-models\n</code></pre>"},{"location":"advanced/#environment-setup","title":"Environment Setup","text":""},{"location":"advanced/#required-environment-variables","title":"Required Environment Variables","text":"<pre><code># Set API key\nexport GOOGLE_API_KEY=\"AIzaSy...\"\n\n# Optional: GCS storage\nexport GCS_STORAGE_URI=\"gs://my-project-media-output/videos/\"\n\n# Optional: Project ID (for Vertex AI)\nexport GOOGLE_CLOUD_PROJECT=\"my-project-123\"\n</code></pre>"},{"location":"advanced/#using-configjson","title":"Using config.json","text":"<p>Create <code>config.json</code> in your working directory:</p> <pre><code>{\n  \"api_key\": \"AIzaSy...\",\n  \"project_id\": \"my-project-123\",\n  \"storage_uri\": \"gs://my-project-media-output/videos/\"\n}\n</code></pre>"},{"location":"advanced/#automation-examples","title":"Automation Examples","text":""},{"location":"advanced/#bash-script","title":"Bash Script","text":"<pre><code>#!/bin/bash\n# generate_batch.sh\n\nPROMPTS=(\n  \"A sunrise over mountains\"\n  \"Ocean waves at sunset\"\n  \"City skyline at night\"\n)\n\nfor prompt in \"${PROMPTS[@]}\"; do\n  python video_gen.py \"$prompt\" --preset quick\n  sleep 5  # Rate limiting\ndone\n</code></pre>"},{"location":"advanced/#python-script","title":"Python Script","text":"<pre><code>#!/usr/bin/env python3\n# batch_generate.py\n\nimport subprocess\nimport time\n\nprompts = [\n    \"A sunrise over mountains\",\n    \"Ocean waves at sunset\",\n    \"City skyline at night\",\n]\n\nfor prompt in prompts:\n    subprocess.run([\n        \"python\", \"video_gen.py\",\n        prompt,\n        \"--preset\", \"quick\"\n    ])\n    time.sleep(5)  # Rate limiting\n</code></pre>"},{"location":"advanced/#github-actions","title":"GitHub Actions","text":"<pre><code># .github/workflows/generate-videos.yml\nname: Generate Videos\n\non:\n  workflow_dispatch:\n    inputs:\n      prompt:\n        description: 'Video prompt'\n        required: true\n\njobs:\n  generate:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Set up Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.11'\n\n      - name: Install dependencies\n        run: pip install requests google-auth\n\n      - name: Generate video\n        env:\n          GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}\n        run: |\n          python video_gen.py \"${{ inputs.prompt }}\" --preset quick\n\n      - name: Upload artifact\n        uses: actions/upload-artifact@v4\n        with:\n          name: generated-video\n          path: generated_videos/\n</code></pre>"},{"location":"advanced/#advanced-features","title":"Advanced Features","text":""},{"location":"advanced/#video-extension-pipeline","title":"Video Extension Pipeline","text":"<pre><code># Step 1: Generate initial video\npython video_gen.py \"Opening scene of a story\" \\\n  --storage-uri \"gs://my-project-media-output/videos/\"\n\n# Step 2: Extend the video\npython video_gen.py \"Continue the story\" \\\n  --mode extend \\\n  --video \"gs://my-project-media-output/videos/video_001.mp4\" \\\n  --storage-uri \"gs://my-project-media-output/videos/\"\n</code></pre>"},{"location":"advanced/#reference-image-workflow","title":"Reference Image Workflow","text":"<pre><code># Generate with subject preservation\npython video_gen.py \"This character walking in a park\" \\\n  --mode reference_asset \\\n  --reference-image ./character.png\n</code></pre>"},{"location":"advanced/#batch-processing-with-logging","title":"Batch Processing with Logging","text":"<pre><code>#!/bin/bash\n# batch_with_logging.sh\n\nLOG_FILE=\"generation_log.txt\"\nTIMESTAMP=$(date +%Y%m%d_%H%M%S)\n\necho \"=== Batch Generation Started: $TIMESTAMP ===\" &gt;&gt; $LOG_FILE\n\nwhile IFS= read -r prompt; do\n  echo \"Generating: $prompt\" &gt;&gt; $LOG_FILE\n  python video_gen.py \"$prompt\" --preset quick 2&gt;&amp;1 &gt;&gt; $LOG_FILE\n  echo \"---\" &gt;&gt; $LOG_FILE\ndone &lt; prompts.txt\n\necho \"=== Batch Complete ===\" &gt;&gt; $LOG_FILE\n</code></pre>"},{"location":"advanced/#error-handling","title":"Error Handling","text":""},{"location":"advanced/#common-exit-codes","title":"Common Exit Codes","text":"Code Meaning Action <code>0</code> Success Continue <code>1</code> General error Check logs <code>2</code> Invalid arguments Check command <code>3</code> API error Check API key/quota <code>4</code> File not found Check paths"},{"location":"advanced/#retry-logic","title":"Retry Logic","text":"<pre><code>#!/bin/bash\n# retry_generation.sh\n\nMAX_RETRIES=3\nRETRY_DELAY=10\n\nfor i in $(seq 1 $MAX_RETRIES); do\n  python video_gen.py \"$1\" --preset quick\n  if [ $? -eq 0 ]; then\n    echo \"Success!\"\n    exit 0\n  fi\n  echo \"Attempt $i failed, retrying in ${RETRY_DELAY}s...\"\n  sleep $RETRY_DELAY\ndone\n\necho \"All attempts failed\"\nexit 1\n</code></pre>"},{"location":"advanced/#performance-tips","title":"Performance Tips","text":""},{"location":"advanced/#1-use-presets","title":"1. Use Presets","text":"<pre><code># Quick tests\npython video_gen.py \"test\" --preset quick\n\n# Final production\npython video_gen.py \"final\" --preset quality\n</code></pre>"},{"location":"advanced/#2-rate-limiting","title":"2. Rate Limiting","text":"<pre><code># Add delays between requests\nsleep 5  # 5 seconds between calls\n</code></pre>"},{"location":"advanced/#3-parallel-processing-with-caution","title":"3. Parallel Processing (with caution)","text":"<pre><code># Run multiple generations in parallel\npython video_gen.py \"prompt 1\" --preset quick &amp;\npython video_gen.py \"prompt 2\" --preset quick &amp;\nwait\n</code></pre> <p>API Rate Limits</p> <p>Be mindful of API rate limits when running parallel requests. Check your quota in Google Cloud Console.</p>"},{"location":"advanced/#next-steps","title":"Next Steps","text":"<ul> <li>video_gen.py Reference - Full video CLI documentation</li> <li>image_gen.py Reference - Full image CLI documentation</li> <li>check_api.py Reference - API verification tool</li> <li>Automation Guide - Detailed automation patterns</li> </ul>"},{"location":"advanced/automation/","title":"Automation Guide","text":"<p>Complete guide to automating video and image generation.</p>"},{"location":"advanced/automation/#overview","title":"Overview","text":"<p>This guide covers automation patterns for:</p> <ul> <li>Batch processing</li> <li>CI/CD integration</li> <li>Scheduled generation</li> <li>Error handling and monitoring</li> </ul>"},{"location":"advanced/automation/#prerequisites","title":"Prerequisites","text":"<p>Before automating, ensure:</p> <ol> <li>Scripts installed - <code>video_gen.py</code>, <code>image_gen.py</code> in working directory</li> <li>Dependencies - <code>pip install requests google-auth</code></li> <li>API configured - <code>config.json</code> or environment variables</li> <li>API quota - Sufficient quota for planned workload</li> </ol>"},{"location":"advanced/automation/#batch-processing","title":"Batch Processing","text":""},{"location":"advanced/automation/#simple-batch-script","title":"Simple Batch Script","text":"<pre><code>#!/bin/bash\n# batch_generate.sh\n\nset -e  # Exit on error\n\nPROMPTS_FILE=\"${1:-prompts.txt}\"\nOUTPUT_DIR=\"${2:-generated_videos}\"\n\nmkdir -p \"$OUTPUT_DIR\"\n\nwhile IFS= read -r prompt; do\n  echo \"Generating: $prompt\"\n  python video_gen.py \"$prompt\" \\\n    --preset quick \\\n    --output-dir \"$OUTPUT_DIR\"\n  sleep 5  # Rate limiting\ndone &lt; \"$PROMPTS_FILE\"\n\necho \"Batch complete!\"\n</code></pre> <p>Usage: <pre><code>chmod +x batch_generate.sh\n./batch_generate.sh prompts.txt output/\n</code></pre></p>"},{"location":"advanced/automation/#promptstxt-example","title":"prompts.txt Example","text":"<pre><code>A sunrise over mountains, cinematic, warm colors\nOcean waves crashing on rocks, slow motion\nCity skyline at night, timelapse style\n</code></pre>"},{"location":"advanced/automation/#python-automation","title":"Python Automation","text":""},{"location":"advanced/automation/#basic-automation-script","title":"Basic Automation Script","text":"<pre><code>#!/usr/bin/env python3\n\"\"\"batch_automation.py - Automated video generation\"\"\"\n\nimport subprocess\nimport time\nimport json\nimport logging\nfrom pathlib import Path\nfrom datetime import datetime\n\n# Setup logging\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(levelname)s - %(message)s',\n    handlers=[\n        logging.FileHandler('automation.log'),\n        logging.StreamHandler()\n    ]\n)\n\ndef generate_video(prompt: str, preset: str = \"quick\") -&gt; bool:\n    \"\"\"Generate a video and return success status.\"\"\"\n    try:\n        result = subprocess.run(\n            [\"python\", \"video_gen.py\", prompt, \"--preset\", preset],\n            capture_output=True,\n            text=True,\n            timeout=300  # 5 minute timeout\n        )\n\n        if result.returncode == 0:\n            logging.info(f\"Success: {prompt[:50]}...\")\n            return True\n        else:\n            logging.error(f\"Failed: {result.stderr}\")\n            return False\n\n    except subprocess.TimeoutExpired:\n        logging.error(f\"Timeout: {prompt[:50]}...\")\n        return False\n    except Exception as e:\n        logging.error(f\"Error: {e}\")\n        return False\n\ndef process_batch(prompts: list, rate_limit: int = 5) -&gt; dict:\n    \"\"\"Process a batch of prompts with rate limiting.\"\"\"\n    results = {\"success\": 0, \"failed\": 0, \"prompts\": []}\n\n    for i, prompt in enumerate(prompts, 1):\n        logging.info(f\"Processing {i}/{len(prompts)}\")\n\n        success = generate_video(prompt)\n        results[\"prompts\"].append({\n            \"prompt\": prompt,\n            \"success\": success,\n            \"timestamp\": datetime.now().isoformat()\n        })\n\n        if success:\n            results[\"success\"] += 1\n        else:\n            results[\"failed\"] += 1\n\n        # Rate limiting\n        if i &lt; len(prompts):\n            time.sleep(rate_limit)\n\n    return results\n\ndef main():\n    # Load prompts\n    prompts = [\n        \"A sunrise over mountains, cinematic\",\n        \"Ocean waves at golden hour\",\n        \"City traffic timelapse, night\"\n    ]\n\n    # Process batch\n    results = process_batch(prompts)\n\n    # Save results\n    with open(\"results.json\", \"w\") as f:\n        json.dump(results, f, indent=2)\n\n    logging.info(f\"Complete: {results['success']} success, {results['failed']} failed\")\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"advanced/automation/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"advanced/automation/#github-actions","title":"GitHub Actions","text":"<pre><code># .github/workflows/video-generation.yml\nname: Video Generation Pipeline\n\non:\n  workflow_dispatch:\n    inputs:\n      prompts:\n        description: 'JSON array of prompts'\n        required: true\n        default: '[\"A sunset\", \"Ocean waves\"]'\n      preset:\n        description: 'Generation preset'\n        required: false\n        default: 'quick'\n        type: choice\n        options:\n          - quick\n          - quality\n          - budget\n\njobs:\n  generate:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n\n      - name: Setup Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.11'\n\n      - name: Install dependencies\n        run: |\n          pip install requests google-auth\n\n      - name: Generate videos\n        env:\n          GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}\n        run: |\n          echo '${{ inputs.prompts }}' | jq -r '.[]' | while read prompt; do\n            echo \"Generating: $prompt\"\n            python video_gen.py \"$prompt\" --preset ${{ inputs.preset }}\n            sleep 5\n          done\n\n      - name: Upload artifacts\n        uses: actions/upload-artifact@v4\n        with:\n          name: generated-videos\n          path: generated_videos/\n          retention-days: 7\n</code></pre>"},{"location":"advanced/automation/#jenkins-pipeline","title":"Jenkins Pipeline","text":"<pre><code>// Jenkinsfile\npipeline {\n    agent any\n\n    environment {\n        GOOGLE_API_KEY = credentials('google-api-key')\n    }\n\n    parameters {\n        text(name: 'PROMPTS', defaultValue: 'A sunset\\nOcean waves', description: 'One prompt per line')\n        choice(name: 'PRESET', choices: ['quick', 'quality', 'budget'], description: 'Generation preset')\n    }\n\n    stages {\n        stage('Setup') {\n            steps {\n                sh 'pip install requests google-auth'\n            }\n        }\n\n        stage('Generate') {\n            steps {\n                script {\n                    def prompts = params.PROMPTS.split('\\n')\n                    prompts.each { prompt -&gt;\n                        sh \"\"\"\n                            python video_gen.py \"${prompt}\" --preset ${params.PRESET}\n                            sleep 5\n                        \"\"\"\n                    }\n                }\n            }\n        }\n\n        stage('Archive') {\n            steps {\n                archiveArtifacts artifacts: 'generated_videos/*', fingerprint: true\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"advanced/automation/#scheduled-generation","title":"Scheduled Generation","text":""},{"location":"advanced/automation/#cron-job-linuxmacos","title":"Cron Job (Linux/macOS)","text":"<pre><code># Edit crontab\ncrontab -e\n\n# Add scheduled generation (daily at 2 AM)\n0 2 * * * /path/to/batch_generate.sh /path/to/prompts.txt &gt;&gt; /var/log/video_gen.log 2&gt;&amp;1\n</code></pre>"},{"location":"advanced/automation/#systemd-timer-linux","title":"Systemd Timer (Linux)","text":"<pre><code># /etc/systemd/system/video-gen.timer\n[Unit]\nDescription=Daily Video Generation\n\n[Timer]\nOnCalendar=daily\nPersistent=true\n\n[Install]\nWantedBy=timers.target\n</code></pre> <pre><code># /etc/systemd/system/video-gen.service\n[Unit]\nDescription=Video Generation Service\n\n[Service]\nType=oneshot\nExecStart=/path/to/batch_generate.sh\nUser=your-user\nEnvironment=GOOGLE_API_KEY=your-key\nWorkingDirectory=/path/to/project\n</code></pre>"},{"location":"advanced/automation/#windows-task-scheduler","title":"Windows Task Scheduler","text":"<pre><code># Create scheduled task\n$action = New-ScheduledTaskAction -Execute \"python\" `\n    -Argument \"video_gen.py 'Daily prompt' --preset quick\" `\n    -WorkingDirectory \"C:\\path\\to\\project\"\n\n$trigger = New-ScheduledTaskTrigger -Daily -At 2am\n\nRegister-ScheduledTask -Action $action -Trigger $trigger `\n    -TaskName \"VideoGeneration\" -Description \"Daily video generation\"\n</code></pre>"},{"location":"advanced/automation/#error-handling","title":"Error Handling","text":""},{"location":"advanced/automation/#retry-logic","title":"Retry Logic","text":"<pre><code>import time\nimport subprocess\nfrom functools import wraps\n\ndef retry(max_attempts=3, delay=10):\n    \"\"\"Decorator for retry logic.\"\"\"\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            for attempt in range(1, max_attempts + 1):\n                try:\n                    return func(*args, **kwargs)\n                except Exception as e:\n                    if attempt == max_attempts:\n                        raise\n                    print(f\"Attempt {attempt} failed: {e}\")\n                    time.sleep(delay)\n            return None\n        return wrapper\n    return decorator\n\n@retry(max_attempts=3, delay=10)\ndef generate_with_retry(prompt: str):\n    \"\"\"Generate video with automatic retry.\"\"\"\n    result = subprocess.run(\n        [\"python\", \"video_gen.py\", prompt, \"--preset\", \"quick\"],\n        check=True\n    )\n    return result\n</code></pre>"},{"location":"advanced/automation/#error-notifications","title":"Error Notifications","text":"<pre><code>import smtplib\nfrom email.mime.text import MIMEText\n\ndef send_error_notification(error_message: str):\n    \"\"\"Send email notification on error.\"\"\"\n    msg = MIMEText(f\"Video generation failed:\\n\\n{error_message}\")\n    msg['Subject'] = 'Video Generation Error'\n    msg['From'] = 'automation@example.com'\n    msg['To'] = 'admin@example.com'\n\n    with smtplib.SMTP('smtp.example.com') as server:\n        server.send_message(msg)\n</code></pre>"},{"location":"advanced/automation/#monitoring","title":"Monitoring","text":""},{"location":"advanced/automation/#basic-logging","title":"Basic Logging","text":"<pre><code>import logging\n\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(levelname)s - %(message)s',\n    handlers=[\n        logging.FileHandler('automation.log'),\n        logging.StreamHandler()\n    ]\n)\n</code></pre>"},{"location":"advanced/automation/#metrics-collection","title":"Metrics Collection","text":"<pre><code>import json\nfrom datetime import datetime\n\nclass MetricsCollector:\n    def __init__(self, metrics_file=\"metrics.json\"):\n        self.metrics_file = metrics_file\n        self.metrics = {\"runs\": []}\n\n    def record_run(self, prompt: str, success: bool, duration: float):\n        self.metrics[\"runs\"].append({\n            \"timestamp\": datetime.now().isoformat(),\n            \"prompt\": prompt,\n            \"success\": success,\n            \"duration_seconds\": duration\n        })\n\n    def save(self):\n        with open(self.metrics_file, \"w\") as f:\n            json.dump(self.metrics, f, indent=2)\n\n    def get_success_rate(self) -&gt; float:\n        if not self.metrics[\"runs\"]:\n            return 0.0\n        successes = sum(1 for r in self.metrics[\"runs\"] if r[\"success\"])\n        return successes / len(self.metrics[\"runs\"])\n</code></pre>"},{"location":"advanced/automation/#best-practices","title":"Best Practices","text":""},{"location":"advanced/automation/#1-rate-limiting","title":"1. Rate Limiting","text":"<pre><code># Respect API rate limits\ntime.sleep(5)  # Between requests\n</code></pre>"},{"location":"advanced/automation/#2-idempotency","title":"2. Idempotency","text":"<pre><code># Check if output already exists\noutput_path = f\"generated_videos/{prompt_hash}.mp4\"\nif os.path.exists(output_path):\n    print(\"Already generated, skipping\")\n    continue\n</code></pre>"},{"location":"advanced/automation/#3-graceful-shutdown","title":"3. Graceful Shutdown","text":"<pre><code>import signal\nimport sys\n\ndef signal_handler(sig, frame):\n    print(\"Graceful shutdown...\")\n    # Cleanup code here\n    sys.exit(0)\n\nsignal.signal(signal.SIGINT, signal_handler)\nsignal.signal(signal.SIGTERM, signal_handler)\n</code></pre>"},{"location":"advanced/automation/#4-configuration-management","title":"4. Configuration Management","text":"<pre><code># Use environment-specific configs\nimport os\n\nCONFIG = {\n    \"development\": {\n        \"preset\": \"quick\",\n        \"rate_limit\": 2\n    },\n    \"production\": {\n        \"preset\": \"quality\",\n        \"rate_limit\": 5\n    }\n}\n\nenv = os.getenv(\"ENVIRONMENT\", \"development\")\nconfig = CONFIG[env]\n</code></pre>"},{"location":"advanced/automation/#next-steps","title":"Next Steps","text":"<ul> <li>Advanced Usage Overview - All advanced features</li> <li>video_gen.py Reference - Full CLI documentation</li> <li>GCS Storage - Cloud storage setup</li> </ul>"},{"location":"advanced/check_api/","title":"CLI Reference: check_api.py","text":"<p>Complete command-line reference for API verification.</p>"},{"location":"advanced/check_api/#synopsis","title":"Synopsis","text":"<pre><code>python check_api.py [OPTIONS]\n</code></pre>"},{"location":"advanced/check_api/#description","title":"Description","text":"<p>API Checker verifies API connectivity, lists available models, and checks quota information for both Gemini API and Vertex AI endpoints.</p>"},{"location":"advanced/check_api/#options","title":"Options","text":"Option Type Default Description <code>--key</code> string $GOOGLE_API_KEY API key or OAuth token <code>--location</code> string us-central1 Vertex AI region <code>--project-id</code> string - GCP project ID <code>--verbose</code> flag - Show detailed output"},{"location":"advanced/check_api/#api-key-detection","title":"API Key Detection","text":"<p>The script auto-detects endpoint based on key format:</p> Prefix Endpoint Authentication <code>AIzaSy...</code> Gemini API API Key works <code>AQ.Ab8R...</code> Vertex AI OAuth2 required! <code>ya29....</code> Both OAuth2 token"},{"location":"advanced/check_api/#examples","title":"Examples","text":""},{"location":"advanced/check_api/#check-gemini-api","title":"Check Gemini API","text":"<pre><code># Using environment variable\nexport GOOGLE_API_KEY=\"AIzaSy...\"\npython check_api.py\n\n# Using flag\npython check_api.py --key \"AIzaSy...\"\n</code></pre>"},{"location":"advanced/check_api/#check-vertex-ai","title":"Check Vertex AI","text":"<pre><code># Get OAuth token first\nTOKEN=$(gcloud auth application-default print-access-token)\n\n# Check with token\npython check_api.py --key \"$TOKEN\" --project-id my-project\n</code></pre>"},{"location":"advanced/check_api/#list-models","title":"List Models","text":"<pre><code>python check_api.py --key \"$API_KEY\" --verbose\n</code></pre>"},{"location":"advanced/check_api/#output","title":"Output","text":"<pre><code>\ud83d\udd0d API Checker v2.1\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\n\ud83d\udccd Endpoint: Gemini API (generativelanguage.googleapis.com)\n\ud83d\udd11 Key Type: Gemini API Key\n\n\u2705 Connection successful!\n\n\ud83d\udccb Available Models:\n   \u2022 gemini-2.0-flash-exp\n   \u2022 gemini-2.0-flash\n   \u2022 veo-3.1-generate-preview\n   \u2022 veo-3.1-fast-generate-preview\n   \u2022 veo-2.0\n   ...\n</code></pre>"},{"location":"advanced/check_api/#endpoint-compatibility","title":"Endpoint Compatibility","text":"Feature Gemini API Vertex AI API Key Auth OAuth2 Auth Service Account List Models  OAuth only Generate Video"},{"location":"advanced/check_api/#important-notes","title":"Important Notes","text":""},{"location":"advanced/check_api/#vertex-ai-keys-dont-work-for-listing","title":"Vertex AI Keys Don't Work for Listing","text":"<p>Authentication Limitation</p> <p>Vertex AI keys (<code>AQ...</code>) require OAuth for model listing.</p> <pre><code># This will fail for model listing\npython check_api.py --key \"AQ.Ab8R...\"  # Vertex AI key\n# Error: 401 Unauthorized\n\n# Use OAuth token instead\nTOKEN=$(gcloud auth application-default print-access-token)\npython check_api.py --key \"$TOKEN\"\n</code></pre>"},{"location":"advanced/check_api/#video-generation-still-works","title":"Video Generation Still Works","text":"<p>Generation vs Listing</p> <p>Even if model listing fails, video generation may still work with Vertex AI keys.</p> <pre><code># Listing fails\npython check_api.py --key \"AQ...\"  # \u274c\n\n# But video generation works!\npython video_gen.py \"prompt\" --key \"AQ...\"  # \u2705\n</code></pre>"},{"location":"advanced/check_api/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success - connection verified 1 Error - connection failed"},{"location":"advanced/check_api/#see-also","title":"See Also","text":"<ul> <li>Authentication - Authentication methods</li> <li>Quick Start - Getting started</li> </ul>"},{"location":"advanced/image_gen/","title":"CLI Reference: image_gen.py","text":"<p>Complete command-line reference for image generation.</p>"},{"location":"advanced/image_gen/#synopsis","title":"Synopsis","text":"<pre><code>python image_gen.py PROMPT [OPTIONS]\n</code></pre>"},{"location":"advanced/image_gen/#arguments","title":"Arguments","text":""},{"location":"advanced/image_gen/#required","title":"Required","text":"Argument Description <code>PROMPT</code> Text description of the image to generate"},{"location":"advanced/image_gen/#options","title":"Options","text":""},{"location":"advanced/image_gen/#model-output","title":"Model &amp; Output","text":"Option Type Default Description <code>--model</code> string gemini-3-pro-image-preview Model to use <code>--aspect-ratio</code> string 1:1 1:1, 16:9, 9:16, 4:3, 3:4 <code>--image-size</code> string 1K 1K or 2K <code>--output</code> path generated_images/ Output directory"},{"location":"advanced/image_gen/#authentication","title":"Authentication","text":"Option Type Default Description <code>--project</code> string default Config project name"},{"location":"advanced/image_gen/#context","title":"Context","text":"Option Type Default Description <code>--doc</code> path - Document for context"},{"location":"advanced/image_gen/#cost","title":"Cost","text":"Option Type Default Description <code>--estimate-cost</code> flag - Show cost without generating"},{"location":"advanced/image_gen/#debug","title":"Debug","text":"Option Type Default Description <code>--show-defaults</code> flag - Show current defaults and exit (v1.4)"},{"location":"advanced/image_gen/#examples","title":"Examples","text":""},{"location":"advanced/image_gen/#basic","title":"Basic","text":"<pre><code># Simple generation\npython image_gen.py \"A futuristic city at sunset\"\n\n# With aspect ratio\npython image_gen.py \"A cat sitting\" --aspect-ratio 16:9\n\n# High resolution\npython image_gen.py \"Detailed landscape\" --image-size 2K\n</code></pre>"},{"location":"advanced/image_gen/#social-media","title":"Social Media","text":"<pre><code># Instagram square\npython image_gen.py \"Coffee art\" --aspect-ratio 1:1\n\n# Instagram story\npython image_gen.py \"Mountains\" --aspect-ratio 9:16\n\n# Twitter header\npython image_gen.py \"Abstract pattern\" --aspect-ratio 16:9\n</code></pre>"},{"location":"advanced/image_gen/#with-document-context","title":"With Document Context","text":"<pre><code>python image_gen.py \"System architecture diagram\" --doc README.md\n</code></pre>"},{"location":"advanced/image_gen/#cost-estimation","title":"Cost Estimation","text":"<pre><code>python image_gen.py \"Test image\" --estimate-cost\n</code></pre>"},{"location":"advanced/image_gen/#aspect-ratio-guide","title":"Aspect Ratio Guide","text":"Ratio Resolution (1K) Best For 1:1 1024x1024 Square images, avatars 16:9 1820x1024 Widescreen, desktop 9:16 1024x1820 Mobile, stories 4:3 1365x1024 Traditional photo 3:4 1024x1365 Portrait"},{"location":"advanced/image_gen/#environment-variables","title":"Environment Variables","text":"Variable Description <code>GOOGLE_API_KEY</code> Default API key (for direct API usage)"},{"location":"advanced/image_gen/#output","title":"Output","text":"<p>Images are saved with timestamp:</p> <pre><code>generated_images/\n\u2514\u2500\u2500 image_20260123_123456.png\n</code></pre>"},{"location":"advanced/image_gen/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 General error 2 Invalid arguments"},{"location":"advanced/image_gen/#see-also","title":"See Also","text":"<ul> <li>Image Generation - Image generation guide</li> <li>Authentication - API key setup</li> </ul>"},{"location":"advanced/video_gen/","title":"CLI Reference: video_gen.py","text":"<p>Complete command-line reference for video generation.</p>"},{"location":"advanced/video_gen/#synopsis","title":"Synopsis","text":"<pre><code>python video_gen.py PROMPT [OPTIONS]\n</code></pre>"},{"location":"advanced/video_gen/#arguments","title":"Arguments","text":""},{"location":"advanced/video_gen/#required","title":"Required","text":"Argument Description <code>PROMPT</code> Text description of the video to generate"},{"location":"advanced/video_gen/#options","title":"Options","text":""},{"location":"advanced/video_gen/#model-output","title":"Model &amp; Output","text":"Option Type Default Description <code>--model</code> string veo-3.1-generate-preview Model to use <code>--duration</code> int 5 Video duration (5-8 seconds) <code>--aspect-ratio</code> string 16:9 16:9, 9:16, or 1:1 <code>--output</code> path generated_videos/ Output directory"},{"location":"advanced/video_gen/#presets","title":"Presets","text":"Option Type Default Description <code>--preset</code> string - quick, quality, extend, budget"},{"location":"advanced/video_gen/#authentication","title":"Authentication","text":"Option Type Default Description <code>--key</code> string $GOOGLE_API_KEY API key or OAuth token <code>--project</code> string default Config project name"},{"location":"advanced/video_gen/#images","title":"Images","text":"Option Type Default Description <code>--image</code> path - First frame image <code>--last-frame</code> path - Last frame image <code>--reference-image</code> PATH:TYPE - Reference image (asset/style)"},{"location":"advanced/video_gen/#video-extension","title":"Video Extension","text":"Option Type Default Description <code>--extend-video</code> path/URI - Video to extend <code>--storage-uri</code> gs:// - GCS bucket for uploads"},{"location":"advanced/video_gen/#mask-operations","title":"Mask Operations","text":"Option Type Default Description <code>--video</code> path - Source video for mask ops <code>--mask</code> path - Mask image <code>--mask-mode</code> string - insert or remove <code>--resize-mode</code> string - Resize mode for mask"},{"location":"advanced/video_gen/#cost-metadata","title":"Cost &amp; Metadata","text":"Option Type Default Description <code>--estimate-cost</code> flag - Show cost without generating <code>--no-metadata</code> flag - Don't save metadata file"},{"location":"advanced/video_gen/#debug","title":"Debug","text":"Option Type Default Description <code>--verbose</code> flag - Show detailed output <code>--dry-run</code> flag - Show request without sending <code>--show-defaults</code> flag - Show current defaults and exit (v2.25)"},{"location":"advanced/video_gen/#examples","title":"Examples","text":""},{"location":"advanced/video_gen/#basic","title":"Basic","text":"<pre><code># Simple text-to-video\npython video_gen.py \"A cat walking in a garden\"\n\n# With options\npython video_gen.py \"A sunset over mountains\" \\\n  --duration 8 \\\n  --aspect-ratio 16:9\n</code></pre>"},{"location":"advanced/video_gen/#using-presets","title":"Using Presets","text":"<pre><code># Fast preview\npython video_gen.py \"Quick test\" --preset quick\n\n# Best quality\npython video_gen.py \"Final render\" --preset quality\n\n# Video extension\npython video_gen.py \"Continue scene\" --preset extend --extend-video input.mp4\n</code></pre>"},{"location":"advanced/video_gen/#image-to-video","title":"Image-to-Video","text":"<pre><code># Animate an image\npython video_gen.py \"The character starts walking\" --image hero.png\n\n# With first and last frames\npython video_gen.py \"Transition effect\" \\\n  --image start.jpg \\\n  --last-frame end.jpg\n</code></pre>"},{"location":"advanced/video_gen/#reference-images","title":"Reference Images","text":"<pre><code># Preserve subject (asset)\npython video_gen.py \"Person waving\" \\\n  --reference-image avatar.png:asset\n\n# Apply style\npython video_gen.py \"Cityscape\" \\\n  --reference-image painting.jpg:style \\\n  --model veo-2.0-exp\n</code></pre>"},{"location":"advanced/video_gen/#video-extension_1","title":"Video Extension","text":"<pre><code># Extend with auto-upload\npython video_gen.py \"Continue the action\" \\\n  --extend-video previous.mp4 \\\n  --storage-uri gs://my-bucket/videos \\\n  --model veo-2.0\n</code></pre>"},{"location":"advanced/video_gen/#mask-operations_1","title":"Mask Operations","text":"<pre><code># Insert object\npython video_gen.py \"Add a bird\" \\\n  --video scene.mp4 \\\n  --mask bird_area.png \\\n  --mask-mode insert\n\n# Remove object\npython video_gen.py \"Remove watermark\" \\\n  --video scene.mp4 \\\n  --mask watermark.png \\\n  --mask-mode remove\n</code></pre>"},{"location":"advanced/video_gen/#environment-variables","title":"Environment Variables","text":"Variable Description <code>GOOGLE_API_KEY</code> Default API key <code>GOOGLE_APPLICATION_CREDENTIALS</code> Service account JSON path"},{"location":"advanced/video_gen/#config-file","title":"Config File","text":"<p>Create <code>config.json</code> for multi-project support:</p> <pre><code>{\n  \"main_projects\": {\n    \"default\": {\n      \"api_key\": \"AIzaSy...\",\n      \"gcs_bucket\": \"my-bucket\"\n    }\n  }\n}\n</code></pre> <pre><code>python video_gen.py \"prompt\" --project default\n</code></pre>"},{"location":"advanced/video_gen/#smart-defaults-v2251","title":"Smart Defaults (v2.25.1)","text":"<p>When extending a video, settings are automatically inherited from the source video's metadata:</p>"},{"location":"advanced/video_gen/#automatic-inheritance","title":"Automatic Inheritance","text":"<pre><code># Original video was created with veo-2.0, 1080p, project-1\npython video_gen.py \"Continue the scene\" --extend-video video_20260201_123456_0.mp4\n\n# Output:\n# \u2139 Found source metadata for inheritance\n# \u2139 Inherited project from source metadata: project-1\n# \u2139 Inherited model from metadata: veo-2.0\n# \u2139 Inherited resolution from metadata: 1080p\n</code></pre> <p>Video Extension Models</p> <p>Video extension is supported by <code>veo-2.0</code>, <code>veo-2.0-exp</code>, and <code>veo-3.1-generate-preview</code>.</p>"},{"location":"advanced/video_gen/#priority-chain","title":"Priority Chain","text":"<p>Settings are resolved in this order:</p> <ol> <li>CLI Arguments (highest) - Explicitly specified options</li> <li>Source Metadata - From <code>--extend-video</code> source</li> <li>config.json - Project settings</li> <li>Code Defaults (lowest) - Built-in fallbacks</li> </ol>"},{"location":"advanced/video_gen/#inheritable-fields","title":"Inheritable Fields","text":"Field Description <code>model</code> Video generation model <code>resolution</code> Output resolution (720p, 1080p) <code>aspect_ratio</code> 16:9, 9:16, 1:1 <code>storage_uri</code> GCS bucket for uploads <code>location</code> GCP region <code>project_id</code> GCP project ID"},{"location":"advanced/video_gen/#override-inheritance","title":"Override Inheritance","text":"<p>You can always override inherited values:</p> <pre><code># Override model from metadata\npython video_gen.py \"Continue\" \\\n  --extend-video video.mp4 \\\n  --model veo-2.0\n</code></pre>"},{"location":"advanced/video_gen/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 General error 2 Invalid arguments 3 API error"},{"location":"advanced/video_gen/#see-also","title":"See Also","text":"<ul> <li>Video Overview - Video generation guide</li> <li>Generation Modes - All 8 modes explained</li> <li>Presets - Preset configurations</li> </ul>"},{"location":"archive/ARCHITECTURE/","title":"\ud83c\udfaf \u0e04\u0e27\u0e32\u0e21\u0e40\u0e02\u0e49\u0e32\u0e43\u0e08\u0e17\u0e35\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07: Request Load Flow","text":""},{"location":"archive/ARCHITECTURE/#critical","title":"\u26a0\ufe0f \u0e2b\u0e25\u0e31\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e33\u0e04\u0e31\u0e0d (Critical)","text":"<p>Request Load \u0e44\u0e21\u0e48\u0e1c\u0e48\u0e32\u0e19 CCS \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07 \u0e41\u0e15\u0e48 CLIProxyAPI \u0e40\u0e1b\u0e47\u0e19\u0e15\u0e31\u0e27\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e2b\u0e25\u0e31\u0e01</p> <pre><code>Client (image_gen.py)\n    \u2193 Direct HTTP Request\nCLIProxyAPI (localhost:8317) \u2190 MAIN REQUEST HANDLER\n    \u2193 Direct HTTP Request\nGoogle Imagen API\n\nCCS \u0e21\u0e35\u0e2b\u0e19\u0e49\u0e32\u0e17\u0e35\u0e48\u0e40\u0e09\u0e1e\u0e32\u0e30\u0e15\u0e2d\u0e19 CLIProxyAPI \u0e14\u0e36\u0e07 OAuth Token \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\n</code></pre>"},{"location":"archive/ARCHITECTURE/#request-path","title":"\ud83d\udcca Request Path \u0e2d\u0e22\u0e48\u0e32\u0e07\u0e25\u0e30\u0e40\u0e2d\u0e35\u0e22\u0e14","text":""},{"location":"archive/ARCHITECTURE/#path-1-request-load-main-flow","title":"Path 1: Request Load (Main Flow)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  1. image_gen.py (Client)                                   \u2502\n\u2502     python3 image_gen.py \"A cute cat\"                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502 HTTP POST http://127.0.0.1:8317/v1/chat/completions\n                 \u2502 Headers: Authorization: Bearer ccs-internal-managed\n                 \u2502 Body: {model, messages, modalities, image_config}\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  2. CLIProxyAPI (MAIN HANDLER) \u2705                            \u2502\n\u2502     localhost:8317                                          \u2502\n\u2502                                                             \u2502\n\u2502  Request \u0e21\u0e32\u0e17\u0e35\u0e48\u0e19\u0e35\u0e48 \u2192 CLIProxyAPI \u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502 CLIProxyAPI \u0e41\u0e1b\u0e25\u0e07 format \u0e41\u0e25\u0e30\u0e40\u0e15\u0e23\u0e35\u0e22\u0e21 call Google\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  3. Google Imagen API                                       \u2502\n\u2502     https://generativelanguage.googleapis.com/v1beta/...    \u2502\n\u2502                                                             \u2502\n\u2502  CLIProxyAPI \u2192 Google API (Direct)                          \u2502\n\u2502  Google API \u2192 CLIProxyAPI (Direct)                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502 CLIProxyAPI \u0e41\u0e1b\u0e25\u0e07 response \u0e01\u0e25\u0e31\u0e1a\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  4. CLIProxyAPI \u2192 Client                                    \u2502\n\u2502     Return base64 image data                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"archive/ARCHITECTURE/#path-2-authentication-side-flow","title":"Path 2: Authentication (Side Flow)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CLIProxyAPI                                                 \u2502\n\u2502     \u0e40\u0e2b\u0e47\u0e19 \"ccs-internal-managed\" \u0e43\u0e19 header                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502 Internal Query (\u0e44\u0e21\u0e48\u0e43\u0e0a\u0e48 request load)\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CCS (Extension)                                            \u2502\n\u2502     ~/.ccs/cliproxy/auth/gemini-*.json                     \u2502\n\u2502                                                             \u2502\n\u2502  \u0e2a\u0e48\u0e07 OAuth token: ya29.a0Aa7pCA98e...                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502 OAuth token \u0e01\u0e25\u0e31\u0e1a\u0e21\u0e32\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CLIProxyAPI                                                 \u2502\n\u2502     \u0e43\u0e0a\u0e49 OAuth token \u0e44\u0e1b call Google API                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"archive/ARCHITECTURE/#_1","title":"\ud83d\udd11 \u0e08\u0e38\u0e14\u0e2a\u0e33\u0e04\u0e31\u0e0d\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e40\u0e02\u0e49\u0e32\u0e43\u0e08","text":""},{"location":"archive/ARCHITECTURE/#request-load-cliproxyapi-direct","title":"Request Load = CLIProxyAPI (Direct)","text":"\u0e02\u0e31\u0e49\u0e19\u0e15\u0e2d\u0e19 \u0e1c\u0e48\u0e32\u0e19\u0e43\u0e04\u0e23 \u0e15\u0e31\u0e27\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23 Client \u2192 CLIProxyAPI \u2705 Direct CLIProxyAPI CLIProxyAPI \u2192 Google API \u2705 Direct CLIProxyAPI Google API \u2192 CLIProxyAPI \u2705 Direct CLIProxyAPI CLIProxyAPI \u2192 Client \u2705 Direct CLIProxyAPI"},{"location":"archive/ARCHITECTURE/#ccs-token-provider-only","title":"CCS = Token Provider Only","text":"\u0e02\u0e31\u0e49\u0e19\u0e15\u0e2d\u0e19 \u0e40\u0e21\u0e37\u0e48\u0e2d\u0e44\u0e23 CLIProxyAPI \u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23 token Query CCS CCS \u0e2a\u0e48\u0e07 token \u0e01\u0e25\u0e31\u0e1a CLIProxyAPI \u0e44\u0e14\u0e49 token Token \u0e2b\u0e21\u0e14\u0e2d\u0e32\u0e22\u0e38 CLIProxyAPI query CCS \u0e43\u0e2b\u0e21\u0e48"},{"location":"archive/ARCHITECTURE/#ccs-request-load","title":"CCS \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a Request Load","text":"<ul> <li>\u274c Request \u0e08\u0e32\u0e01 client \u0e44\u0e21\u0e48\u0e1c\u0e48\u0e32\u0e19 CCS</li> <li>\u274c CCS \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49 process/format request</li> <li>\u274c CCS \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49 call Google API</li> <li>\u2705 CCS \u0e08\u0e31\u0e14\u0e01\u0e32\u0e23 OAuth tokens \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19</li> </ul>"},{"location":"archive/ARCHITECTURE/#_2","title":"\ud83d\udcd0 \u0e2a\u0e16\u0e32\u0e1b\u0e31\u0e15\u0e22\u0e01\u0e23\u0e23\u0e21\u0e17\u0e35\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07","text":"<pre><code>         Request Load (Main Flow)\n         \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Client \u2502 \u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502 CLIProxyAPI \u2502 \u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502  Google   \u2502\n\u2502        \u2502 &lt;\u2500\u2500\u2500\u2500\u2500\u2500 \u2502   (8317)    \u2502 &lt;\u2500\u2500\u2500\u2500\u2500\u2500 \u2502   API     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u2502 Token Query (Side Flow)\n                          \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502  CCS (Extension) \u2502\n                    \u2502                  \u2502\n                    \u2502  - Token Storage \u2502\n                    \u2502  - Auto-refresh  \u2502\n                    \u2502  - OAuth mgmt    \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"archive/ARCHITECTURE/#_3","title":"\u2705 \u0e2a\u0e23\u0e38\u0e1b\u0e2a\u0e31\u0e49\u0e19\u0e46","text":"<pre><code>Client Request Path:\nimage_gen.py \u2192 CLIProxyAPI \u2192 Google API\n                (Main Handler)\n\nCCS Role:\n\u0e40\u0e09\u0e1e\u0e32\u0e30\u0e15\u0e2d\u0e19 CLIProxyAPI \u0e14\u0e36\u0e07 OAuth Token \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19\n\u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a request load \u0e08\u0e32\u0e01 client\n</code></pre> <p>\u0e04\u0e33\u0e2a\u0e33\u0e04\u0e31\u0e0d: CLIProxyAPI \u0e40\u0e1b\u0e47\u0e19\u0e15\u0e31\u0e27\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e2b\u0e25\u0e31\u0e01\u0e02\u0e2d\u0e07 request CCS \u0e40\u0e1b\u0e47\u0e19\u0e40\u0e09\u0e1e\u0e32\u0e30 token provider \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19 \ud83c\udfaf</p>"},{"location":"archive/AUTHENTICATION_GUIDE/","title":"Veo Video Generation - Authentication Guide","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#version-10","title":"Version: 1.0","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#date-2026-01-18","title":"Date: 2026-01-18","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#1-executive-summary","title":"1. Executive Summary","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#key-finding","title":"Key Finding","text":"<p>\u0e17\u0e38\u0e01\u0e27\u0e34\u0e18\u0e35 Authentication \u0e2a\u0e38\u0e14\u0e17\u0e49\u0e32\u0e22\u0e15\u0e34\u0e14 Billing \u0e40\u0e2b\u0e21\u0e37\u0e2d\u0e19\u0e01\u0e31\u0e19</p> Method Authentication Veo Access API Key \u2705 \u0e07\u0e48\u0e32\u0e22 \u274c \u0e15\u0e49\u0e2d\u0e07 Billing OAuth \u2705 \u0e0b\u0e31\u0e1a\u0e0b\u0e49\u0e2d\u0e19 \u274c \u0e15\u0e49\u0e2d\u0e07 Billing Service Account \u2705 \u0e0b\u0e31\u0e1a\u0e0b\u0e49\u0e2d\u0e19 \u274c \u0e15\u0e49\u0e2d\u0e07 Billing <p>Veo \u0e44\u0e21\u0e48\u0e21\u0e35 Free Tier \u0e43\u0e19 API - \u0e44\u0e21\u0e48\u0e27\u0e48\u0e32\u0e08\u0e30 authenticate \u0e14\u0e49\u0e27\u0e22\u0e27\u0e34\u0e18\u0e35\u0e43\u0e14</p>"},{"location":"archive/AUTHENTICATION_GUIDE/#2-authentication-methods-comparison","title":"2. Authentication Methods Comparison","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#21-complexity-comparison","title":"2.1 Complexity Comparison","text":"\u0e40\u0e23\u0e37\u0e48\u0e2d\u0e07 API Key OAuth Service Account Setup 1 \u0e19\u0e32\u0e17\u0e35 30+ \u0e19\u0e32\u0e17\u0e35 15 \u0e19\u0e32\u0e17\u0e35 Code Lines 3 \u0e1a\u0e23\u0e23\u0e17\u0e31\u0e14 50+ \u0e1a\u0e23\u0e23\u0e17\u0e31\u0e14 20 \u0e1a\u0e23\u0e23\u0e17\u0e31\u0e14 Token Management \u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07 \u0e15\u0e49\u0e2d\u0e07 refresh \u0e15\u0e49\u0e2d\u0e07 refresh Scope Registration \u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07 \u0e15\u0e49\u0e2d\u0e07 \u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07 Browser Flow \u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07 \u0e15\u0e49\u0e2d\u0e07 \u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07 Error Handling \u0e19\u0e49\u0e2d\u0e22 \u0e21\u0e32\u0e01 \u0e1b\u0e32\u0e19\u0e01\u0e25\u0e32\u0e07"},{"location":"archive/AUTHENTICATION_GUIDE/#22-recommendation","title":"2.2 Recommendation","text":"<pre><code>Simplicity Ranking:\n\n1. API Key          \u2605\u2605\u2605\u2605\u2605  (\u0e07\u0e48\u0e32\u0e22\u0e17\u0e35\u0e48\u0e2a\u0e38\u0e14)\n2. Service Account  \u2605\u2605\u2605\u2606\u2606  (\u0e1b\u0e32\u0e19\u0e01\u0e25\u0e32\u0e07)\n3. OAuth            \u2605\u2605\u2606\u2606\u2606  (\u0e0b\u0e31\u0e1a\u0e0b\u0e49\u0e2d\u0e19\u0e17\u0e35\u0e48\u0e2a\u0e38\u0e14)\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#3-api-key-method-recommended","title":"3. API Key Method (Recommended)","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#31-why-api-key-is-best","title":"3.1 Why API Key is Best","text":"<ul> <li>No token refresh - Key \u0e44\u0e21\u0e48\u0e2b\u0e21\u0e14\u0e2d\u0e32\u0e22\u0e38 (\u0e08\u0e19\u0e01\u0e27\u0e48\u0e32\u0e08\u0e30 revoke)</li> <li>No browser flow - \u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e40\u0e1b\u0e34\u0e14 browser</li> <li>No scope management - \u0e44\u0e21\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e25\u0e07\u0e17\u0e30\u0e40\u0e1a\u0e35\u0e22\u0e19 scopes</li> <li>Simple code - \u0e41\u0e04\u0e48\u0e43\u0e2a\u0e48 header</li> </ul>"},{"location":"archive/AUTHENTICATION_GUIDE/#32-setup-steps","title":"3.2 Setup Steps","text":"<pre><code>Step 1: \u0e44\u0e1b\u0e17\u0e35\u0e48 https://aistudio.google.com/apikey\nStep 2: Create API Key\nStep 3: Enable Billing (\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a Veo)\nStep 4: \u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19\u0e44\u0e14\u0e49\u0e40\u0e25\u0e22\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#33-usage","title":"3.3 Usage","text":"<pre><code># Command line\npython video_gen.py \"prompt\" --auth api-key --api-key YOUR_KEY\n\n# Or set environment variable\nexport GOOGLE_API_KEY=\"YOUR_KEY\"\npython video_gen.py \"prompt\" --auth api-key\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#34-code-example","title":"3.4 Code Example","text":"<pre><code>import requests\n\nAPI_KEY = \"your-api-key\"\nurl = f\"https://generativelanguage.googleapis.com/v1beta/models/veo-3.1-generate-preview:predictLongRunning?key={API_KEY}\"\n\nresponse = requests.post(url, json=payload)\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#4-oauth-method-complex","title":"4. OAuth Method (Complex)","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#41-why-oauth-is-complex","title":"4.1 Why OAuth is Complex","text":"<ul> <li>Browser flow required - \u0e15\u0e49\u0e2d\u0e07\u0e40\u0e1b\u0e34\u0e14 browser \u0e17\u0e38\u0e01\u0e04\u0e23\u0e31\u0e49\u0e07\u0e17\u0e35\u0e48 token \u0e2b\u0e21\u0e14\u0e2d\u0e32\u0e22\u0e38</li> <li>Token expires - Access token \u0e2b\u0e21\u0e14\u0e2d\u0e32\u0e22\u0e38\u0e43\u0e19 1 \u0e0a\u0e31\u0e48\u0e27\u0e42\u0e21\u0e07</li> <li>Scope registration - \u0e15\u0e49\u0e2d\u0e07\u0e25\u0e07\u0e17\u0e30\u0e40\u0e1a\u0e35\u0e22\u0e19 scopes \u0e43\u0e19 Google Cloud Console</li> <li>Consent screen - \u0e15\u0e49\u0e2d\u0e07 configure OAuth consent screen</li> <li>Multiple error types - Token expired, scope mismatch, refresh failed</li> </ul>"},{"location":"archive/AUTHENTICATION_GUIDE/#42-oauth-flow","title":"4.2 OAuth Flow","text":"<pre><code>OAuth Flow (10+ steps):\n\n1. Load client_secret.json\n2. Check for existing token\n3. If expired \u2192 refresh token\n4. If no token \u2192 browser flow\n5. Open browser\n6. User consents\n7. Receive callback\n8. Exchange code for token\n9. Store token\n10. Finally make API request\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#43-required-scopes-for-gemini-api","title":"4.3 Required Scopes for Gemini API","text":"<pre><code>SCOPES = [\n    \"https://www.googleapis.com/auth/generative-language.peruserquota\",\n    \"https://www.googleapis.com/auth/generative-language.tuning\",\n    \"https://www.googleapis.com/auth/generative-language.retriever\",\n]\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#44-common-oauth-errors","title":"4.4 Common OAuth Errors","text":"Error Cause Solution <code>restricted_client</code> Scope not registered Register scope in Cloud Console <code>invalid_grant</code> Token expired/revoked Re-authenticate <code>access_denied</code> User denied consent User must approve <code>scope_changed</code> Missing openid scope Add openid to scopes"},{"location":"archive/AUTHENTICATION_GUIDE/#5-billing-requirement-critical","title":"5. Billing Requirement (Critical)","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#51-veo-has-no-free-tier","title":"5.1 Veo Has No Free Tier","text":"<pre><code>Veo API Pricing (Paid Tier Only):\n\n| Model     | Free Tier        | Paid Tier           |\n|-----------|------------------|---------------------|\n| Veo 3.1   | \u274c Not available | $0.15-$0.60/sec    |\n| Veo 3.0   | \u274c Not available | $0.15-$0.40/sec    |\n| Veo 2.0   | \u274c Not available | $0.35/sec          |\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#52-subscription-vs-api-access","title":"5.2 Subscription vs API Access","text":"<pre><code>Google AI Pro/Family Subscription ($19.99/month)\n\u2502\n\u251c\u2500\u2500 App-based Access (UI) \u2705 INCLUDED\n\u2502   \u251c\u2500\u2500 gemini.google.com\n\u2502   \u251c\u2500\u2500 aistudio.google.com\n\u2502   \u2514\u2500\u2500 Veo quota: 3-5 videos/day\n\u2502\n\u2514\u2500\u2500 API Access \u274c NOT INCLUDED\n    \u251c\u2500\u2500 Separate billing system\n    \u251c\u2500\u2500 Pay-as-you-go pricing\n    \u2514\u2500\u2500 Veo: No free tier\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#53-how-to-enable-billing","title":"5.3 How to Enable Billing","text":"<pre><code>Option 1: Via AI Studio\n1. Go to https://aistudio.google.com/apikey\n2. Find your project\n3. Click \"Upgrade\"\n4. Link billing account\n\nOption 2: Via Cloud Console\n1. Go to https://console.cloud.google.com\n2. Select project\n3. Go to Billing\n4. Enable billing\n5. Link credit/debit card\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#6-test-results-summary","title":"6. Test Results Summary","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#61-oauth-testing","title":"6.1 OAuth Testing","text":"<pre><code>OAuth with generative-language.peruserquota scope:\n\n\u2705 Authentication: SUCCESS\n\u2705 Scope validation: SUCCESS\n\u2705 Token generation: SUCCESS\n\u274c Veo generation: FAILED (429 Quota Exceeded)\n\nReason: No billing enabled \u2192 quota = 0\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#62-api-key-testing","title":"6.2 API Key Testing","text":"<pre><code>API Key testing:\n\n\u2705 List models: SUCCESS\n\u2705 Text generation (gemini-2.5-flash): SUCCESS\n\u274c Veo generation: FAILED (429 Quota Exceeded)\n\nReason: No billing enabled \u2192 quota = 0\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#63-conclusion","title":"6.3 Conclusion","text":"<p>Both methods work for authentication, but Veo requires billing regardless of auth method.</p>"},{"location":"archive/AUTHENTICATION_GUIDE/#7-recommendations","title":"7. Recommendations","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#71-for-video-generation-via-api","title":"7.1 For Video Generation via API","text":"<pre><code># Simplest approach (requires billing)\npython video_gen.py \"prompt\" --auth api-key --api-key YOUR_KEY\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#72-for-free-video-generation","title":"7.2 For Free Video Generation","text":"<pre><code>Use Gemini App (UI):\n1. Go to gemini.google.com\n2. Use your Pro/Family subscription quota\n3. Generate 3-5 videos/day\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#73-decision-matrix","title":"7.3 Decision Matrix","text":"Situation Recommendation Just testing Use Gemini App (UI) Need API automation Enable billing + API Key Multi-user app Enable billing + OAuth Enterprise/CI/CD Enable billing + Service Account"},{"location":"archive/AUTHENTICATION_GUIDE/#8-quick-reference","title":"8. Quick Reference","text":""},{"location":"archive/AUTHENTICATION_GUIDE/#81-api-key-recommended","title":"8.1 API Key (Recommended)","text":"<pre><code># One-time setup\n# 1. Create key at aistudio.google.com\n# 2. Enable billing\n\n# Usage\npython video_gen.py \"prompt\" --auth api-key --api-key YOUR_KEY\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#82-oauth-if-needed","title":"8.2 OAuth (If needed)","text":"<pre><code># One-time setup\n# 1. Create OAuth client in Cloud Console\n# 2. Register scopes\n# 3. Configure consent screen\n# 4. Enable billing\n\n# Usage\npython video_gen.py --login\npython video_gen.py \"prompt\" --auth oauth\n</code></pre>"},{"location":"archive/AUTHENTICATION_GUIDE/#9-version-history","title":"9. Version History","text":"Version Date Changes 1.0 2026-01-18 Initial version with API Key vs OAuth comparison"},{"location":"archive/CLIProxyAPI_RESEARCH/","title":"\ud83d\udd0d CLIProxyAPI Research Summary","text":""},{"location":"archive/CLIProxyAPI_RESEARCH/#cliproxyapi-cliproxyapiplus","title":"\ud83d\udcca \u0e2a\u0e23\u0e38\u0e1b\u0e01\u0e32\u0e23\u0e27\u0e34\u0e08\u0e31\u0e22 CLIProxyAPI \u0e41\u0e25\u0e30 CLIProxyAPIPlus","text":""},{"location":"archive/CLIProxyAPI_RESEARCH/#_1","title":"\u0e2a\u0e34\u0e48\u0e07\u0e17\u0e35\u0e48\u0e04\u0e49\u0e19\u0e1e\u0e1a","text":"<p>CLIProxyAPI (mainline repository: https://github.com/router-for-me/CLIProxyAPI) - \u0e40\u0e1b\u0e47\u0e19 Go-based proxy server (99.8% Go code) - \u0e17\u0e33\u0e2b\u0e19\u0e49\u0e32\u0e17\u0e35\u0e48\u0e40\u0e1b\u0e47\u0e19 Format Translator \u0e23\u0e30\u0e2b\u0e27\u0e48\u0e32\u0e07 OpenAI/OpenRouter format \u0e41\u0e25\u0e30 CLI tool formats - \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49 host models \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07 \u0e41\u0e15\u0e48\u0e17\u0e33\u0e2b\u0e19\u0e49\u0e32\u0e17\u0e35\u0e48 proxy \u0e44\u0e1b\u0e22\u0e31\u0e07 CLI tools</p> <p>CLIProxyAPIPlus (https://github.com/router-for-me/CLIProxyAPIPlus) - \u0e40\u0e1b\u0e47\u0e19 fork \u0e02\u0e2d\u0e07 CLIProxyAPI - \u0e40\u0e1e\u0e34\u0e48\u0e21 third-party provider support (GitHub Copilot, Kiro) - \u0e43\u0e0a\u0e49 mainline features \u0e40\u0e2b\u0e21\u0e37\u0e2d\u0e19\u0e01\u0e31\u0e19 - Community-maintained \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a third-party providers</p>"},{"location":"archive/CLIProxyAPI_RESEARCH/#confirmed","title":"\ud83c\udfd7\ufe0f \u0e2a\u0e16\u0e32\u0e1b\u0e31\u0e15\u0e22\u0e01\u0e23\u0e23\u0e21\u0e17\u0e35\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e2d\u0e07 (Confirmed)","text":""},{"location":"archive/CLIProxyAPI_RESEARCH/#component-roles","title":"Component Roles","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CLIProxyAPI (localhost:8317)                               \u2502\n\u2502                                                             \u2502\n\u2502  \u0e2b\u0e19\u0e49\u0e32\u0e17\u0e35\u0e48\u0e2b\u0e25\u0e31\u0e01:                                               \u2502\n\u2502  1. Receive requests \u0e08\u0e32\u0e01 clients                            \u2502\n\u2502  2. Translate formats (OpenRouter \u2192 Provider format)        \u2502\n\u2502  3. Manage authentication (OAuth token management)          \u2502\n\u2502  4. Route to appropriate providers                          \u2502\n\u2502  5. Translate responses back (Provider \u2192 OpenRouter)        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CCS (Claude Code Switch)                                   \u2502\n\u2502                                                             \u2502\n\u2502  \u0e2b\u0e19\u0e49\u0e32\u0e17\u0e35\u0e48\u0e2b\u0e25\u0e31\u0e01:                                               \u2502\n\u2502  1. Store OAuth tokens \u0e43\u0e19 ~/.ccs/cliproxy/auth/             \u2502\n\u2502  2. Auto-refresh tokens                                     \u2502\n\u2502  3. Provide tokens \u0e40\u0e21\u0e37\u0e48\u0e2d CLIProxyAPI \u0e2a\u0e2d\u0e1a\u0e16\u0e32\u0e21               \u2502\n\u2502  4. Manage multiple OAuth accounts                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Client (image_gen.py)                                      \u2502\n\u2502                                                             \u2502\n\u2502  \u0e2b\u0e19\u0e49\u0e32\u0e17\u0e35\u0e48\u0e2b\u0e25\u0e31\u0e01:                                               \u2502\n\u2502  1. Send OpenRouter-format requests to CLIProxyAPI          \u2502\n\u2502  2. Use \"ccs-internal-managed\" as auth indicator            \u2502\n\u2502  3. Process base64 image responses                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"archive/CLIProxyAPI_RESEARCH/#request-flow-confirmed-correct","title":"Request Flow (Confirmed Correct)","text":"<pre><code>Client Request Flow (Main Flow)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n1. image_gen.py \u2192 CLIProxyAPI (localhost:8317)\n   Endpoint: /v1/chat/completions\n   Headers: Authorization: Bearer ccs-internal-managed\n   Body: OpenRouter format with modalities + image_config\n\n2. CLIProxyAPI \u0e23\u0e31\u0e1a request\n   - \u0e40\u0e2b\u0e47\u0e19 \"ccs-internal-managed\" \u2192 \u0e23\u0e39\u0e49\u0e27\u0e48\u0e32\u0e15\u0e49\u0e2d\u0e07\u0e14\u0e36\u0e07 OAuth token\n   - Query CCS \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a actual OAuth token\n\n3. CLIProxyAPI \u2192 CCS (Internal Token Query)\n   Location: ~/.ccs/cliproxy/auth/gemini-*.json\n   Response: OAuth access_token (ya29.a0Aa...)\n\n4. CLIProxyAPI \u2192 Google Imagen API\n   - Translate OpenRouter format \u2192 Google Imagen format\n   - Use OAuth token \u0e08\u0e32\u0e01 CCS\n   - Endpoint: https://generativelanguage.googleapis.com/...\n\n5. Google API \u2192 CLIProxyAPI\n   Response: base64 image data (Google format)\n\n6. CLIProxyAPI \u2192 Client\n   - Translate Google format \u2192 OpenRouter format\n   - Return image data in choices[].message.images[]\n</code></pre>"},{"location":"archive/CLIProxyAPI_RESEARCH/#_2","title":"\ud83d\udd11 \u0e08\u0e38\u0e14\u0e2a\u0e33\u0e04\u0e31\u0e0d\u0e17\u0e35\u0e48\u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e41\u0e25\u0e49\u0e27","text":""},{"location":"archive/CLIProxyAPI_RESEARCH/#1-cliproxyapi-format-format-translator","title":"1. CLIProxyAPI \u0e04\u0e37\u0e2d\u0e15\u0e31\u0e27\u0e41\u0e1b\u0e25\u0e07 Format (Format Translator)","text":"<p>OpenRouter Format (Input) <pre><code>{\n  \"model\": \"gemini-3-pro-image-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"prompt\"}],\n  \"modalities\": [\"image\", \"text\"],\n  \"image_config\": {\n    \"aspect_ratio\": \"1:1\",\n    \"image_size\": \"1K\"\n  }\n}\n</code></pre></p> <p>CLIProxyAPI translates to \u2192 Google Imagen Format <pre><code>{\n  \"instances\": [{\"prompt\": \"prompt\"}],\n  \"parameters\": {\n    \"sampleCount\": 1,\n    \"aspectRatio\": \"1:1\"\n  }\n}\n</code></pre></p>"},{"location":"archive/CLIProxyAPI_RESEARCH/#2-ccs-request-handler","title":"2. CCS \u0e44\u0e21\u0e48\u0e43\u0e0a\u0e48 Request Handler","text":"<p>\u0e17\u0e35\u0e48 CCS \u0e17\u0e33\u0e08\u0e23\u0e34\u0e07\u0e46: - \u2705 \u0e40\u0e01\u0e47\u0e1a OAuth tokens - \u2705 Auto-refresh tokens - \u2705 \u0e15\u0e2d\u0e1a token requests \u0e08\u0e32\u0e01 CLIProxyAPI</p> <p>\u0e17\u0e35\u0e48 CCS \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e17\u0e33: - \u274c \u0e23\u0e31\u0e1a requests \u0e08\u0e32\u0e01 client \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07 - \u274c Translate formats - \u274c Call Google APIs - \u274c Process responses</p>"},{"location":"archive/CLIProxyAPI_RESEARCH/#3-cliproxyapi-configuration","title":"3. CLIProxyAPI Configuration","text":"<p>Authentication Directory: <code>~/.cli-proxy-api/</code> Port: 8317 Format: OpenAI/OpenRouter-compatible</p> <p>Supported OAuth Channels: - gemini-cli (\u0e23\u0e2d\u0e07\u0e23\u0e31\u0e1a image generation) - antigravity (\u0e23\u0e2d\u0e07\u0e23\u0e31\u0e1a image generation) - claude, codex, qwen, iflow - github-copilot, kiro (CLIProxyAPIPlus only)</p>"},{"location":"archive/CLIProxyAPI_RESEARCH/#format-translation-details","title":"\ud83d\udcd0 Format Translation Details","text":""},{"location":"archive/CLIProxyAPI_RESEARCH/#openrouter-google-imagen","title":"OpenRouter \u2192 Google Imagen","text":"OpenRouter Field Google Imagen Field Notes <code>model</code> Model selection CLIProxyAPI routes to correct endpoint <code>messages[].content</code> <code>instances[].prompt</code> Extract user message <code>modalities</code> N/A Indicates image generation <code>image_config.aspect_ratio</code> <code>parameters.aspectRatio</code> 1:1, 16:9, etc. <code>image_config.image_size</code> N/A May affect quality parameters"},{"location":"archive/CLIProxyAPI_RESEARCH/#response-translation","title":"Response Translation","text":"<p>Google Format: <pre><code>{\n  \"predictions\": [{\n    \"bytesBase64Encoded\": true,\n    \"mimeType\": \"image/png\",\n    \"data\": \"iVBORw0KGgo...\"\n  }]\n}\n</code></pre></p> <p>OpenRouter Format: <pre><code>{\n  \"choices\": [{\n    \"message\": {\n      \"images\": [{\n        \"image_url\": {\n          \"url\": \"data:image/png;base64,iVBORw0KGgo...\"\n        }\n      }]\n    }\n  }]\n}\n</code></pre></p>"},{"location":"archive/CLIProxyAPI_RESEARCH/#_3","title":"\ud83c\udfaf \u0e2a\u0e23\u0e38\u0e1b\u0e2b\u0e25\u0e31\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e33\u0e04\u0e31\u0e0d","text":"<ol> <li>CLIProxyAPI = Format Translator + OAuth Manager</li> <li>\u0e23\u0e31\u0e1a OpenRouter format</li> <li>\u0e41\u0e1b\u0e25\u0e07\u0e40\u0e1b\u0e47\u0e19 provider format</li> <li>\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23 OAuth tokens</li> <li> <p>\u0e41\u0e1b\u0e25\u0e07 response \u0e01\u0e25\u0e31\u0e1a</p> </li> <li> <p>CCS = Token Storage Only</p> </li> <li>\u0e40\u0e01\u0e47\u0e1a OAuth tokens</li> <li>\u0e43\u0e2b\u0e49 tokens \u0e40\u0e21\u0e37\u0e48\u0e2d CLIProxyAPI \u0e02\u0e2d</li> <li> <p>Auto-refresh tokens</p> </li> <li> <p>Request Load = Direct CLIProxyAPI</p> </li> <li>Client \u2192 CLIProxyAPI \u2192 Provider</li> <li> <p>CCS \u0e40\u0e02\u0e49\u0e32\u0e21\u0e32\u0e40\u0e09\u0e1e\u0e32\u0e30\u0e15\u0e2d\u0e19\u0e14\u0e36\u0e07 token \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19</p> </li> <li> <p>Format Compatibility</p> </li> <li>CLIProxyAPI \u0e43\u0e0a\u0e49 OpenRouter format \u0e40\u0e1b\u0e47\u0e19 standard</li> <li>\u0e41\u0e1b\u0e25\u0e07\u0e44\u0e1b\u0e22\u0e31\u0e07 provider-specific formats \u0e42\u0e14\u0e22\u0e2d\u0e31\u0e15\u0e42\u0e19\u0e21\u0e31\u0e15\u0e34</li> <li>\u0e17\u0e33\u0e43\u0e2b\u0e49 client code \u0e43\u0e0a\u0e49 format \u0e40\u0e14\u0e35\u0e22\u0e27\u0e01\u0e31\u0e19\u0e17\u0e38\u0e01 provider</li> </ol>"},{"location":"archive/CLIProxyAPI_RESEARCH/#references","title":"\ud83d\udcda References","text":"<ul> <li>CLIProxyAPI: https://github.com/router-for-me/CLIProxyAPI</li> <li>CLIProxyAPIPlus: https://github.com/router-for-me/CLIProxyAPIPlus</li> <li>Documentation: https://help.router-for.me/</li> <li>OpenRouter API: https://openrouter.ai/docs</li> <li>Google Imagen API: https://ai.google.dev/gemini-api/docs/image-generation</li> </ul>"},{"location":"archive/CLIProxyAPI_RESEARCH/#_4","title":"\u2705 \u0e04\u0e27\u0e32\u0e21\u0e40\u0e02\u0e49\u0e32\u0e43\u0e08\u0e17\u0e35\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07","text":"<p>\u0e08\u0e32\u0e01\u0e01\u0e32\u0e23\u0e27\u0e34\u0e08\u0e31\u0e22 CLIProxyAPIPlus repository \u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e27\u0e48\u0e32:</p> <ol> <li>\u2705 CLIProxyAPI \u0e40\u0e1b\u0e47\u0e19 main request handler - \u0e23\u0e31\u0e1a requests \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07\u0e08\u0e32\u0e01 client</li> <li>\u2705 CCS \u0e40\u0e1b\u0e47\u0e19 token provider \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19 - \u0e43\u0e2b\u0e49 OAuth tokens \u0e40\u0e21\u0e37\u0e48\u0e2d CLIProxyAPI \u0e2a\u0e2d\u0e1a\u0e16\u0e32\u0e21</li> <li>\u2705 Request load \u0e44\u0e21\u0e48\u0e1c\u0e48\u0e32\u0e19 CCS - Client \u2192 CLIProxyAPI \u2192 Google API \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19</li> <li>\u2705 Format translation \u0e40\u0e01\u0e34\u0e14\u0e02\u0e36\u0e49\u0e19\u0e43\u0e19 CLIProxyAPI - \u0e41\u0e1b\u0e25\u0e07 OpenRouter \u2192 Provider format</li> <li>\u2705 OpenRouter format \u0e40\u0e1b\u0e47\u0e19 standard - Client \u0e43\u0e0a\u0e49 format \u0e40\u0e14\u0e35\u0e22\u0e27\u0e01\u0e31\u0e19\u0e17\u0e38\u0e01 provider</li> </ol> <p>Created: 2026-01-14 Research Source: CLIProxyAPIPlus repository analysis</p>"},{"location":"archive/DESIGN/","title":"Video Generation Design Document","text":""},{"location":"archive/DESIGN/#version-32","title":"Version: 3.2","text":""},{"location":"archive/DESIGN/#date-2026-01-18","title":"Date: 2026-01-18","text":""},{"location":"archive/DESIGN/#1-authentication-endpoint-architecture","title":"1. Authentication &amp; Endpoint Architecture","text":""},{"location":"archive/DESIGN/#11-google-api-endpoints-overview","title":"1.1 Google API Endpoints Overview","text":"Endpoint URL Purpose Supports Video (Veo)? Gemini API <code>generativelanguage.googleapis.com</code> Public Gemini API \u2705 Yes Vertex AI <code>{region}-aiplatform.googleapis.com</code> Enterprise GCP API \u2705 Yes Cloud Code Assist <code>cloudcode-pa.googleapis.com</code> Internal IDE API \u274c No"},{"location":"archive/DESIGN/#12-oauth-scope-requirements","title":"1.2 OAuth Scope Requirements","text":"Scope Works with Gemini API? Works with Vertex AI? Works with Cloud Code? <code>generative-language.*</code> \u2705 Yes \u274c No \u274c No <code>cloud-platform</code> \u274c No \u2705 Yes \u2705 Yes"},{"location":"archive/DESIGN/#13-built-in-oauth-client-limitation","title":"1.3 Built-in OAuth Client Limitation","text":"<p>The built-in OAuth client (<code>681255809395-oo8ft2oprdrnp9e3aqf6av3hmdib135j.apps.googleusercontent.com</code>) only has: - <code>cloud-platform</code> scope - <code>userinfo.email</code> scope - <code>userinfo.profile</code> scope</p> <p>It does NOT have <code>generative-language.*</code> scope registered, so it cannot access <code>generativelanguage.googleapis.com</code> directly.</p>"},{"location":"archive/DESIGN/#2-authentication-methods-3","title":"2. Authentication Methods (3 \u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a)","text":""},{"location":"archive/DESIGN/#21-api-key-recommended-simplest","title":"2.1 API Key (Recommended - Simplest)","text":"<pre><code>Authentication: x-goog-api-key header\nEndpoint: generativelanguage.googleapis.com\nBilling Required: No (free tier available)\nVideo Support: \u2705 Yes\n</code></pre> <p>Usage: <pre><code>python video_gen.py \"prompt\" --auth api-key --api-key YOUR_KEY\n</code></pre></p>"},{"location":"archive/DESIGN/#22-built-in-oauth-login","title":"2.2 Built-in OAuth (--login)","text":"<pre><code>Authentication: Bearer token with cloud-platform scope\nEndpoint: aiplatform.googleapis.com (Vertex AI) - FORCED\nBilling Required: Yes\nVideo Support: \u2705 Yes\n</code></pre> <p>Why Vertex AI is forced: - Built-in OAuth only has <code>cloud-platform</code> scope - <code>generativelanguage.googleapis.com</code> requires <code>generative-language.*</code> scope - <code>aiplatform.googleapis.com</code> accepts <code>cloud-platform</code> scope</p> <p>Usage: <pre><code># First login\npython video_gen.py --login\n\n# Then generate\npython video_gen.py \"prompt\" --auth oauth --project-id YOUR_PROJECT\n</code></pre></p>"},{"location":"archive/DESIGN/#23-service-account","title":"2.3 Service Account","text":"<pre><code>Authentication: Bearer token\nEndpoint: aiplatform.googleapis.com (Vertex AI)\nBilling Required: Yes\nVideo Support: \u2705 Yes\n</code></pre> <p>Usage: <pre><code>python video_gen.py \"prompt\" --auth service-account --credentials sa.json --project-id YOUR_PROJECT\n</code></pre></p>"},{"location":"archive/DESIGN/#3-cliproxyapi-architecture-discovery","title":"3. CLIProxyAPI Architecture Discovery","text":""},{"location":"archive/DESIGN/#31-how-cliproxyapi-routes-requests","title":"3.1 How CLIProxyAPI Routes Requests","text":"<p>CLIProxyAPI has multiple executors for different endpoints:</p> <pre><code>gemini_executor.go         \u2192 generativelanguage.googleapis.com (needs API key or special OAuth)\ngemini_vertex_executor.go  \u2192 aiplatform.googleapis.com (Vertex AI)\ngemini_cli_executor.go     \u2192 cloudcode-pa.googleapis.com (Cloud Code Assist)\n</code></pre>"},{"location":"archive/DESIGN/#32-cloud-code-assist-endpoint","title":"3.2 Cloud Code Assist Endpoint","text":"<p>File: <code>gemini_cli_executor.go</code></p> <pre><code>const (\n    codeAssistEndpoint      = \"https://cloudcode-pa.googleapis.com\"\n    codeAssistVersion       = \"v1internal\"\n)\n\nvar geminiOAuthScopes = []string{\n    \"https://www.googleapis.com/auth/cloud-platform\",\n    \"https://www.googleapis.com/auth/userinfo.email\",\n    \"https://www.googleapis.com/auth/userinfo.profile\",\n}\n</code></pre> <p>Supported Actions: - <code>generateContent</code> \u2705 - <code>streamGenerateContent</code> \u2705 - <code>countTokens</code> \u2705 - <code>predictLongRunning</code> \u274c (404 Not Found)</p>"},{"location":"archive/DESIGN/#33-why-image-generation-works-via-cliproxyapi","title":"3.3 Why Image Generation Works via CLIProxyAPI","text":"<p>When using CLIProxyAPI for image generation (e.g., <code>gemini-3-pro-image-preview</code>):</p> <pre><code>Request \u2192 CLIProxyAPI (localhost:8317)\n       \u2192 gemini_cli_executor.go\n       \u2192 cloudcode-pa.googleapis.com/v1internal:generateContent\n       \u2192 Success (uses cloud-platform scope)\n</code></pre>"},{"location":"archive/DESIGN/#34-why-video-generation-fails-via-cliproxyapi","title":"3.4 Why Video Generation Fails via CLIProxyAPI","text":"<p>The <code>cloudcode-pa.googleapis.com</code> endpoint does not support <code>predictLongRunning</code>:</p> <pre><code>Request \u2192 cloudcode-pa.googleapis.com/v1internal:predictLongRunning\n       \u2192 404 Not Found\n</code></pre>"},{"location":"archive/DESIGN/#4-video-generation-flow","title":"4. Video Generation Flow","text":""},{"location":"archive/DESIGN/#41-with-api-key-recommended-for-free-tier","title":"4.1 With API Key (Recommended for Free Tier)","text":"<pre><code>video_gen.py --auth api-key\n     \u2193\nx-goog-api-key header\n     \u2193\ngenerativelanguage.googleapis.com/v1beta/models/{model}:predictLongRunning\n     \u2193\nLong-running operation (poll for result)\n     \u2193\nVideo file saved\n</code></pre>"},{"location":"archive/DESIGN/#42-with-built-in-oauth-requires-billing","title":"4.2 With Built-in OAuth (Requires Billing)","text":"<pre><code>video_gen.py --auth oauth\n     \u2193\nBuilt-in OAuth (cloud-platform scope)\n     \u2193\nFORCED \u2192 Vertex AI endpoint\n     \u2193\n{region}-aiplatform.googleapis.com/v1/projects/{project}/locations/{location}/publishers/google/models/{model}:predictLongRunning\n     \u2193\nLong-running operation (poll for result)\n     \u2193\nVideo file saved\n</code></pre>"},{"location":"archive/DESIGN/#5-project-requirements-for-vertex-ai","title":"5. Project Requirements for Vertex AI","text":""},{"location":"archive/DESIGN/#51-enable-billing","title":"5.1 Enable Billing","text":"<pre><code># Visit:\nhttps://console.developers.google.com/billing/enable?project=YOUR_PROJECT\n</code></pre>"},{"location":"archive/DESIGN/#52-enable-vertex-ai-api","title":"5.2 Enable Vertex AI API","text":"<pre><code>gcloud services enable aiplatform.googleapis.com --project=YOUR_PROJECT\n</code></pre>"},{"location":"archive/DESIGN/#53-required-iam-roles","title":"5.3 Required IAM Roles","text":"<ul> <li><code>roles/aiplatform.user</code> - For predictions</li> <li><code>roles/storage.objectViewer</code> - For accessing generated videos</li> </ul>"},{"location":"archive/DESIGN/#6-token-cache-structure","title":"6. Token Cache Structure","text":""},{"location":"archive/DESIGN/#61-location","title":"6.1 Location","text":"<pre><code>~/.video_gen_tokens.json\n</code></pre>"},{"location":"archive/DESIGN/#62-schema","title":"6.2 Schema","text":"<pre><code>{\n  \"access_token\": \"ya29.xxx\",\n  \"refresh_token\": \"1//xxx\",\n  \"token_type\": \"Bearer\",\n  \"expiry\": \"2026-01-17T14:03:50.124143+00:00\",\n  \"client_id\": \"681255809395-xxx.apps.googleusercontent.com\",\n  \"client_secret\": \"GOCSPX-xxx\",\n  \"email\": \"user@gmail.com\",\n  \"project_id\": \"project1,project2,project3\"\n}\n</code></pre>"},{"location":"archive/DESIGN/#7-error-handling-matrix","title":"7. Error Handling Matrix","text":"Error Cause Solution <code>403: ACCESS_TOKEN_SCOPE_INSUFFICIENT</code> Using cloud-platform scope with Gemini API Use Vertex AI endpoint or API key <code>403: This API method requires billing</code> Vertex AI needs billing enabled Enable billing on GCP project <code>403: Vertex AI API has not been used</code> API not enabled Enable Vertex AI API <code>401: UNAUTHENTICATED</code> Token expired Re-login with <code>--login</code> <code>404: Not Found</code> Wrong endpoint for action Use correct endpoint for the API <code>400: model requires GCP billing enabled</code> Veo 2.0 needs GCP billing Enable billing or use Veo 3.x <code>429: Resource exhausted / quota exceeded</code> No API quota for Veo Enable GCP billing (Veo has no free tier)"},{"location":"archive/DESIGN/#8-veo-api-quota-analysis-critical","title":"8. Veo API Quota Analysis (CRITICAL)","text":""},{"location":"archive/DESIGN/#81-free-tier-availability","title":"8.1 Free Tier Availability","text":"Model Free Tier (API) Paid Tier Veo 3.1 \u274c Not available $0.15-$0.60/second Veo 3 \u274c Not available $0.15-$0.40/second Veo 2 \u274c Not available $0.35/second Gemini 2.5 Flash \u2705 Free Pay-as-you-go Imagen 3 \u274c Not available $0.03/image <p>Key Finding: Veo (all versions) has NO free tier for API access.</p>"},{"location":"archive/DESIGN/#82-google-ai-pro-subscription-vs-api-access","title":"8.2 Google AI Pro Subscription vs API Access","text":"<pre><code>Google AI Pro / Pro Family Subscription\n\u251c\u2500\u2500 App-based Access (UI) \u2705 INCLUDED\n\u2502   \u251c\u2500\u2500 gemini.google.com\n\u2502   \u251c\u2500\u2500 aistudio.google.com\n\u2502   \u2514\u2500\u2500 Veo quota: 3-5 videos/day\n\u2502\n\u2514\u2500\u2500 API Access (generativelanguage.googleapis.com) \u274c NOT INCLUDED\n    \u251c\u2500\u2500 Separate billing system\n    \u251c\u2500\u2500 Pay-as-you-go pricing\n    \u2514\u2500\u2500 Veo: No free tier\n</code></pre>"},{"location":"archive/DESIGN/#83-why-oauth-with-generative-languageperuserquota-gets-429","title":"8.3 Why OAuth with <code>generative-language.peruserquota</code> Gets 429","text":"<p>Even with correct OAuth authentication and <code>generative-language.peruserquota</code> scope: - Authentication: \u2705 Succeeds - API Quota for Veo: \u274c 0 (no free tier) - Result: <code>429 Resource Exhausted</code></p>"},{"location":"archive/DESIGN/#84-solutions-for-video-generation","title":"8.4 Solutions for Video Generation","text":"Solution Cost Complexity Video Quota Gemini App (UI) $19.99/mo (Pro) Low 3-5/day AI Studio (UI) Free (Pro) Low 3-5/day API with GCP Billing Pay-as-you-go Medium Unlimited API Key Pay-as-you-go Low Unlimited"},{"location":"archive/DESIGN/#9-recommended-usage-patterns","title":"9. Recommended Usage Patterns","text":""},{"location":"archive/DESIGN/#91-for-free-usage-api-key","title":"9.1 For Free Usage (API Key)","text":"<pre><code>export GOOGLE_API_KEY=\"your-api-key\"\npython video_gen.py \"A sunset over mountains\" --auth api-key\n</code></pre>"},{"location":"archive/DESIGN/#92-for-enterprisebilling-enabled-oauth-vertex","title":"9.2 For Enterprise/Billing Enabled (OAuth + Vertex)","text":"<pre><code># One-time login\npython video_gen.py --login\n\n# Generate videos\npython video_gen.py \"A sunset over mountains\" --auth oauth --project-id YOUR_PROJECT\n</code></pre>"},{"location":"archive/DESIGN/#93-for-automation-service-account","title":"9.3 For Automation (Service Account)","text":"<pre><code>python video_gen.py \"A sunset over mountains\" \\\n  --auth service-account \\\n  --credentials /path/to/service-account.json \\\n  --project-id YOUR_PROJECT\n</code></pre>"},{"location":"archive/DESIGN/#10-architecture-diagram","title":"10. Architecture Diagram","text":"<pre><code>VIDEO GENERATION ARCHITECTURE (3 Authentication Methods)\n\nvideo_gen.py\n  \u2502\n  \u251c\u2500\u2500 Authentication Methods (\u0e17\u0e38\u0e01 method \u0e15\u0e49\u0e2d\u0e07 Billing \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a Veo)\n  \u2502\n  \u251c\u2500 1. API Key (Recommended)\n  \u2502    \u2193\n  \u2502    Gemini API (generativelanguage.googleapis.com)\n  \u2502    \u2193\n  \u2502    Veo Model (video gen)\n  \u2502\n  \u251c\u2500 2. Built-in OAuth (Human User / Enterprise)\n  \u2502    \u2193\n  \u2502    Vertex AI (aiplatform.googleapis.com)\n  \u2502    \u2193\n  \u2502    Veo Model (video gen)\n  \u2502\n  \u2514\u2500 3. Service Account (Automation / CI-CD)\n       \u2193\n       Vertex AI (aiplatform.googleapis.com)\n       \u2193\n       Veo Model (video gen)\n\nNote: Method 2 &amp; 3 \u0e44\u0e1b\u0e17\u0e35\u0e48 Vertex AI \u0e40\u0e2b\u0e21\u0e37\u0e2d\u0e19\u0e01\u0e31\u0e19\n      \u0e15\u0e48\u0e32\u0e07\u0e01\u0e31\u0e19\u0e41\u0e04\u0e48\u0e27\u0e34\u0e18\u0e35 authentication (Browser vs JSON Key)\n</code></pre>"},{"location":"archive/DESIGN/#11-utility-tools","title":"11. Utility Tools","text":""},{"location":"archive/DESIGN/#111-check_apipy-api-checker-tool","title":"11.1 check_api.py - API Checker Tool","text":"<p>\u0e40\u0e04\u0e23\u0e37\u0e48\u0e2d\u0e07\u0e21\u0e37\u0e2d\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a API Key, models, \u0e41\u0e25\u0e30 quota</p> <p>Features: - List available models (Veo, Imagen, Gemini) - Check API quota status - Test specific model access - Display useful links</p> <p>Usage:</p> <pre><code># Full check (default)\npython check_api.py --api-key YOUR_KEY\n\n# List models only\npython check_api.py --api-key YOUR_KEY --list-models\n\n# Filter by type (veo, imagen, gemini, embedding)\npython check_api.py --api-key YOUR_KEY --filter veo\n\n# Check quota only\npython check_api.py --api-key YOUR_KEY --check-quota\n\n# Test specific model\npython check_api.py --api-key YOUR_KEY --test-model veo-3.1-generate-preview\n\n# Show details\npython check_api.py --api-key YOUR_KEY --details\n\n# Output as JSON\npython check_api.py --api-key YOUR_KEY --json\n</code></pre> <p>Output Example:</p> <pre><code>============================================================\n                  Gemini API Checker v1.0\n============================================================\n\n## Available Models\nVeo (Video) (5)\n  \u2713 veo-3.1-generate-preview\n  \u2713 veo-3.1-fast-generate-preview\n  ...\n\n## Testing API Quota\n\u2713 Text generation: OK\n      Response: API working\n      Tokens used: 48\n\n## Checking Veo Model Access\n\u2713 veo-3.1-generate-preview: Available\n\u2139 Veo models are visible, but generation requires billing enabled\n\n## Summary &amp; Links\n  \u2022 Check usage: https://ai.dev/rate-limit\n  \u2022 API pricing: https://ai.google.dev/gemini-api/docs/pricing\n</code></pre>"},{"location":"archive/DESIGN/#12-image-vs-video-generation-architecture","title":"12. Image vs Video Generation Architecture","text":""},{"location":"archive/DESIGN/#121-api-method-difference-critical","title":"12.1 API Method Difference (Critical)","text":"Feature \ud83d\uddbc\ufe0f Image Generation \ud83c\udfac Video Generation API Method <code>generateContent</code> <code>predictLongRunning</code> Response Type Synchronous (immediate) Asynchronous (polling) Processing Time ~3-10 seconds ~30-120 seconds Payload Format <code>{ contents: [...] }</code> <code>{ instances: [...] }</code> <p>Why Different? - Image: Fast processing \u2192 Synchronous response possible - Video: Long processing \u2192 Must use async long-running operation</p>"},{"location":"archive/DESIGN/#122-endpoint-capabilities-matrix","title":"12.2 Endpoint Capabilities Matrix","text":"<pre><code>ENDPOINT SUPPORT FOR API METHODS\n\ncloudcode-pa.googleapis.com (CLIProxyAPI/Built-in OAuth)\n\u251c\u2500 generateContent:       \u2705 Supported\n\u251c\u2500 streamGenerateContent: \u2705 Supported\n\u251c\u2500 countTokens:           \u2705 Supported\n\u2514\u2500 predictLongRunning:    \u274c 404 NOT FOUND\n\ngenerativelanguage.googleapis.com (Gemini API - API Key)\n\u251c\u2500 generateContent:       \u2705 Supported\n\u251c\u2500 streamGenerateContent: \u2705 Supported\n\u251c\u2500 countTokens:           \u2705 Supported\n\u2514\u2500 predictLongRunning:    \u2705 Supported\n\naiplatform.googleapis.com (Vertex AI - OAuth/Service Account)\n\u251c\u2500 generateContent:       \u2705 Supported\n\u251c\u2500 streamGenerateContent: \u2705 Supported\n\u251c\u2500 predict:               \u2705 Supported\n\u2514\u2500 predictLongRunning:    \u2705 Supported\n</code></pre>"},{"location":"archive/DESIGN/#123-free-tier-availability","title":"12.3 Free Tier Availability","text":"Model Type Model Free Tier Paid Price \ud83d\uddbc\ufe0f Image Gemini 2.0 Flash (image output) \u2705 FREE $0.039/image \ud83d\uddbc\ufe0f Image Gemini 2.5 Flash Image \u274c No $0.039/image \ud83d\uddbc\ufe0f Image Gemini 3 Pro Image \u274c No $0.134/image \ud83d\uddbc\ufe0f Image Imagen 3 \u274c No $0.03/image \ud83d\uddbc\ufe0f Image Imagen 4 \u274c No $0.02-0.06/image \ud83c\udfac Video Veo 2.0 \u274c No $0.35/second \ud83c\udfac Video Veo 3.0 \u274c No $0.15-0.40/second \ud83c\udfac Video Veo 3.1 \u274c No $0.15-0.60/second <p>Key Finding: Only Gemini 2.0 Flash has FREE image generation. ALL video models require billing.</p>"},{"location":"archive/DESIGN/#124-why-image-works-without-api-key","title":"12.4 Why Image Works Without API Key","text":"<pre><code>Image Generation via CLIProxyAPI (Built-in OAuth)\n\nimage_gen.py request\n    \u2502\n    \u25bc\nCLIProxyAPI (localhost:8317)\n    \u2502 Uses built-in OAuth with cloud-platform scope\n    \u25bc\ncloudcode-pa.googleapis.com/v1internal:generateContent\n    \u2502 Method supported \u2705\n    \u25bc\nGemini Model (gemini-2.0-flash / gemini-3-pro-image-preview)\n    \u2502 Has FREE tier \u2705\n    \u25bc\n\u2705 IMAGE GENERATED\n\nSuccess factors:\n1. Method = generateContent (supported by cloudcode endpoint)\n2. Model = Gemini 2.0 Flash (has FREE tier for image output)\n3. OAuth scope = cloud-platform (accepted by cloudcode endpoint)\n</code></pre>"},{"location":"archive/DESIGN/#125-why-video-fails-via-cliproxyapi","title":"12.5 Why Video Fails via CLIProxyAPI","text":"<pre><code>Video Generation via CLIProxyAPI (FAILS)\n\nvideo_gen.py request\n    \u2502\n    \u25bc\nCLIProxyAPI (localhost:8317)\n    \u2502 Uses built-in OAuth with cloud-platform scope\n    \u25bc\ncloudcode-pa.googleapis.com/v1internal:predictLongRunning\n    \u2502\n    \u25bc\n\u274c 404 NOT FOUND\n\nFailure reasons:\n1. Method = predictLongRunning (NOT supported by cloudcode endpoint)\n2. cloudcode-pa is designed for CODE ASSIST, not media generation\n3. Even if method worked, Veo has NO free tier\n</code></pre>"},{"location":"archive/DESIGN/#126-complete-media-generation-flow","title":"12.6 Complete Media Generation Flow","text":"<pre><code>MEDIA GENERATION ARCHITECTURE\n\nYOUR APPLICATION\n  \u2502\n  \u251c\u2500\u2500 Authentication Layer\n  \u2502\n  \u251c\u2500 API Key (Simple)\n  \u2502    \u2193\n  \u2502    generativelanguage.googleapis.com\n  \u2502    \u251c\u2500 generateContent  \u2705\n  \u2502    \u2514\u2500 predictLongRun   \u2705\n  \u2502         \u2193\n  \u2502         \u251c\u2500 \ud83d\uddbc\ufe0f IMAGE: gemini-2.0-flash (FREE \u2705)\n  \u2502         \u251c\u2500 \ud83d\uddbc\ufe0f IMAGE: gemini-2.5-flash-img (PAID)\n  \u2502         \u251c\u2500 \ud83d\uddbc\ufe0f IMAGE: imagen-3/4 (PAID)\n  \u2502         \u2514\u2500 \ud83c\udfac VIDEO: veo-2.0/3.0/3.1 (PAID)\n  \u2502\n  \u251c\u2500 Built-in OAuth (CLIProxyAPI)\n  \u2502    \u2193\n  \u2502    cloudcode-pa.googleapis.com\n  \u2502    \u251c\u2500 generateContent  \u2705\n  \u2502    \u2514\u2500 predictLongRun   \u274c (404)\n  \u2502         \u2193\n  \u2502         \u251c\u2500 \ud83d\uddbc\ufe0f IMAGE: gemini-2.0-flash (FREE \u2705) \u2192 Works!\n  \u2502         \u2514\u2500 \ud83c\udfac VIDEO: Not supported (method 404)\n  \u2502\n  \u2514\u2500 Service Account (Enterprise)\n       \u2193\n       aiplatform.googleapis.com\n       \u251c\u2500 generateContent  \u2705\n       \u2514\u2500 predictLongRun   \u2705\n            \u2193\n            \u251c\u2500 \ud83d\uddbc\ufe0f IMAGE: All models (PAID)\n            \u2514\u2500 \ud83c\udfac VIDEO: veo-2.0/3.0/3.1 (PAID)\n</code></pre>"},{"location":"archive/DESIGN/#127-summary-comparison","title":"12.7 Summary Comparison","text":"Factor \ud83d\uddbc\ufe0f Image (Gemini 2.0 Flash) \ud83c\udfac Video (Veo) API Method <code>generateContent</code> <code>predictLongRunning</code> Response Type Synchronous Asynchronous cloudcode-pa Support \u2705 Yes \u274c No (404) Free Tier \u2705 Yes \u274c No Can use CLIProxyAPI \u2705 Yes \u274c No Requires API Key \u274c Optional \u2705 Yes (or Vertex) Requires Billing \u274c No (Gemini 2.0 Flash) \u2705 Yes (always)"},{"location":"archive/DESIGN/#128-key-insights","title":"12.8 Key Insights","text":"<p>Q: Why does Image generation work without API Key?</p> <p>A: Three factors combined: 1. Method: Image uses <code>generateContent</code> which cloudcode-pa supports 2. Endpoint: CLIProxyAPI uses cloudcode-pa.googleapis.com with OAuth 3. Free Tier: Gemini 2.0 Flash has free tier for image generation</p> <p>Q: Why does Video generation require API Key and Billing?</p> <p>A: Two factors: 1. Method: Video uses <code>predictLongRunning</code> which cloudcode-pa does NOT support (404) 2. No Free Tier: Veo (all versions) has NO free tier - billing required</p>"},{"location":"archive/DESIGN/#13-version-history","title":"13. Version History","text":"Version Date Changes 3.2 2026-01-18 Simplified to 3 auth methods (removed Custom OAuth), clarified Billing requirement 3.1 2026-01-18 Added Image vs Video architecture section with API method analysis 3.0 2026-01-18 Added check_api.py utility tool, updated documentation 2.9 2026-01-18 Added Veo API quota analysis, subscription vs API access 2.8 2026-01-17 Added design documentation, OAuth scope analysis 2.7 2026-01-16 Added built-in OAuth with Vertex AI forced endpoint 2.0 2026-01-15 Initial 8-mode video generation support"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/","title":"\ud83c\udfac Feature Request: Add Veo Video Generation Support (Similar to Image Generation)","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#summary","title":"\ud83d\udccb Summary","text":"<p>Add support for Google's Veo 3.1 video generation models to CLIProxyAPI, following the same architecture pattern as the existing <code>gemini-3-pro-image-preview</code> image generation support.</p> <p>This would enable users to generate videos through CLIProxyAPI using the same OpenRouter-compatible format with <code>modalities: [\"video\", \"text\"]</code> and <code>video_config</code>, just like how image generation currently works.</p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#current-state-image-generation","title":"\ud83c\udfaf Current State (Image Generation)","text":"<p>Currently working perfectly: <pre><code># image_gen.py - Image Generation (\u2705 Working)\nPOST http://127.0.0.1:8317/v1/chat/completions\nAuthorization: Bearer ccs-internal-managed\n\n{\n  \"model\": \"gemini-3-pro-image-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"A cute cat\"}],\n  \"modalities\": [\"image\", \"text\"],\n  \"image_config\": {\n    \"aspect_ratio\": \"1:1\",\n    \"image_size\": \"1K\"\n  }\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"choices\": [{\n    \"message\": {\n      \"images\": [{\n        \"image_url\": {\"url\": \"data:image/png;base64,...\"}\n      }]\n    }\n  }]\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#requested-feature-video-generation","title":"\ud83c\udfac Requested Feature (Video Generation)","text":"<p>Desired behavior: <pre><code># video_gen.py - Video Generation (\ud83c\udfaf Desired)\nPOST http://127.0.0.1:8317/v1/chat/completions\nAuthorization: Bearer ccs-internal-managed\n\n{\n  \"model\": \"veo-3.1-generate-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"A cat playing with a ball\"}],\n  \"modalities\": [\"video\", \"text\"],\n  \"video_config\": {\n    \"duration_seconds\": \"8\",\n    \"aspect_ratio\": \"16:9\",\n    \"resolution\": \"720p\"\n  }\n}\n</code></pre></p> <p>Expected Response: <pre><code>{\n  \"choices\": [{\n    \"message\": {\n      \"videos\": [{\n        \"video_url\": {\"url\": \"data:video/mp4;base64,...\"}\n      }]\n    }\n  }]\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#google-veo-api-details","title":"\ud83d\udcca Google Veo API Details","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#official-rest-api-format","title":"Official REST API Format","text":"<p>Endpoint: <pre><code>POST https://generativelanguage.googleapis.com/v1beta/models/veo-3.1-generate-preview:predictLongRunning\n</code></pre></p> <p>Request Format (Google Native): <pre><code>{\n  \"instances\": [{\n    \"prompt\": \"A cinematic shot of a majestic lion in the savannah\"\n  }],\n  \"parameters\": {\n    \"aspectRatio\": \"16:9\",\n    \"resolution\": \"720p\",\n    \"durationSeconds\": \"8\"\n  }\n}\n</code></pre></p> <p>Response (Async Operation): <pre><code>{\n  \"name\": \"operations/veo-3.1-generate-preview/123456789\",\n  \"done\": false,\n  \"metadata\": {\n    \"@type\": \"type.googleapis.com/google.api.Operation\"\n  }\n}\n</code></pre></p> <p>Poll for Completion: <pre><code>GET https://generativelanguage.googleapis.com/v1beta/{operation_name}\n</code></pre></p> <p>Final Response: <pre><code>{\n  \"name\": \"operations/...\",\n  \"done\": true,\n  \"response\": {\n    \"generateVideoResponse\": {\n      \"generatedSamples\": [{\n        \"video\": {\n          \"uri\": \"https://generativelanguage.googleapis.com/v1beta/...\"\n        }\n      }]\n    }\n  }\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#supported-veo-models","title":"Supported Veo Models","text":"Model Type Resolution Duration <code>veo-3.1-generate-preview</code> Preview 720p, 1080p 4s, 6s, 8s <code>veo-3.1-fast-generate-preview</code> Fast Preview 720p, 1080p 4s, 6s, 8s <code>veo-3.0-generate-001</code> Stable 720p, 1080p 8s <code>veo-3.0-fast-generate-001</code> Fast Stable 720p, 1080p 8s"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#key-parameters","title":"Key Parameters","text":"Parameter Type Values Description <code>prompt</code> string - Text description for video <code>aspectRatio</code> string <code>\"16:9\"</code>, <code>\"9:16\"</code> Video aspect ratio <code>resolution</code> string <code>\"720p\"</code>, <code>\"1080p\"</code> Video resolution <code>durationSeconds</code> string <code>\"4\"</code>, <code>\"6\"</code>, <code>\"8\"</code> Video length in seconds <code>negativePrompt</code> string - What NOT to include"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#proposed-implementation","title":"\ud83c\udfd7\ufe0f Proposed Implementation","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#1-openrouter-format-input","title":"1. OpenRouter Format (Input)","text":"<p>Video Generation Request: <pre><code>{\n  \"model\": \"veo-3.1-generate-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"Prompt text here\"}],\n  \"modalities\": [\"video\", \"text\"],\n  \"video_config\": {\n    \"duration_seconds\": \"8\",\n    \"aspect_ratio\": \"16:9\",\n    \"resolution\": \"720p\",\n    \"negative_prompt\": \"cartoon, drawing, low quality\"\n  }\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#2-translation-logic-go","title":"2. Translation Logic (Go)","text":"<p>OpenRouter \u2192 Google Veo Format: <pre><code>// Translate OpenRouter video request to Google Veo format\nfunc translateVideoRequest(req OpenRouterRequest) VeoRequest {\n    config := req.VideoConfig\n\n    return VeoRequest{\n        Instances: []VeoInstance{\n            {Prompt: extractPrompt(req.Messages)},\n        },\n        Parameters: VeoParameters{\n            AspectRatio: translateAspectRatio(config.AspectRatio),\n            Resolution: config.Resolution,\n            DurationSeconds: config.DurationSeconds,\n            NegativePrompt: config.NegativePrompt,\n        },\n    }\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#3-response-translation","title":"3. Response Translation","text":"<p>Google Veo \u2192 OpenRouter Format: <pre><code>// Translate Google Veo response to OpenRouter format\nfunc translateVideoResponse(resp VeoResponse) OpenRouterResponse {\n    video := resp.Response.GenerateVideoResponse.GeneratedSamples[0].Video\n\n    return OpenRouterResponse{\n        Choices: []Choice{\n            {\n                Message: Message{\n                    Videos: []Video{\n                        {\n                            VideoURL: VideoURL{\n                                URL: \"data:video/mp4;base64,\" + video.VideoBytes,\n                            },\n                        },\n                    },\n                },\n            },\n        },\n    }\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#4-async-operation-handling","title":"4. Async Operation Handling","text":"<p>Video generation is asynchronous - needs polling:</p> <pre><code>// Poll operation until video is ready\nfunc waitForVideoOperation(operationName string) (*VeoResponse, error) {\n    for {\n        resp := getOperation(operationName)\n\n        if resp.Done {\n            return resp.Response, nil\n        }\n\n        time.Sleep(10 * time.Second)\n    }\n}\n</code></pre>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#5-model-routing","title":"5. Model Routing","text":"<p>Add to routing table: <pre><code>var modelRoutes = map[string]string{\n    // Image models (existing)\n    \"gemini-3-pro-image-preview\": \"imagen-3.0-generate-001\",\n\n    // Video models (new)\n    \"veo-3.1-generate-preview\": \"veo-3.1-generate-preview:predictLongRunning\",\n    \"veo-3.1-fast-generate-preview\": \"veo-3.1-fast-generate-preview:predictLongRunning\",\n    \"veo-3.0-generate-001\": \"veo-3.0-generate-001:predictLongRunning\",\n    \"veo-3.0-fast-generate-001\": \"veo-3.0-fast-generate-001:predictLongRunning\",\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#architecture-comparison","title":"\ud83d\udcd0 Architecture Comparison","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#image-generation-current","title":"Image Generation (Current)","text":"<pre><code>Client Request (OpenRouter)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nGoogle Imagen API (synchronous)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nClient Response (OpenRouter)\n</code></pre>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#video-generation-proposed","title":"Video Generation (Proposed)","text":"<pre><code>Client Request (OpenRouter)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nGoogle Veo API (asynchronous)\n    \u2193\nCLIProxyAPI Poller (poll until done)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nClient Response (OpenRouter)\n</code></pre>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#key-differences-from-image-generation","title":"\ud83d\udd27 Key Differences from Image Generation","text":"Aspect Image Generation Video Generation Response Type Synchronous Asynchronous (Long-running operation) Processing Time ~5-30 seconds 1-5 minutes Polling Required No Yes Response Format Direct base64 URI + async polling Output Size ~100KB-2MB ~5-20MB Endpoint <code>:predict</code> <code>:predictLongRunning</code>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#acceptance-criteria","title":"\u2705 Acceptance Criteria","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#must-have","title":"Must Have","text":"<ul> <li> Support <code>veo-3.1-generate-preview</code> model</li> <li> Accept OpenRouter format with <code>modalities: [\"video\", \"text\"]</code></li> <li> Accept <code>video_config</code> parameters:</li> <li><code>duration_seconds</code></li> <li><code>aspect_ratio</code></li> <li><code>resolution</code></li> <li><code>negative_prompt</code></li> <li> Translate OpenRouter \u2192 Google Veo format</li> <li> Handle async operation (polling mechanism)</li> <li> Translate response back to OpenRouter format</li> <li> Return video as base64 data URI (<code>data:video/mp4;base64,...</code>)</li> <li> Use OAuth authentication from CCS (same as image)</li> <li> Route through <code>gemini</code> provider channel</li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#nice-to-have","title":"Nice to Have","text":"<ul> <li> Support <code>veo-3.1-fast-generate-preview</code> (faster generation)</li> <li> Support <code>veo-3.0-generate-001</code> (stable version)</li> <li> Support image-to-video generation</li> <li> Support video extension</li> <li> Progress reporting during polling</li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#reference-implementations","title":"\ud83d\udcda Reference Implementations","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#image-generation-working-reference","title":"Image Generation (Working Reference)","text":"<p>Current implementation for <code>gemini-3-pro-image-preview</code>:</p> <ol> <li>Client script: <code>image_gen.py</code></li> <li>Request format: OpenRouter with <code>modalities: [\"image\", \"text\"]</code></li> <li>Config: <code>image_config</code> with <code>aspect_ratio</code>, <code>image_size</code></li> <li>Response: <code>choices[].message.images[].image_url.url</code></li> <li>Authentication: OAuth from CCS (<code>ccs-internal-managed</code>)</li> </ol>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#google-official-documentation","title":"Google Official Documentation","text":"<ul> <li>Video API Docs: https://ai.google.dev/gemini-api/docs/video</li> <li>REST API: <code>POST /v1beta/models/veo-3.1-generate-preview:predictLongRunning</code></li> <li>Async Operations: Poll <code>GET /v1beta/{operation_name}</code> until <code>done: true</code></li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#use-case-example","title":"\ud83c\udfaf Use Case Example","text":"<p>User Story:</p> <p>As a developer using CLIProxyAPI, I want to generate videos using Veo 3.1 through the same OpenRouter-compatible interface that I use for image generation, so that I can use a consistent API format across both image and video generation.</p> <p>Example Workflow: <pre><code># Generate image\nimage = generate_image(\"A cat\", aspect_ratio=\"1:1\")\n\n# Generate video (using same interface)\nvideo = generate_video(\"A cat playing\",\n                        duration_seconds=\"8\",\n                        aspect_ratio=\"16:9\",\n                        resolution=\"720p\")\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#related-issues","title":"\ud83d\udd17 Related Issues","text":"<ul> <li>Discussion #378: OpenRouter image generation format</li> <li>Image generation implementation (reference for video)</li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#additional-notes","title":"\ud83d\udcdd Additional Notes","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#authentication","title":"Authentication","text":"<p>Video generation should use the same OAuth authentication as image generation: - Token source: <code>~/.ccs/cliproxy/auth/gemini-*.json</code> - Header: <code>Authorization: Bearer ccs-internal-managed</code> - Provider: <code>gemini</code> channel</p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#compatibility","title":"Compatibility","text":"<ul> <li>Backward compatible: Does not break existing image generation</li> <li>Same endpoint: <code>/v1/chat/completions</code></li> <li>Same auth method: <code>ccs-internal-managed</code></li> <li>New modality: <code>video</code> (in addition to existing <code>image</code>, <code>text</code>)</li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#error-handling","title":"Error Handling","text":"<ul> <li>Handle operation timeout</li> <li>Handle quota exceeded</li> <li>Handle polling failures</li> <li>Handle video generation failures</li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT/#thank-you","title":"\ud83d\ude4f Thank You","text":"<p>This feature would enable video generation capabilities through CLIProxyAPI using the same clean, consistent interface that makes image generation so easy to use!</p> <p>Labels: <code>enhancement</code>, <code>video generation</code>, <code>veo</code>, <code>feature request</code> Priority: Medium Complexity: Medium (requires async polling, similar architecture to existing image generation)</p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/","title":"\ud83c\udfac Feature Request: Add Veo Video Generation Support (Similar to Image Generation)","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#summary","title":"\ud83d\udccb Summary","text":"<p>Add support for Google's Veo 3.1 video generation models to CLIProxyAPI, following the same architecture pattern as the existing <code>gemini-3-pro-image-preview</code> image generation support.</p> <p>This would enable users to generate videos through CLIProxyAPI using the same client format with <code>modalities: [\"video\", \"text\"]</code> and <code>video_config</code>, just like how image generation currently works.</p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#current-state-image-generation","title":"\ud83c\udfaf Current State (Image Generation)","text":"<p>Currently working perfectly: <pre><code># image_gen.py - Image Generation (\u2705 Working)\nPOST http://127.0.0.1:8317/v1/chat/completions\nAuthorization: Bearer ccs-internal-managed\n\n{\n  \"model\": \"gemini-3-pro-image-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"A cute cat\"}],\n  \"modalities\": [\"image\", \"text\"],\n  \"image_config\": {\n    \"aspect_ratio\": \"1:1\",\n    \"image_size\": \"1K\"\n  }\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"choices\": [{\n    \"message\": {\n      \"images\": [{\n        \"image_url\": {\"url\": \"data:image/png;base64,...\"}\n      }]\n    }\n  }]\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#reference-implementation-image_genpy","title":"\ud83d\udcbb Reference Implementation (image_gen.py)","text":"<p>CLIProxyAPI \u0e43\u0e0a\u0e49 format translation mechanism \u0e02\u0e2d\u0e07\u0e15\u0e31\u0e27\u0e40\u0e2d\u0e07 - \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e1c\u0e48\u0e32\u0e19 OpenRouter</p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#key-code-sections","title":"Key Code Sections","text":"<p>1. Authentication (lines 41-44) <pre><code># Headers with CCS internal authentication\nHEADERS = {\n    \"Authorization\": \"Bearer ccs-internal-managed\",\n    \"Content-Type\": \"application/json\"\n}\n</code></pre></p> <p>2. Request Payload (lines 94-107) <pre><code>payload = {\n    \"model\": model,\n    \"messages\": [\n        {\n            \"role\": \"user\",\n            \"content\": prompt\n        }\n    ],\n    \"modalities\": [\"image\", \"text\"],\n    \"image_config\": {\n        \"aspect_ratio\": aspect_ratio,\n        \"image_size\": image_size\n    }\n}\n</code></pre></p> <p>3. Response Handling (lines 129-189) <pre><code>result = response.json()\n\nif result.get(\"choices\"):\n    message = result[\"choices\"][0].get(\"message\", {})\n\n    if message.get(\"images\"):\n        for i, image_obj in enumerate(message[\"images\"]):\n            image_url = image_obj.get(\"image_url\", {}).get(\"url\", \"\")\n\n            if image_url:\n                # Save base64 image data\n                saved_path = save_image(image_url, output_dir, i)\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#architecture-flow","title":"Architecture Flow","text":"<pre><code>Client Request (CLIProxyAPI format)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nQuery CCS for OAuth token\n    \u2193\nGoogle Imagen API (with Bearer token)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nClient Response (CLIProxyAPI format)\n</code></pre>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#requested-feature-video-generation","title":"\ud83c\udfac Requested Feature (Video Generation)","text":"<p>Desired behavior: <pre><code># video_gen.py - Video Generation (\ud83c\udfaf Desired)\nPOST http://127.0.0.1:8317/v1/chat/completions\nAuthorization: Bearer ccs-internal-managed\n\n{\n  \"model\": \"veo-3.1-generate-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"A cat playing with a ball\"}],\n  \"modalities\": [\"video\", \"text\"],\n  \"video_config\": {\n    \"duration_seconds\": \"8\",\n    \"aspect_ratio\": \"16:9\",\n    \"resolution\": \"720p\"\n  }\n}\n</code></pre></p> <p>Expected Response: <pre><code>{\n  \"choices\": [{\n    \"message\": {\n      \"videos\": [{\n        \"video_url\": {\"url\": \"data:video/mp4;base64,...\"}\n      }]\n    }\n  }]\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#google-veo-api-details","title":"\ud83d\udcca Google Veo API Details","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#official-rest-api-format","title":"Official REST API Format","text":"<p>Endpoint: <pre><code>POST https://generativelanguage.googleapis.com/v1beta/models/veo-3.1-generate-preview:predictLongRunning\n</code></pre></p> <p>Request Format (Google Native): <pre><code>{\n  \"instances\": [{\n    \"prompt\": \"A cinematic shot of a majestic lion in the savannah\"\n  }],\n  \"parameters\": {\n    \"aspectRatio\": \"16:9\",\n    \"resolution\": \"720p\",\n    \"durationSeconds\": \"8\"\n  }\n}\n</code></pre></p> <p>Response (Async Operation): <pre><code>{\n  \"name\": \"operations/veo-3.1-generate-preview/123456789\",\n  \"done\": false,\n  \"metadata\": {\n    \"@type\": \"type.googleapis.com/google.api.Operation\"\n  }\n}\n</code></pre></p> <p>Poll for Completion: <pre><code>GET https://generativelanguage.googleapis.com/v1beta/{operation_name}\n</code></pre></p> <p>Final Response: <pre><code>{\n  \"name\": \"operations/...\",\n  \"done\": true,\n  \"response\": {\n    \"generateVideoResponse\": {\n      \"generatedSamples\": [{\n        \"video\": {\n          \"uri\": \"https://generativelanguage.googleapis.com/v1beta/...\"\n        }\n      }]\n    }\n  }\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#supported-veo-models","title":"Supported Veo Models","text":"Model Type Resolution Duration <code>veo-3.1-generate-preview</code> Preview 720p, 1080p 4s, 6s, 8s <code>veo-3.1-fast-generate-preview</code> Fast Preview 720p, 1080p 4s, 6s, 8s <code>veo-3.0-generate-001</code> Stable 720p, 1080p 8s <code>veo-3.0-fast-generate-001</code> Fast Stable 720p, 1080p 8s"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#key-parameters","title":"Key Parameters","text":"Parameter Type Values Description <code>prompt</code> string - Text description for video <code>aspectRatio</code> string <code>\"16:9\"</code>, <code>\"9:16\"</code> Video aspect ratio <code>resolution</code> string <code>\"720p\"</code>, <code>\"1080p\"</code> Video resolution <code>durationSeconds</code> string <code>\"4\"</code>, <code>\"6\"</code>, <code>\"8\"</code> Video length in seconds <code>negativePrompt</code> string - What NOT to include"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#proposed-implementation","title":"\ud83c\udfd7\ufe0f Proposed Implementation","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#1-client-format-input-cliproxyapi-format","title":"1. Client Format (Input) - CLIProxyAPI Format","text":"<p>Video Generation Request: <pre><code>{\n  \"model\": \"veo-3.1-generate-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"Prompt text here\"}],\n  \"modalities\": [\"video\", \"text\"],\n  \"video_config\": {\n    \"duration_seconds\": \"8\",\n    \"aspect_ratio\": \"16:9\",\n    \"resolution\": \"720p\",\n    \"negative_prompt\": \"cartoon, drawing, low quality\"\n  }\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#2-translation-logic-go","title":"2. Translation Logic (Go)","text":"<p>CLIProxyAPI Format \u2192 Google Veo Format: <pre><code>// Translate CLIProxyAPI video request to Google Veo format\nfunc translateVideoRequest(req CLIProxyAPIRequest) VeoRequest {\n    config := req.VideoConfig\n\n    return VeoRequest{\n        Instances: []VeoInstance{\n            {Prompt: extractPrompt(req.Messages)},\n        },\n        Parameters: VeoParameters{\n            AspectRatio: translateAspectRatio(config.AspectRatio),\n            Resolution: config.Resolution,\n            DurationSeconds: config.DurationSeconds,\n            NegativePrompt: config.NegativePrompt,\n        },\n    }\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#3-response-translation","title":"3. Response Translation","text":"<p>Google Veo \u2192 CLIProxyAPI Format: <pre><code>// Translate Google Veo response to CLIProxyAPI format\nfunc translateVideoResponse(resp VeoResponse) CLIProxyAPIResponse {\n    video := resp.Response.GenerateVideoResponse.GeneratedSamples[0].Video\n\n    return CLIProxyAPIResponse{\n        Choices: []Choice{\n            {\n                Message: Message{\n                    Videos: []Video{\n                        {\n                            VideoURL: VideoURL{\n                                URL: \"data:video/mp4;base64,\" + video.VideoBytes,\n                            },\n                        },\n                    },\n                },\n            },\n        },\n    }\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#4-async-operation-handling","title":"4. Async Operation Handling","text":"<p>Video generation is asynchronous - needs polling:</p> <pre><code>// Poll operation until video is ready\nfunc waitForVideoOperation(operationName string) (*VeoResponse, error) {\n    for {\n        resp := getOperation(operationName)\n\n        if resp.Done {\n            return resp.Response, nil\n        }\n\n        time.Sleep(10 * time.Second)\n    }\n}\n</code></pre>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#5-model-routing","title":"5. Model Routing","text":"<p>Add to routing table: <pre><code>var modelRoutes = map[string]string{\n    // Image models (existing)\n    \"gemini-3-pro-image-preview\": \"imagen-3.0-generate-001\",\n\n    // Video models (new)\n    \"veo-3.1-generate-preview\": \"veo-3.1-generate-preview:predictLongRunning\",\n    \"veo-3.1-fast-generate-preview\": \"veo-3.1-fast-generate-preview:predictLongRunning\",\n    \"veo-3.0-generate-001\": \"veo-3.0-generate-001:predictLongRunning\",\n    \"veo-3.0-fast-generate-001\": \"veo-3.0-fast-generate-001:predictLongRunning\",\n}\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#architecture-comparison","title":"\ud83d\udcd0 Architecture Comparison","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#image-generation-current","title":"Image Generation (Current)","text":"<pre><code>Client Request (CLIProxyAPI format)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nQuery CCS for OAuth token\n    \u2193\nGoogle Imagen API (synchronous)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nClient Response (CLIProxyAPI format)\n</code></pre>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#video-generation-proposed","title":"Video Generation (Proposed)","text":"<pre><code>Client Request (CLIProxyAPI format)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nQuery CCS for OAuth token\n    \u2193\nGoogle Veo API (asynchronous)\n    \u2193\nCLIProxyAPI Poller (poll until done)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nClient Response (CLIProxyAPI format)\n</code></pre>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#key-differences-from-image-generation","title":"\ud83d\udd27 Key Differences from Image Generation","text":"Aspect Image Generation Video Generation Response Type Synchronous Asynchronous (Long-running operation) Processing Time ~5-30 seconds 1-5 minutes Polling Required No Yes Response Format Direct base64 URI + async polling Output Size ~100KB-2MB ~5-20MB Endpoint <code>:predict</code> <code>:predictLongRunning</code>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#acceptance-criteria","title":"\u2705 Acceptance Criteria","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#must-have","title":"Must Have","text":"<ul> <li> Support <code>veo-3.1-generate-preview</code> model</li> <li> Accept CLIProxyAPI format with <code>modalities: [\"video\", \"text\"]</code></li> <li> Accept <code>video_config</code> parameters:</li> <li><code>duration_seconds</code></li> <li><code>aspect_ratio</code></li> <li><code>resolution</code></li> <li><code>negative_prompt</code></li> <li> Translate CLIProxyAPI \u2192 Google Veo format</li> <li> Handle async operation (polling mechanism)</li> <li> Translate response back to CLIProxyAPI format</li> <li> Return video as base64 data URI (<code>data:video/mp4;base64,...</code>)</li> <li> Use OAuth authentication from CCS (same as image)</li> <li> Route through <code>gemini</code> provider channel</li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#nice-to-have","title":"Nice to Have","text":"<ul> <li> Support <code>veo-3.1-fast-generate-preview</code> (faster generation)</li> <li> Support <code>veo-3.0-generate-001</code> (stable version)</li> <li> Support image-to-video generation</li> <li> Support video extension</li> <li> Progress reporting during polling</li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#reference-code-files","title":"\ud83d\udcda Reference Code Files","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#image-generation-working-reference","title":"Image Generation (Working Reference)","text":"<p>File: <code>claude-code-image-generator/image_gen.py</code></p> <p>Key Sections: 1. Lines 41-44: CCS OAuth authentication headers 2. Lines 94-107: Request payload structure 3. Lines 129-189: Response parsing and image extraction</p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#google-official-documentation","title":"Google Official Documentation","text":"<ul> <li>Video API Docs: https://ai.google.dev/gemini-api/docs/video</li> <li>REST API: <code>POST /v1beta/models/veo-3.1-generate-preview:predictLongRunning</code></li> <li>Async Operations: Poll <code>GET /v1beta/{operation_name}</code> until <code>done: true</code></li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#use-case-example","title":"\ud83c\udfaf Use Case Example","text":"<p>User Story:</p> <p>As a developer using CLIProxyAPI, I want to generate videos using Veo 3.1 through the same interface that I use for image generation, so that I can use a consistent API format across both image and video generation.</p> <p>Example Workflow: <pre><code># Generate image\nimage = generate_image(\"A cat\", aspect_ratio=\"1:1\")\n\n# Generate video (using same interface)\nvideo = generate_video(\"A cat playing\",\n                        duration_seconds=\"8\",\n                        aspect_ratio=\"16:9\",\n                        resolution=\"720p\")\n</code></pre></p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#additional-notes","title":"\ud83d\udcdd Additional Notes","text":""},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#authentication","title":"Authentication","text":"<p>Video generation should use the same OAuth authentication as image generation: - Token source: <code>~/.ccs/cliproxy/auth/gemini-*.json</code> - Header: <code>Authorization: Bearer ccs-internal-managed</code> - Provider: <code>gemini</code> channel</p>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#compatibility","title":"Compatibility","text":"<ul> <li>Backward compatible: Does not break existing image generation</li> <li>Same endpoint: <code>/v1/chat/completions</code></li> <li>Same auth method: <code>ccs-internal-managed</code></li> <li>New modality: <code>video</code> (in addition to existing <code>image</code>, <code>text</code>)</li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#error-handling","title":"Error Handling","text":"<ul> <li>Handle operation timeout</li> <li>Handle quota exceeded</li> <li>Handle polling failures</li> <li>Handle video generation failures</li> </ul>"},{"location":"archive/GITHUB_ISSUE_VIDEO_SUPPORT_UPDATED/#thank-you","title":"\ud83d\ude4f Thank You","text":"<p>This feature would enable video generation capabilities through CLIProxyAPI using the same clean, consistent interface that makes image generation so easy to use!</p> <p>Labels: <code>enhancement</code>, <code>video generation</code>, <code>veo</code>, <code>feature request</code> Priority: Medium Complexity: Medium (requires async polling, similar architecture to existing image generation)</p>"},{"location":"archive/GOOGLE_API_CONNECTION/","title":"\ud83d\udd0c CLIProxyAPI \u2192 Google AI API Connection Details","text":""},{"location":"archive/GOOGLE_API_CONNECTION/#cliproxyapi-google-ai-api","title":"\ud83d\udccb \u0e27\u0e34\u0e18\u0e35\u0e01\u0e32\u0e23\u0e40\u0e0a\u0e37\u0e48\u0e2d\u0e21\u0e15\u0e48\u0e2d CLIProxyAPI \u0e44\u0e1b\u0e22\u0e31\u0e07 Google AI API","text":"<p>\u0e40\u0e2d\u0e01\u0e2a\u0e32\u0e23\u0e19\u0e35\u0e49\u0e2d\u0e18\u0e34\u0e1a\u0e32\u0e22\u0e27\u0e34\u0e18\u0e35\u0e01\u0e32\u0e23\u0e40\u0e0a\u0e37\u0e48\u0e2d\u0e21\u0e15\u0e48\u0e2d\u0e02\u0e2d\u0e07 CLIProxyAPI \u0e44\u0e1b\u0e22\u0e31\u0e07 Google AI API \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a image generation</p>"},{"location":"archive/GOOGLE_API_CONNECTION/#authentication-flow","title":"\ud83d\udd11 Authentication Flow","text":""},{"location":"archive/GOOGLE_API_CONNECTION/#step-1-oauth-token-ccs","title":"Step 1: OAuth Token \u0e08\u0e32\u0e01 CCS","text":"<p>CLIProxyAPI \u0e14\u0e36\u0e07 OAuth token \u0e08\u0e32\u0e01 CCS:</p> <p>Token Location: <pre><code>~/.ccs/cliproxy/auth/gemini-user@gmail.com-all.json\n</code></pre></p> <p>Token Structure: <pre><code>{\n  \"token\": {\n    \"access_token\": \"ya29.a0Aa7pCA98eIgxJGjCbQB5...\",\n    \"refresh_token\": \"1//0gY0PBupvqkz1CgYIARAAGBASNwF...\",\n    \"expires_in\": 3599,\n    \"expiry\": \"2025-12-30T00:15:37.120939187+07:00\",\n    \"token_type\": \"Bearer\"\n  },\n  \"email\": \"user@gmail.com\",\n  \"type\": \"gemini\"\n}\n</code></pre></p>"},{"location":"archive/GOOGLE_API_CONNECTION/#step-2-http-request-google-ai-api","title":"Step 2: HTTP Request \u0e44\u0e1b\u0e22\u0e31\u0e07 Google AI API","text":"<p>CLIProxyAPI \u0e2a\u0e23\u0e49\u0e32\u0e07 HTTP request \u0e1e\u0e23\u0e49\u0e2d\u0e21 OAuth token:</p> <p>Request Format: <pre><code>POST https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-001:predict\nContent-Type: application/json\nAuthorization: Bearer ya29.a0Aa7pCA98eIgxJGjCbQB5...\n\n{\n  \"instances\": [\n    {\n      \"prompt\": \"A cute cat playing with a ball\"\n    }\n  ],\n  \"parameters\": {\n    \"sampleCount\": 1,\n    \"aspectRatio\": \"1:1\"\n  }\n}\n</code></pre></p>"},{"location":"archive/GOOGLE_API_CONNECTION/#complete-request-flow","title":"\ud83d\udd04 Complete Request Flow","text":""},{"location":"archive/GOOGLE_API_CONNECTION/#1-client-cliproxyapi","title":"1. Client \u2192 CLIProxyAPI","text":"<p>Request: <pre><code>POST http://127.0.0.1:8317/v1/chat/completions\nAuthorization: Bearer ccs-internal-managed\nContent-Type: application/json\n\n{\n  \"model\": \"gemini-3-pro-image-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"A cute cat\"}],\n  \"modalities\": [\"image\", \"text\"],\n  \"image_config\": {\"aspect_ratio\": \"1:1\", \"image_size\": \"1K\"}\n}\n</code></pre></p> <p>CLIProxyAPI actions: 1. \u0e40\u0e2b\u0e47\u0e19 <code>ccs-internal-managed</code> \u2192 \u0e23\u0e39\u0e49\u0e27\u0e48\u0e32\u0e15\u0e49\u0e2d\u0e07\u0e14\u0e36\u0e07 OAuth token 2. Query CCS \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a actual OAuth token 3. Translate OpenRouter format \u2192 Google Imagen format</p>"},{"location":"archive/GOOGLE_API_CONNECTION/#2-cliproxyapi-ccs-internal-token-query","title":"2. CLIProxyAPI \u2192 CCS (Internal Token Query)","text":"<p>Internal process: <pre><code>CLIProxyAPI reads: ~/.ccs/cliproxy/auth/gemini-*.json\nExtract: access_token (ya29.a0Aa7pCA98e...)\n</code></pre></p>"},{"location":"archive/GOOGLE_API_CONNECTION/#3-cliproxyapi-google-ai-api","title":"3. CLIProxyAPI \u2192 Google AI API","text":"<p>Actual HTTP Request: <pre><code>POST https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-001:predict\nAuthorization: Bearer ya29.a0Aa7pCA98eIgxJGjCbQB5...\nContent-Type: application/json\n\n{\n  \"instances\": [{\"prompt\": \"A cute cat\"}],\n  \"parameters\": {\"sampleCount\": 1, \"aspectRatio\": \"1:1\"}\n}\n</code></pre></p>"},{"location":"archive/GOOGLE_API_CONNECTION/#4-google-ai-api-cliproxyapi","title":"4. Google AI API \u2192 CLIProxyAPI","text":"<p>Response: <pre><code>{\n  \"predictions\": [\n    {\n      \"bytesBase64Encoded\": true,\n      \"mimeType\": \"image/png\",\n      \"data\": \"iVBORw0KGgoAAAANSUhEUgAA...\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"archive/GOOGLE_API_CONNECTION/#5-cliproxyapi-client","title":"5. CLIProxyAPI \u2192 Client","text":"<p>Translated Response: <pre><code>{\n  \"choices\": [\n    {\n      \"message\": {\n        \"images\": [\n          {\n            \"image_url\": {\n              \"url\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA...\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}\n</code></pre></p>"},{"location":"archive/GOOGLE_API_CONNECTION/#format-translation-details","title":"\ud83d\udcd0 Format Translation Details","text":""},{"location":"archive/GOOGLE_API_CONNECTION/#openrouter-google-imagen","title":"OpenRouter \u2192 Google Imagen","text":"OpenRouter Field Google Imagen Field Transformation <code>model</code> URL path <code>gemini-3-pro-image-preview</code> \u2192 <code>/v1beta/models/imagen-3.0-generate-001:predict</code> <code>messages[].content</code> <code>instances[].prompt</code> Extract user message text <code>modalities</code> - Determines if image generation <code>image_config.aspect_ratio</code> <code>parameters.aspectRatio</code> <code>\"1:1\"</code> \u2192 <code>\"1:1\"</code> <code>image_config.image_size</code> - May affect quality"},{"location":"archive/GOOGLE_API_CONNECTION/#response-translation","title":"Response Translation","text":"Google Field OpenRouter Field Transformation <code>predictions[].data</code> <code>choices[].message.images[].image_url.url</code> Add <code>data:image/png;base64,</code> prefix <code>predictions[].mimeType</code> - Used for data URI prefix"},{"location":"archive/GOOGLE_API_CONNECTION/#google-ai-api-endpoints","title":"\ud83c\udf10 Google AI API Endpoints","text":""},{"location":"archive/GOOGLE_API_CONNECTION/#text-generation-gemini","title":"Text Generation (Gemini)","text":"<pre><code>POST https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent\n</code></pre>"},{"location":"archive/GOOGLE_API_CONNECTION/#image-generation-imagen","title":"Image Generation (Imagen)","text":"<pre><code>POST https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-001:predict\n</code></pre>"},{"location":"archive/GOOGLE_API_CONNECTION/#alternative-image-generation","title":"Alternative Image Generation","text":"<pre><code>POST https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict\nPOST https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict\n</code></pre>"},{"location":"archive/GOOGLE_API_CONNECTION/#authentication-details","title":"\ud83d\udd10 Authentication Details","text":""},{"location":"archive/GOOGLE_API_CONNECTION/#oauth-bearer-token","title":"OAuth Bearer Token","text":"<p>Format: <pre><code>Authorization: Bearer ya29.a0Aa7pCA98eIgxJGjCbQB5...\n</code></pre></p> <p>Characteristics: - Token \u0e1b\u0e23\u0e30\u0e21\u0e32\u0e13 200-400 characters - \u0e40\u0e23\u0e34\u0e48\u0e21\u0e15\u0e49\u0e19\u0e14\u0e49\u0e27\u0e22 <code>ya29.</code> - \u0e21\u0e35\u0e2d\u0e32\u0e22\u0e38 ~1 \u0e0a\u0e31\u0e48\u0e27\u0e42\u0e21\u0e07 (3599 seconds) - CCS \u0e08\u0e30 auto-refresh \u0e40\u0e21\u0e37\u0e48\u0e2d\u0e43\u0e01\u0e25\u0e49\u0e2b\u0e21\u0e14\u0e2d\u0e32\u0e22\u0e38</p>"},{"location":"archive/GOOGLE_API_CONNECTION/#token-refresh-flow","title":"Token Refresh Flow","text":"<pre><code>1. CLIProxyAPI detects token expiration\n2. CCS refreshes token automatically\n3. New token stored in ~/.ccs/cliproxy/auth/\n4. CLIProxyAPI uses new token for next request\n</code></pre>"},{"location":"archive/GOOGLE_API_CONNECTION/#implementation-architecture","title":"\ud83e\udde9 Implementation Architecture","text":""},{"location":"archive/GOOGLE_API_CONNECTION/#cliproxyapi-internal-components","title":"CLIProxyAPI Internal Components","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CLIProxyAPI (Go Server)                                   \u2502\n\u2502                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  HTTP Server (port 8317)                             \u2502  \u2502\n\u2502  \u2502  - Receives OpenRouter format requests               \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                     \u2502                                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Request Translator                                  \u2502  \u2502\n\u2502  \u2502  - OpenRouter \u2192 Provider format                     \u2502  \u2502\n\u2502  \u2502  - Extracts modalities, image_config                \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                     \u2502                                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  OAuth Manager                                       \u2502  \u2502\n\u2502  \u2502  - Reads tokens from CCS                            \u2502  \u2502\n\u2502  \u2502  - Manages token refresh                            \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                     \u2502                                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  HTTP Client                                         \u2502  \u2502\n\u2502  \u2502  - Sends requests to Google AI API                  \u2502  \u2502\n\u2502  \u2502  - Adds Bearer token to headers                     \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                     \u2502                                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Response Translator                                 \u2502  \u2502\n\u2502  \u2502  - Provider format \u2192 OpenRouter format               \u2502  \u2502\n\u2502  \u2502  - Wraps base64 data in image_url.url               \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2502\n                      \u2193\n                 Google AI API\n</code></pre>"},{"location":"archive/GOOGLE_API_CONNECTION/#requestresponse-examples","title":"\ud83d\udcca Request/Response Examples","text":""},{"location":"archive/GOOGLE_API_CONNECTION/#image-generation-request","title":"Image Generation Request","text":"<p>Client sends: <pre><code>{\n  \"model\": \"gemini-3-pro-image-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"A futuristic city\"}],\n  \"modalities\": [\"image\", \"text\"],\n  \"image_config\": {\n    \"aspect_ratio\": \"16:9\",\n    \"image_size\": \"1K\"\n  }\n}\n</code></pre></p> <p>CLIProxyAPI translates to: <pre><code>{\n  \"instances\": [{\"prompt\": \"A futuristic city\"}],\n  \"parameters\": {\n    \"sampleCount\": 1,\n    \"aspectRatio\": \"16:9\"\n  }\n}\n</code></pre></p> <p>CLIProxyAPI sends to Google: <pre><code>POST https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-001:predict\nAuthorization: Bearer ya29.a0Aa7pCA98e...\nContent-Type: application/json\n</code></pre></p>"},{"location":"archive/GOOGLE_API_CONNECTION/#key-points-summary","title":"\u2705 Key Points Summary","text":"<ol> <li>Authentication: CLIProxyAPI \u0e43\u0e0a\u0e49 OAuth Bearer token \u0e08\u0e32\u0e01 CCS</li> <li>Token Source: <code>~/.ccs/cliproxy/auth/gemini-*.json</code></li> <li>API Endpoint: <code>https://generativelanguage.googleapis.com/v1beta/models/...</code></li> <li>Header Format: <code>Authorization: Bearer ya29.a0Aa...</code></li> <li>Format Translation: \u0e40\u0e01\u0e34\u0e14\u0e02\u0e36\u0e49\u0e19\u0e43\u0e19 CLIProxyAPI (OpenRouter \u2194 Google)</li> <li>Direct Connection: CLIProxyAPI \u0e40\u0e0a\u0e37\u0e48\u0e2d\u0e21\u0e15\u0e48\u0e2d\u0e42\u0e14\u0e22\u0e15\u0e23\u0e07\u0e44\u0e1b Google API (\u0e44\u0e21\u0e48\u0e1c\u0e48\u0e32\u0e19 CCS)</li> </ol>"},{"location":"archive/GOOGLE_API_CONNECTION/#debugging-connection-issues","title":"\ud83d\udd0d Debugging Connection Issues","text":""},{"location":"archive/GOOGLE_API_CONNECTION/#check-oauth-token","title":"Check OAuth Token","text":"<pre><code>cat ~/.ccs/cliproxy/auth/gemini-*.json\n</code></pre>"},{"location":"archive/GOOGLE_API_CONNECTION/#test-cliproxyapi","title":"Test CLIProxyAPI","text":"<pre><code>curl -X POST http://127.0.0.1:8317/v1/chat/completions \\\n  -H \"Authorization: Bearer ccs-internal-managed\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"model\":\"gemini-3-pro-image-preview\",\"messages\":[{\"role\":\"user\",\"content\":\"test\"}],\"modalities\":[\"image\",\"text\"],\"image_config\":{\"aspect_ratio\":\"1:1\",\"image_size\":\"1K\"}}'\n</code></pre>"},{"location":"archive/GOOGLE_API_CONNECTION/#verify-google-api-access","title":"Verify Google API Access","text":"<pre><code>curl -X POST \"https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-001:predict\" \\\n  -H \"Authorization: Bearer YOUR_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"instances\":[{\"prompt\":\"test\"}],\"parameters\":{\"sampleCount\":1}}'\n</code></pre> <p>Created: 2026-01-14 Purpose: Document CLIProxyAPI \u2192 Google AI API connection details</p>"},{"location":"archive/architecture/","title":"\ud83c\udfd7\ufe0f System Architecture: CLIProxyAPI Image &amp; Video Generator","text":""},{"location":"archive/architecture/#document-overview","title":"Document Overview","text":"<p>Version: 2.1 Last Updated: 2026-01-14 Purpose: System structure and component architecture documentation</p> <p>Documentation v2.1 Changes: - Consolidated with information from research and workflow documents - Aligned with README.md and design.md structure</p>"},{"location":"archive/architecture/#table-of-contents","title":"\ud83d\udccb Table of Contents","text":"<ol> <li>System Overview</li> <li>Component Architecture</li> <li>Data Flow</li> <li>Technology Stack</li> <li>Deployment Architecture</li> <li>Authentication Flow</li> <li>API Integration</li> <li>File System Structure</li> </ol>"},{"location":"archive/architecture/#system-overview","title":"\ud83c\udfaf System Overview","text":""},{"location":"archive/architecture/#high-level-architecture","title":"High-Level Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Client Layer                                               \u2502\n\u2502                                                             \u2502\n\u2502  - image_gen.py (Python CLI)                               \u2502\n\u2502  - video_gen.py (Planned)                                  \u2502\n\u2502  - MCP Tool (Planned)                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502 HTTP POST http://127.0.0.1:8317/v1/chat/completions\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CLIProxyAPI (Main Request Handler)                         \u2502\n\u2502  localhost:8317                                             \u2502\n\u2502                                                             \u2502\n\u2502  - Request translation                                      \u2502\n\u2502  - OAuth management                                         \u2502\n\u2502  - Provider routing                                         \u2502\n\u2502  - Response translation                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                 \u2502 Token Query (Internal Only)         \u2502\n                 \u2193                                     \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CCS (Extension)          \u2502              \u2502  Google AI API              \u2502\n\u2502  ~/.ccs/cliproxy/auth/    \u2502              \u2502  - Imagen API               \u2502\n\u2502                          \u2502              \u2502  - Veo API (Planned)        \u2502\n\u2502  - OAuth token storage    \u2502              \u2502                              \u2502\n\u2502  - Auto-refresh           \u2502              \u2502  - Image generation         \u2502\n\u2502  - Profile management     \u2502              \u2502  - Video generation         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"archive/architecture/#core-principles","title":"Core Principles","text":"<ol> <li>CLIProxyAPI as Main Handler - All requests go through CLIProxyAPI</li> <li>CCS as Token Provider - CCS only provides OAuth tokens (not in request load path)</li> <li>Consistent Interface - Image and video use same format</li> <li>OAuth Authentication - CCS internal managed tokens</li> </ol>"},{"location":"archive/architecture/#component-architecture","title":"\ud83e\udde9 Component Architecture","text":""},{"location":"archive/architecture/#1-cliproxyapi-main-request-handler","title":"1. CLIProxyAPI (Main Request Handler)","text":"<p>Location: localhost:8317 Language: Go Purpose: OAuth Proxy Server + Format Translator</p> <p>Responsibilities: - Receive client requests - Detect <code>ccs-internal-managed</code> authentication - Query CCS for OAuth tokens - Translate request formats (Client \u2192 Google) - Route to appropriate providers - Handle async operations (video polling) - Translate response formats (Google \u2192 Client)</p> <p>Key Functions: <pre><code>- Format Translation\n  - CLIProxyAPI format \u2192 Google Imagen/Veo format\n\n- Authentication Management\n  - Detect ccs-internal-managed\n  - Query CCS for actual OAuth tokens\n\n- Provider Routing\n  - gemini-3-pro-image-preview \u2192 Imagen API\n  - veo-3.1-generate-preview \u2192 Veo API\n\n- Response Processing\n  - Sync responses (Image)\n  - Async polling (Video)\n</code></pre></p>"},{"location":"archive/architecture/#2-ccs-claude-code-switch","title":"2. CCS (Claude Code Switch)","text":"<p>Location: ~/.ccs/ Type: Extension Purpose: Profile Manager + Token Provider</p> <p>Responsibilities: - Store OAuth tokens securely - Auto-refresh tokens before expiry - Manage multiple provider profiles - Provide <code>ccs-internal-managed</code> authentication method</p> <p>Token Storage Structure: <pre><code>~/.ccs/cliproxy/auth/\n\u251c\u2500\u2500 gemini-user@gmail.com-all.json\n\u251c\u2500\u2500 antigravity-user@gmail.com.json\n\u2514\u2500\u2500 kiro-aws-user@gmail.com.json\n</code></pre></p> <p>Token Format: <pre><code>{\n  \"token\": {\n    \"access_token\": \"ya29.a0Aa7pCA98eIgxJGjCbQB5...\",\n    \"refresh_token\": \"1//0gY0PBupvqkz1CgYIARAAGBASNwF...\",\n    \"expires_in\": 3599,\n    \"expiry\": \"2025-12-30T00:15:37.120939187+07:00\",\n    \"token_type\": \"Bearer\"\n  },\n  \"email\": \"user@gmail.com\",\n  \"type\": \"gemini\"\n}\n</code></pre></p>"},{"location":"archive/architecture/#3-client-layer","title":"3. Client Layer","text":""},{"location":"archive/architecture/#image_genpy-current","title":"image_gen.py (Current)","text":"<p>Language: Python Status: \u2705 Working Purpose: Generate images via CLIProxyAPI</p> <p>Features: - CLI argument parsing - Request payload construction - Response parsing - Base64 image decoding - File output management - Metadata tracking</p> <p>Request Flow: <pre><code>python image_gen.py \"A cute cat\" --aspect-ratio 16:9 --image-size 2K\n  \u2193\nBuild CLIProxyAPI payload\n  \u2193\nPOST to http://127.0.0.1:8317/v1/chat/completions\n  \u2193\nParse response &amp; save image\n</code></pre></p>"},{"location":"archive/architecture/#mcp-tool-planned","title":"MCP Tool (Planned)","text":"<p>Type: Model Context Protocol Server Status: \ud83d\udea7 Phase 2 Purpose: Integrate image/video generation with Claude Code CLI</p> <p>Benefits: - Seamless Claude Code integration - Direct file path returns - Multi-step workflow support - No need to leave Claude Code</p>"},{"location":"archive/architecture/#data-flow","title":"\ud83d\udd04 Data Flow","text":""},{"location":"archive/architecture/#image-generation-synchronous","title":"Image Generation (Synchronous)","text":"<pre><code>Step 1: User Request\n  python image_gen.py \"A sunset\" --aspect-ratio 16:9\n  \u2193\nStep 2: Build Request\n  payload = {\n    \"model\": \"gemini-3-pro-image-preview\",\n    \"messages\": [{\"role\": \"user\", \"content\": \"A sunset\"}],\n    \"modalities\": [\"image\", \"text\"],\n    \"image_config\": {\n      \"aspect_ratio\": \"16:9\",\n      \"image_size\": \"1K\"\n    }\n  }\n  \u2193\nStep 3: Send to CLIProxyAPI\n  POST http://127.0.0.1:8317/v1/chat/completions\n  Headers: Authorization: Bearer ccs-internal-managed\n  \u2193\nStep 4: CLIProxyAPI Processing\n  - Detect ccs-internal-managed\n  - Query CCS for OAuth token\n  - Translate to Google Imagen format\n  \u2193\nStep 5: Call Google Imagen API\n  POST https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-001:predict\n  Headers: Authorization: Bearer ya29.a0Aa...\n  \u2193\nStep 6: Wait for Response (5-30 seconds)\n  - Google API processes request\n  - Returns base64 image data\n  \u2193\nStep 7: Response Translation\n  Google format \u2192 CLIProxyAPI format\n  \u2193\nStep 8: Client Processing\n  - Parse JSON response\n  - Extract base64 data\n  - Decode and save as PNG\n  - Save metadata\n  \u2193\nOutput: ./generated_images/image_YYYYMMDD_HHMMSS.png\n</code></pre>"},{"location":"archive/architecture/#video-generation-planned-asynchronous","title":"Video Generation (Planned - Asynchronous)","text":"<pre><code>Step 1: User Request\n  python video_gen.py \"A cat playing\" --duration 8\n  \u2193\nStep 2: Build Request\n  payload = {\n    \"model\": \"veo-3.1-generate-preview\",\n    \"messages\": [{\"role\": \"user\", \"content\": \"A cat playing\"}],\n    \"modalities\": [\"video\", \"text\"],\n    \"video_config\": {\n      \"duration_seconds\": \"8\",\n      \"aspect_ratio\": \"16:9\",\n      \"resolution\": \"720p\"\n    }\n  }\n  \u2193\nStep 3: Send to CLIProxyAPI\n  POST http://127.0.0.1:8317/v1/chat/completions\n  \u2193\nStep 4: CLIProxyAPI Processing\n  - Query CCS for OAuth token\n  - Translate to Google Veo format\n  \u2193\nStep 5: Call Google Veo API (Long-Running)\n  POST .../veo-3.1-generate-preview:predictLongRunning\n  \u2193\nStep 6: Receive Operation Name\n  {\n    \"name\": \"operations/veo-3.1-generate-preview/123456789\",\n    \"done\": false\n  }\n  \u2193\nStep 7: Poll Operation (1-5 minutes)\n  GET .../operations/{operation_name}\n  - Wait 10 seconds between polls\n  - Check if \"done\": true\n  \u2193\nStep 8: Download Video\n  - Extract video URI from response\n  - Download video file\n  - Convert to base64\n  \u2193\nStep 9: Response Translation\n  Google format \u2192 CLIProxyAPI format\n  \u2193\nStep 10: Client Processing\n  - Parse JSON response\n  - Extract base64 data\n  - Decode and save as MP4\n  \u2193\nOutput: ./generated_videos/video_YYYYMMDD_HHMMSS.mp4\n</code></pre>"},{"location":"archive/architecture/#technology-stack","title":"\ud83d\udd27 Technology Stack","text":""},{"location":"archive/architecture/#client-layer","title":"Client Layer","text":"Component Technology Version Purpose image_gen.py Python 3.x Image generation client video_gen.py Python 3.x Video generation client (planned) MCP Server Python/TypeScript - Claude Code integration (planned)"},{"location":"archive/architecture/#server-layer","title":"Server Layer","text":"Component Technology Version Purpose CLIProxyAPI Go Latest OAuth proxy + format translator CCS Shell/Python - Profile + token management"},{"location":"archive/architecture/#api-layer","title":"API Layer","text":"Provider API Authentication Models Google AI Imagen API OAuth 2.0 gemini-3-pro-image-preview, gemini-2.5-flash-image Google AI Veo API OAuth 2.0 veo-3.1-generate-preview (planned)"},{"location":"archive/architecture/#data-formats","title":"Data Formats","text":"Purpose Format Notes Request (Client) CLIProxyAPI format OpenRouter-compatible Request (Google) Google native format instances/parameters Response (Client) CLIProxyAPI format choices/message/images Image Output PNG Base64 encoded Video Output MP4 Base64 encoded"},{"location":"archive/architecture/#deployment-architecture","title":"\ud83d\ude80 Deployment Architecture","text":""},{"location":"archive/architecture/#development-environment","title":"Development Environment","text":"<pre><code>Local Machine\n\u251c\u2500\u2500 CLIProxyAPI Server\n\u2502   \u251c\u2500\u2500 Port: 8317\n\u2502   \u251c\u2500\u2500 Location: localhost\n\u2502   \u2514\u2500\u2500 Status: Running\n\u251c\u2500\u2500 CCS Extension\n\u2502   \u251c\u2500\u2500 Location: ~/.ccs/\n\u2502   \u2514\u2500\u2500 Config: ~/.ccs/config.yaml\n\u251c\u2500\u2500 Client Scripts\n\u2502   \u251c\u2500\u2500 image_gen.py (working)\n\u2502   \u2514\u2500\u2500 video_gen.py (planned)\n\u2514\u2500\u2500 Output Directories\n    \u251c\u2500\u2500 ./generated_images/\n    \u2514\u2500\u2500 ./generated_videos/ (planned)\n</code></pre>"},{"location":"archive/architecture/#configuration-files","title":"Configuration Files","text":"File Location Purpose CCS Config ~/.ccs/config.yaml Main CCS configuration Gemini Settings ~/.ccs/gemini.settings.json Gemini profile settings OAuth Tokens ~/.ccs/cliproxy/auth/*.json OAuth token storage CCS Auth ~/.ccs/cliproxy/auth/gemini-*.json Gemini OAuth tokens"},{"location":"archive/architecture/#network-flow","title":"Network Flow","text":"<pre><code>Client (localhost)\n    \u2193\nCLIProxyAPI (localhost:8317)\n    \u2193\nGoogle AI API (generativelanguage.googleapis.com)\n    \u2193\nResponse back through same path\n</code></pre>"},{"location":"archive/architecture/#authentication-flow","title":"\ud83d\udd10 Authentication Flow","text":""},{"location":"archive/architecture/#special-token-ccs-internal-managed","title":"Special Token: <code>ccs-internal-managed</code>","text":"<p>NOT a real token - It's a special identifier that tells CLIProxyAPI: - \"Don't use this header as actual authentication\" - \"Query CCS for the real OAuth token instead\" - \"CCS will handle token refresh automatically\"</p>"},{"location":"archive/architecture/#authentication-chain","title":"Authentication Chain","text":"<pre><code>Step 1: Client sends request\n  Headers: Authorization: Bearer ccs-internal-managed\n  \u2193\nStep 2: CLIProxyAPI receives request\n  - Sees \"ccs-internal-managed\"\n  - Recognizes need for OAuth token\n  \u2193\nStep 3: CLIProxyAPI queries CCS\n  - Reads: ~/.ccs/cliproxy/auth/gemini-*.json\n  - Extracts: access_token\n  \u2193\nStep 4: CCS provides OAuth token\n  - Returns: ya29.a0Aa7pCA98eIgxJGjCbQB5...\n  - Includes: expiry information\n  \u2193\nStep 5: CLIProxyAPI calls Google API\n  Headers: Authorization: Bearer ya29.a0Aa...\n  \u2193\nStep 6: Google validates token\n  - OAuth 2.0 validation\n  - Grants access if valid\n  \u2193\nStep 7: Request processed\n  - Image/video generation\n  - Response returned\n</code></pre>"},{"location":"archive/architecture/#token-refresh-flow","title":"Token Refresh Flow","text":"<pre><code>CLIProxyAPI detects token expiration\n  \u2193\nAuto-refresh triggered\n  \u2193\nCCS uses refresh_token\n  \u2193\nNew access_token generated\n  \u2193\nUpdated in ~/.ccs/cliproxy/auth/\n  \u2193\nCLIProxyAPI uses new token\n</code></pre>"},{"location":"archive/architecture/#api-integration","title":"\ud83c\udf10 API Integration","text":""},{"location":"archive/architecture/#google-imagen-api","title":"Google Imagen API","text":"<p>Endpoint: <code>https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-001:predict</code></p> <p>Request Format: <pre><code>{\n  \"instances\": [{\n    \"prompt\": \"A cute cat playing with a ball\"\n  }],\n  \"parameters\": {\n    \"sampleCount\": 1,\n    \"aspectRatio\": \"1:1\"\n  }\n}\n</code></pre></p> <p>Response Format: <pre><code>{\n  \"predictions\": [{\n    \"bytesBase64Encoded\": true,\n    \"mimeType\": \"image/png\",\n    \"data\": \"iVBORw0KGgoAAAANSUhEUgAA...\"\n  }]\n}\n</code></pre></p>"},{"location":"archive/architecture/#google-veo-api-planned","title":"Google Veo API (Planned)","text":"<p>Endpoint: <code>https://generativelanguage.googleapis.com/v1beta/models/veo-3.1-generate-preview:predictLongRunning</code></p> <p>Request Format: <pre><code>{\n  \"instances\": [{\n    \"prompt\": \"A cinematic shot of a lion in the savannah\"\n  }],\n  \"parameters\": {\n    \"aspectRatio\": \"16:9\",\n    \"resolution\": \"720p\",\n    \"durationSeconds\": \"8\"\n  }\n}\n</code></pre></p> <p>Initial Response: <pre><code>{\n  \"name\": \"operations/veo-3.1-generate-preview/123456789\",\n  \"done\": false\n}\n</code></pre></p> <p>Final Response (after polling): <pre><code>{\n  \"name\": \"operations/...\",\n  \"done\": true,\n  \"response\": {\n    \"generateVideoResponse\": {\n      \"generatedSamples\": [{\n        \"video\": {\n          \"uri\": \"https://generativelanguage.googleapis.com/v1beta/...\"\n        }\n      }]\n    }\n  }\n}\n</code></pre></p>"},{"location":"archive/architecture/#file-system-structure","title":"\ud83d\udcc1 File System Structure","text":""},{"location":"archive/architecture/#project-structure","title":"Project Structure","text":"<pre><code>claude-code-image-generator/\n\u251c\u2500\u2500 image_gen.py                 # Image generation client (working)\n\u251c\u2500\u2500 video_gen.py                 # Video generation client (planned)\n\u251c\u2500\u2500 design.md                    # Design document with roadmaps\n\u251c\u2500\u2500 architecture.md              # This file - system architecture\n\u251c\u2500\u2500 README.md                    # Project overview\n\u251c\u2500\u2500 issue/                       # GitHub issues\n\u2502   \u2514\u2500\u2500 veo-video-generation-support.md\n\u251c\u2500\u2500 generated_images/            # Output directory\n\u2502   \u251c\u2500\u2500 image_YYYYMMDD_HHMMSS_0.png\n\u2502   \u2514\u2500\u2500 metadata_YYYYMMDD_HHMMSS.json\n\u2514\u2500\u2500 generated_videos/            # Output directory (planned)\n    \u2514\u2500\u2500 video_YYYYMMDD_HHMMSS.mp4\n</code></pre>"},{"location":"archive/architecture/#ccs-directory-structure","title":"CCS Directory Structure","text":"<pre><code>~/.ccs/\n\u251c\u2500\u2500 config.yaml                  # Main CCS configuration\n\u251c\u2500\u2500 gemini.settings.json         # Gemini profile settings\n\u2514\u2500\u2500 cliproxy/\n    \u2514\u2500\u2500 auth/\n        \u251c\u2500\u2500 gemini-user@gmail.com-all.json\n        \u251c\u2500\u2500 antigravity-user@gmail.com.json\n        \u2514\u2500\u2500 kiro-aws-user@gmail.com.json\n</code></pre>"},{"location":"archive/architecture/#key-architecture-decisions","title":"\ud83d\udd11 Key Architecture Decisions","text":""},{"location":"archive/architecture/#1-cliproxyapi-as-main-handler","title":"1. CLIProxyAPI as Main Handler","text":"<p>Decision: All requests flow through CLIProxyAPI Rationale: Centralized authentication, format translation, and routing Impact: Simplifies client code, consistent interface</p>"},{"location":"archive/architecture/#2-ccs-as-token-provider-only","title":"2. CCS as Token Provider Only","text":"<p>Decision: CCS not in request load path Rationale: Separation of concerns, CCS focuses on token management Impact: Cleaner architecture, CCS can be updated independently</p>"},{"location":"archive/architecture/#3-synchronous-image-asynchronous-video","title":"3. Synchronous Image, Asynchronous Video","text":"<p>Decision: Different processing models for image vs video Rationale: Image generation is fast (&lt;30s), video takes longer (1-5min) Impact: Different client handling patterns, better user experience</p>"},{"location":"archive/architecture/#4-oauth-authentication","title":"4. OAuth Authentication","text":"<p>Decision: Use OAuth 2.0 with CCS token management Rationale: No hardcoded API keys, auto-refresh, multi-provider support Impact: Secure, scalable, provider-agnostic</p>"},{"location":"archive/architecture/#performance-considerations","title":"\ud83d\udcca Performance Considerations","text":""},{"location":"archive/architecture/#image-generation","title":"Image Generation","text":"Metric Expected Value Notes Generation Time 5-30 seconds Depends on model and size Output Size 100KB - 2MB Base64 encoded Success Rate ~95% With proper error handling Rate Limits As configured in CCS Provider-dependent"},{"location":"archive/architecture/#video-generation-expected","title":"Video Generation (Expected)","text":"Metric Expected Value Notes Generation Time 1-5 minutes Async polling required Output Size 5-20MB Base64 encoded Success Rate ~90% More complex than images Polling Interval 10 seconds Optimal balance"},{"location":"archive/architecture/#security-architecture","title":"\ud83d\udd12 Security Architecture","text":""},{"location":"archive/architecture/#oauth-token-security","title":"OAuth Token Security","text":"<p>Storage: - Location: <code>~/.ccs/cliproxy/auth/</code> - Format: Encrypted JSON - Permissions: User-readable only</p> <p>Token Lifecycle: - Lifetime: ~1 hour (3600 seconds) - Auto-refresh: Handled by CCS - Rotation: Automatic on expiry</p> <p>Best Practices: - Never log OAuth tokens - Never commit tokens to version control - Use <code>.gitignore</code> for auth files - Monitor usage to avoid quota exhaustion</p>"},{"location":"archive/architecture/#summary","title":"\u2705 Summary","text":"<p>Architecture Principles:</p> <ol> <li>CLIProxyAPI - Main request handler and format translator</li> <li>CCS - Token provider and profile manager (not in request path)</li> <li>OAuth - Secure authentication with auto-refresh</li> <li>Consistency - Same interface for image and video</li> <li>Separation - Clear boundaries between components</li> </ol> <p>Request Flow: <pre><code>Client \u2192 CLIProxyAPI \u2192 Google API\n          \u2191\n    CCS (token only)\n</code></pre></p> <p>Key Points: - Request load does NOT pass through CCS - CCS provides OAuth tokens only - CLIProxyAPI handles all translation and routing - Image generation is synchronous - Video generation requires async polling</p> <p>Document Status: \u2705 Active Last Reviewed: 2026-01-14 Next Review: After MCP Tool implementation</p>"},{"location":"archive/request-flow/","title":"\ud83d\udd04 Request Load Flow: \u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07\u0e41\u0e25\u0e49\u0e27!","text":""},{"location":"archive/request-flow/#_1","title":"\ud83c\udfaf \u0e2b\u0e25\u0e31\u0e01\u0e01\u0e32\u0e23\u0e2a\u0e33\u0e04\u0e31\u0e0d","text":"<p>Request Load = Client \u2192 CLIProxyAPI (Direct) CCS = \u0e40\u0e09\u0e1e\u0e32\u0e30\u0e15\u0e2d\u0e19\u0e14\u0e36\u0e07 OAuth Token \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19</p>"},{"location":"archive/request-flow/#flow-request-path","title":"\ud83d\udcca Flow \u0e17\u0e35\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07 (Request Path)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  1. Client (image_gen.py)                                  \u2502\n\u2502     python3 image_gen.py \"prompt\"                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502 HTTP POST http://127.0.0.1:8317/v1/chat/completions\n                 \u2502 Headers: Authorization: Bearer ccs-internal-managed\n                 \u2502 Body: {model, messages, modalities, image_config}\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  2. CLIProxyAPI (Main Request Handler) \u2705                    \u2502\n\u2502     localhost:8317                                          \u2502\n\u2502                                                             \u2502\n\u2502  - \u0e23\u0e31\u0e1a request \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07\u0e08\u0e32\u0e01 client                          \u2502\n\u2502  - \u0e41\u0e1b\u0e25\u0e07 format (OpenRouter \u2192 Google Imagen)              \u2502\n\u2502  - Manage authentication                                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502 CLIProxyAPI \u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23 OAuth token\n                 \u2502 \u0e40\u0e2b\u0e47\u0e19 \"ccs-internal-managed\"\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  3. CCS Token Query (\u0e40\u0e09\u0e1e\u0e32\u0e30\u0e15\u0e2d\u0e19\u0e14\u0e36\u0e07 token \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19) \ud83d\udd11        \u2502\n\u2502     CLIProxyAPI \u2190\u2192 CCS (internal)                          \u2502\n\u2502     Location: ~/.ccs/cliproxy/auth/gemini-*.json          \u2502\n\u2502                                                             \u2502\n\u2502  - CCS \u0e2a\u0e48\u0e07 OAuth token \u0e43\u0e2b\u0e49 CLIProxyAPI                     \u2502\n\u2502  - CCS \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a request load \u0e08\u0e32\u0e01 client                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502 CLIProxyAPI \u0e44\u0e14\u0e49 OAuth token \u0e41\u0e25\u0e49\u0e27\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  4. CLIProxyAPI \u2192 Google Imagen API \ud83c\udf10                     \u2502\n\u2502     POST https://generativelanguage.googleapis.com/...     \u2502\n\u2502     Headers: Authorization: Bearer ya29.a0Aa...            \u2502\n\u2502     Body: {instances, parameters}                          \u2502\n\u2502                                                             \u2502\n\u2502  - CLIProxyAPI \u0e2a\u0e48\u0e07 request \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07\u0e44\u0e1b Google               \u2502\n\u2502  - \u0e44\u0e21\u0e48\u0e1c\u0e48\u0e32\u0e19 CCS \u0e43\u0e19\u0e02\u0e31\u0e49\u0e19\u0e15\u0e2d\u0e19\u0e19\u0e35\u0e49                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2502 Google \u0e2a\u0e48\u0e07 image \u0e01\u0e25\u0e31\u0e1a\u0e21\u0e32\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  5. CLIProxyAPI (Response Processing)                      \u2502\n\u2502     - \u0e41\u0e1b\u0e25\u0e07 format \u0e01\u0e25\u0e31\u0e1a (Google \u2192 OpenRouter)            \u2502\n\u2502     - \u0e2a\u0e48\u0e07 response \u0e01\u0e25\u0e31\u0e1a\u0e44\u0e1b client                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  6. Client (image_gen.py)                                  \u2502\n\u2502     - \u0e23\u0e31\u0e1a base64 image data                               \u2502\n\u2502     - \u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01\u0e40\u0e1b\u0e47\u0e19 PNG file                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"archive/request-flow/#_2","title":"\ud83c\udfaf \u0e2a\u0e23\u0e38\u0e1b\u0e04\u0e27\u0e32\u0e21\u0e2a\u0e33\u0e04\u0e31\u0e0d","text":"\u0e02\u0e31\u0e49\u0e19\u0e15\u0e2d\u0e19 Request \u0e1c\u0e48\u0e32\u0e19\u0e43\u0e04\u0e23 \u0e15\u0e31\u0e27\u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e2b\u0e25\u0e31\u0e01 1. Client \u2192 CLIProxyAPI \u2705 \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07 CLIProxyAPI 2. CLIProxyAPI \u2192 CCS \u274c Internal query \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19 CCS (\u0e40\u0e09\u0e1e\u0e32\u0e30 token) 3. CLIProxyAPI \u2192 Google \u2705 \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07 CLIProxyAPI 4. Google \u2192 CLIProxyAPI \u2705 \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07 CLIProxyAPI 5. CLIProxyAPI \u2192 Client \u2705 \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07 CLIProxyAPI"},{"location":"archive/request-flow/#_3","title":"\ud83d\udd11 \u0e08\u0e38\u0e14\u0e2a\u0e33\u0e04\u0e31\u0e0d\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e40\u0e02\u0e49\u0e32\u0e43\u0e08","text":""},{"location":"archive/request-flow/#1-request-load-cliproxyapi","title":"1. Request Load = CLIProxyAPI","text":"<pre><code>Client Request \u2192 CLIProxyAPI (Direct)\n                    \u2193\n              CLIProxyAPI \u0e08\u0e31\u0e14\u0e01\u0e32\u0e23\u0e17\u0e38\u0e01\u0e2d\u0e22\u0e48\u0e32\u0e07\n                    \u2193\n              CLIProxyAPI Response \u2192 Client (Direct)\n</code></pre>"},{"location":"archive/request-flow/#2-ccs-token-provider-only","title":"2. CCS = Token Provider Only","text":"<pre><code>CLIProxyAPI \u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23 token\n         \u2193\n    Query CCS (Internal)\n         \u2193\nCCS \u0e2a\u0e48\u0e07 OAuth token \u0e01\u0e25\u0e31\u0e1a\u0e21\u0e32\n</code></pre>"},{"location":"archive/request-flow/#3-ccs-request-load","title":"3. CCS \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a Request Load","text":"<ul> <li>\u274c CCS \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e23\u0e31\u0e1a request \u0e08\u0e32\u0e01 client \u0e42\u0e14\u0e22\u0e15\u0e23\u0e07</li> <li>\u274c CCS \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49 process request</li> <li>\u274c CCS \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49 translate format</li> <li>\u2705 CCS \u0e08\u0e31\u0e14\u0e01\u0e32\u0e23 OAuth tokens \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19</li> </ul>"},{"location":"archive/request-flow/#_4","title":"\ud83d\udcd0 \u0e2a\u0e16\u0e32\u0e1b\u0e31\u0e15\u0e22\u0e01\u0e23\u0e23\u0e21\u0e17\u0e35\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  image_gen.py    \u2502\n\u2502   (Client)       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502 Request with \"ccs-internal-managed\"\n         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    CLIProxyAPI (Main Handler)        \u2502\n\u2502                                      \u2502\n\u2502  1. Receive request                  \u2502\n\u2502  2. Translate format                  \u2502\n\u2502  3. Query CCS for token \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  4. Call Google API               \u2502   \u2502\n\u2502  5. Translate response             \u2502   \u2502\n\u2502  6. Return to client               \u2502   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2518\n                                   \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502                             \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502   CCS (Extension)     \u2502        \u2502  Google Imagen   \u2502\n         \u2502                        \u2502        \u2502      API         \u2502\n         \u2502  - Token Storage      \u2502        \u2502                  \u2502\n         \u2502  - Auto-refresh       \u2502        \u2502  - Generate      \u2502\n         \u2502  - OAuth management   \u2502        \u2502    image         \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"archive/request-flow/#final","title":"\u2705 \u0e04\u0e27\u0e32\u0e21\u0e40\u0e02\u0e49\u0e32\u0e43\u0e08\u0e17\u0e35\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07 (Final)","text":"<ol> <li>CLIProxyAPI = Main Request Handler + Format Translator</li> <li>CCS = Token Provider Only (\u0e40\u0e09\u0e1e\u0e32\u0e30\u0e15\u0e2d\u0e19\u0e14\u0e36\u0e07 OAuth token)</li> <li>Request Load = Client \u2192 CLIProxyAPI \u2192 Google API (\u0e44\u0e21\u0e48\u0e1c\u0e48\u0e32\u0e19 CCS)</li> <li>CCS Role = Internal token query \u0e42\u0e14\u0e22 CLIProxyAPI \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19</li> </ol>"},{"location":"archive/request-flow/#flow","title":"\ud83d\ude80 Flow \u0e2a\u0e31\u0e49\u0e19\u0e46 \u0e17\u0e35\u0e48\u0e08\u0e33","text":"<pre><code>User \u2192 image_gen.py \u2192 CLIProxyAPI \u2192 Google API\n                         \u2191\n                         \u2514\u2192 CCS (\u0e40\u0e09\u0e1e\u0e32\u0e30\u0e15\u0e2d\u0e19\u0e14\u0e36\u0e07 token)\n</code></pre> <p>\u0e04\u0e33\u0e2a\u0e33\u0e04\u0e31\u0e0d: Request \u0e44\u0e21\u0e48\u0e1c\u0e48\u0e32\u0e19 CCS \u0e41\u0e15\u0e48 CLIProxyAPI \u0e14\u0e36\u0e07 token \u0e08\u0e32\u0e01 CCS \u0e40\u0e2d\u0e07\u0e04\u0e23\u0e31\u0e1a! \ud83c\udfaf</p>"},{"location":"archive/workflow/","title":"Workflow: Image Generation via Claude Code CLI + CLIProxyAPI + Gemini","text":""},{"location":"archive/workflow/#complete-architecture-flow","title":"Complete Architecture Flow","text":"<pre><code>User Terminal\n  \u2193\n  python image_gen.py \"prompt\" --model gemini-3-pro-image-preview\n  \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  image_gen.py (Python Script)                            \u2502\n\u2502  - Parse CLI arguments                                   \u2502\n\u2502  - Build OpenRouter-compatible payload                   \u2502\n\u2502  - Send POST request to CLIProxyAPI                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n  \u2193\n  HTTP POST to http://127.0.0.1:8317/v1/chat/completions\n  Headers: Authorization: Bearer ccs-internal-managed\n  \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CLIProxyAPI (localhost:8317)                           \u2502\n\u2502  - OAuth Proxy Server                                   \u2502\n\u2502  - Manages authentication tokens                         \u2502\n\u2502  - Routes to Gemini/AntiGravity providers              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n  \u2193\n  Retrieves OAuth access token from ~/.ccs/cliproxy/auth/\n  \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CCS (Claude Code Switch)                                \u2502\n\u2502  - Profile manager                                       \u2502\n\u2502  - Internal token management                            \u2502\n\u2502  - Auto-refresh OAuth tokens                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n  \u2193\n  Uses stored OAuth tokens (Google/Gemini/AntiGravity)\n  \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Gemini Image Generation API                             \u2502\n\u2502  Model: gemini-3-pro-image-preview                      \u2502\n\u2502  OR: gemini-2.5-flash-image                             \u2502\n\u2502                                                          \u2502\n\u2502  Request Format (OpenRouter):                           \u2502\n\u2502  {                                                       \u2502\n\u2502    \"model\": \"gemini-3-pro-image-preview\",              \u2502\n\u2502    \"messages\": [{\"role\": \"user\", \"content\": \"prompt\"}], \u2502\n\u2502    \"modalities\": [\"image\", \"text\"],                      \u2502\n\u2502    \"image_config\": {                                     \u2502\n\u2502      \"aspect_ratio\": \"1:1\",                             \u2502\n\u2502      \"image_size\": \"1K\"                                 \u2502\n\u2502    }                                                     \u2502\n\u2502  }                                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n  \u2193\n  Google Imagen API processes request\n  \u2193\n  Generate image using Imagen 3/4 model\n  \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Response Format (OpenRouter-compatible):               \u2502\n\u2502  {                                                       \u2502\n\u2502    \"choices\": [{                                        \u2502\n\u2502      \"message\": {                                       \u2502\n\u2502        \"images\": [{                                     \u2502\n\u2502          \"image_url\": {                                 \u2502\n\u2502            \"url\": \"data:image/png;base64,...\"           \u2502\n\u2502          }                                               \u2502\n\u2502        }]                                                \u2502\n\u2502      }                                                   \u2502\n\u2502    }]                                                    \u2502\n\u2502  }                                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n  \u2193\n  CLIProxyAPI returns response with base64 image data\n  \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  image_gen.py Processing                                \u2502\n\u2502  - Parse JSON response                                  \u2502\n\u2502  - Extract base64 image data                            \u2502\n\u2502  - Decode base64 to binary                              \u2502\n\u2502  - Save as PNG file                                     \u2502\n\u2502  - Save metadata with prompt                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n  \u2193\n  Output: ./generated_images/\n    - image_YYYYMMDD_HHMMSS_0.png\n    - metadata_YYYYMMDD_HHMMSS.json (includes prompt)\n</code></pre>"},{"location":"archive/workflow/#component-interactions","title":"Component Interactions","text":""},{"location":"archive/workflow/#1-user-image_genpy","title":"1. User \u2192 image_gen.py","text":"<pre><code>Input:\n  - Prompt (text description)\n  - Model selection (gemini-3-pro-image-preview or gemini-2.5-flash-image)\n  - Aspect ratio (1:1, 3:4, 4:3, 9:16, 16:9)\n  - Image size (1K, 2K, 4K)\n\nOutput:\n  - PNG image file\n  - Metadata JSON with prompt\n</code></pre>"},{"location":"archive/workflow/#2-image_genpy-cliproxyapi","title":"2. image_gen.py \u2192 CLIProxyAPI","text":"<pre><code>Endpoint: http://127.0.0.1:8317/v1/chat/completions\nMethod: POST\nHeaders:\n  - Authorization: Bearer ccs-internal-managed\n  - Content-Type: application/json\n\nBody: OpenRouter-compatible request with modalities and image_config\n</code></pre>"},{"location":"archive/workflow/#3-cliproxyapi-ccs","title":"3. CLIProxyAPI \u2192 CCS","text":"<pre><code>Authentication: ccs-internal-managed\nToken Source: ~/.ccs/cliproxy/auth/gemini-*.json\nToken Type: OAuth 2.0 Bearer token\nProvider: Google (Gemini/AntiGravity)\n</code></pre>"},{"location":"archive/workflow/#4-ccs-gemini-api","title":"4. CCS \u2192 Gemini API","text":"<pre><code>API: Google Imagen API\nEndpoint: https://generativelanguage.googleapis.com/\nAuthentication: OAuth 2.0\nModels:\n  - gemini-3-pro-image-preview (Imagen 3)\n  - gemini-2.5-flash-image (Imagen 2.5 Flash)\n</code></pre>"},{"location":"archive/workflow/#5-gemini-api-cliproxyapi","title":"5. Gemini API \u2192 CLIProxyAPI","text":"<pre><code>Response: OpenRouter-compatible format\nImage Format: Base64-encoded PNG\nMIME Type: data:image/png;base64\n</code></pre>"},{"location":"archive/workflow/#6-cliproxyapi-image_genpy","title":"6. CLIProxyAPI \u2192 image_gen.py","text":"<pre><code>Response Format:\n  {\n    \"choices\": [{\n      \"message\": {\n        \"images\": [{\n          \"image_url\": {\n            \"url\": \"data:image/png;base64,iVBORw0KG...\"\n          }\n        }]\n      }\n    }]\n  }\n</code></pre>"},{"location":"archive/workflow/#data-flow-summary","title":"Data Flow Summary","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 User Command \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502 \"prompt text\"\n       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 image_gen.py     \u2502 \u2192 Build payload\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502 HTTP POST + ccs-internal-managed\n       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 CLIProxyAPI      \u2502 \u2192 Get OAuth token\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502 Bearer token\n       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Gemini Imagen    \u2502 \u2192 Generate image\n\u2502   API            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502 Base64 image\n       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 CLIProxyAPI      \u2502 \u2192 Return response\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502 JSON with base64\n       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 image_gen.py     \u2502 \u2192 Decode &amp; save\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502 PNG file + metadata.json\n       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 File System      \u2502 \u2192 ./generated_images/\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"archive/workflow/#key-configuration-files","title":"Key Configuration Files","text":"File Purpose <code>~/.ccs/config.yaml</code> CCS profile configuration <code>~/.ccs/gemini.settings.json</code> Gemini profile settings <code>~/.ccs/cliproxy/auth/*.json</code> OAuth tokens <code>image_gen.py</code> Main script <code>./generated_images/metadata_*.json</code> Prompt and image metadata"},{"location":"archive/workflow/#authentication-flow","title":"Authentication Flow","text":"<pre><code>1. image_gen.py sends: Authorization: Bearer ccs-internal-managed\n2. CLIProxyAPI receives ccs-internal-managed token\n3. CLIProxyAPI queries CCS for actual OAuth token\n4. CCS retrieves from ~/.ccs/cliproxy/auth/gemini-*.json\n5. CLIProxyAPI uses OAuth token to call Gemini API\n6. Gemini API validates OAuth token\n7. Image generation proceeds\n8. Response returns through same path\n</code></pre>"},{"location":"archive/workflow/#model-options","title":"Model Options","text":"Model Quality Speed Best For <code>gemini-3-pro-image-preview</code> High Slower Detailed artwork <code>gemini-2.5-flash-image</code> Medium Faster Quick iterations"},{"location":"archive/workflow/#configuration-options","title":"Configuration Options","text":""},{"location":"archive/workflow/#aspect-ratios","title":"Aspect Ratios","text":"<ul> <li><code>1:1</code> - Square (default)</li> <li><code>3:4</code> - Portrait</li> <li><code>4:3</code> - Standard</li> <li><code>9:16</code> - Mobile portrait</li> <li><code>16:9</code> - Widescreen</li> </ul>"},{"location":"archive/workflow/#image-sizes","title":"Image Sizes","text":"<ul> <li><code>1K</code> - ~1024px (fastest, default)</li> <li><code>2K</code> - ~2048px (balanced)</li> <li><code>4K</code> - ~4096px (highest quality)</li> </ul>"},{"location":"cli/check_api/","title":"CLI Reference: check_api.py","text":"<p>Complete command-line reference for API verification.</p>"},{"location":"cli/check_api/#synopsis","title":"Synopsis","text":"<pre><code>python check_api.py [OPTIONS]\n</code></pre>"},{"location":"cli/check_api/#description","title":"Description","text":"<p>API Checker verifies API connectivity, lists available models, and checks quota information for both Gemini API and Vertex AI endpoints.</p>"},{"location":"cli/check_api/#options","title":"Options","text":"Option Type Default Description <code>--key</code> string $GOOGLE_API_KEY API key or OAuth token <code>--location</code> string us-central1 Vertex AI region <code>--project-id</code> string - GCP project ID <code>--verbose</code> flag - Show detailed output"},{"location":"cli/check_api/#api-key-detection","title":"API Key Detection","text":"<p>The script auto-detects endpoint based on key format:</p> Prefix Endpoint Authentication <code>AIzaSy...</code> Gemini API API Key works <code>AQ.Ab8R...</code> Vertex AI OAuth2 required! <code>ya29....</code> Both OAuth2 token"},{"location":"cli/check_api/#examples","title":"Examples","text":""},{"location":"cli/check_api/#check-gemini-api","title":"Check Gemini API","text":"<pre><code># Using environment variable\nexport GOOGLE_API_KEY=\"AIzaSy...\"\npython check_api.py\n\n# Using flag\npython check_api.py --key \"AIzaSy...\"\n</code></pre>"},{"location":"cli/check_api/#check-vertex-ai","title":"Check Vertex AI","text":"<pre><code># Get OAuth token first\nTOKEN=$(gcloud auth application-default print-access-token)\n\n# Check with token\npython check_api.py --key \"$TOKEN\" --project-id my-project\n</code></pre>"},{"location":"cli/check_api/#list-models","title":"List Models","text":"<pre><code>python check_api.py --key \"$API_KEY\" --verbose\n</code></pre>"},{"location":"cli/check_api/#output","title":"Output","text":"<pre><code>\ud83d\udd0d API Checker v2.1\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\n\ud83d\udccd Endpoint: Gemini API (generativelanguage.googleapis.com)\n\ud83d\udd11 Key Type: Gemini API Key\n\n\u2705 Connection successful!\n\n\ud83d\udccb Available Models:\n   \u2022 gemini-2.0-flash-exp\n   \u2022 gemini-2.0-flash\n   \u2022 veo-3.1-generate-preview\n   \u2022 veo-3.1-fast-generate-preview\n   \u2022 veo-2.0\n   ...\n</code></pre>"},{"location":"cli/check_api/#endpoint-compatibility","title":"Endpoint Compatibility","text":"Feature Gemini API Vertex AI API Key Auth OAuth2 Auth Service Account List Models  OAuth only Generate Video"},{"location":"cli/check_api/#important-notes","title":"Important Notes","text":""},{"location":"cli/check_api/#vertex-ai-keys-dont-work-for-listing","title":"Vertex AI Keys Don't Work for Listing","text":"<p>Authentication Limitation</p> <p>Vertex AI keys (<code>AQ...</code>) require OAuth for model listing.</p> <pre><code># This will fail for model listing\npython check_api.py --key \"AQ.Ab8R...\"  # Vertex AI key\n# Error: 401 Unauthorized\n\n# Use OAuth token instead\nTOKEN=$(gcloud auth application-default print-access-token)\npython check_api.py --key \"$TOKEN\"\n</code></pre>"},{"location":"cli/check_api/#video-generation-still-works","title":"Video Generation Still Works","text":"<p>Generation vs Listing</p> <p>Even if model listing fails, video generation may still work with Vertex AI keys.</p> <pre><code># Listing fails\npython check_api.py --key \"AQ...\"  # \u274c\n\n# But video generation works!\npython video_gen.py \"prompt\" --key \"AQ...\"  # \u2705\n</code></pre>"},{"location":"cli/check_api/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success - connection verified 1 Error - connection failed"},{"location":"cli/check_api/#see-also","title":"See Also","text":"<ul> <li>Authentication - Authentication methods</li> <li>Quick Start - Getting started</li> </ul>"},{"location":"cli/image_gen/","title":"CLI Reference: image_gen.py","text":"<p>Complete command-line reference for image generation.</p>"},{"location":"cli/image_gen/#synopsis","title":"Synopsis","text":"<pre><code>python image_gen.py PROMPT [OPTIONS]\n</code></pre>"},{"location":"cli/image_gen/#arguments","title":"Arguments","text":""},{"location":"cli/image_gen/#required","title":"Required","text":"Argument Description <code>PROMPT</code> Text description of the image to generate"},{"location":"cli/image_gen/#options","title":"Options","text":""},{"location":"cli/image_gen/#model-output","title":"Model &amp; Output","text":"Option Type Default Description <code>--model</code> string gemini-3-pro-image-preview Model to use <code>--aspect-ratio</code> string 1:1 1:1, 16:9, 9:16, 4:3, 3:4 <code>--image-size</code> string 1K 1K or 2K <code>--output</code> path generated_images/ Output directory"},{"location":"cli/image_gen/#authentication","title":"Authentication","text":"Option Type Default Description <code>--project</code> string default Config project name"},{"location":"cli/image_gen/#context","title":"Context","text":"Option Type Default Description <code>--doc</code> path - Document for context"},{"location":"cli/image_gen/#cost","title":"Cost","text":"Option Type Default Description <code>--estimate-cost</code> flag - Show cost without generating"},{"location":"cli/image_gen/#debug","title":"Debug","text":"Option Type Default Description <code>--show-defaults</code> flag - Show current defaults and exit (v1.4)"},{"location":"cli/image_gen/#examples","title":"Examples","text":""},{"location":"cli/image_gen/#basic","title":"Basic","text":"<pre><code># Simple generation\npython image_gen.py \"A futuristic city at sunset\"\n\n# With aspect ratio\npython image_gen.py \"A cat sitting\" --aspect-ratio 16:9\n\n# High resolution\npython image_gen.py \"Detailed landscape\" --image-size 2K\n</code></pre>"},{"location":"cli/image_gen/#social-media","title":"Social Media","text":"<pre><code># Instagram square\npython image_gen.py \"Coffee art\" --aspect-ratio 1:1\n\n# Instagram story\npython image_gen.py \"Mountains\" --aspect-ratio 9:16\n\n# Twitter header\npython image_gen.py \"Abstract pattern\" --aspect-ratio 16:9\n</code></pre>"},{"location":"cli/image_gen/#with-document-context","title":"With Document Context","text":"<pre><code>python image_gen.py \"System architecture diagram\" --doc README.md\n</code></pre>"},{"location":"cli/image_gen/#cost-estimation","title":"Cost Estimation","text":"<pre><code>python image_gen.py \"Test image\" --estimate-cost\n</code></pre>"},{"location":"cli/image_gen/#aspect-ratio-guide","title":"Aspect Ratio Guide","text":"Ratio Resolution (1K) Best For 1:1 1024x1024 Square images, avatars 16:9 1820x1024 Widescreen, desktop 9:16 1024x1820 Mobile, stories 4:3 1365x1024 Traditional photo 3:4 1024x1365 Portrait"},{"location":"cli/image_gen/#environment-variables","title":"Environment Variables","text":"Variable Description <code>GOOGLE_API_KEY</code> Default API key (for direct API usage)"},{"location":"cli/image_gen/#output","title":"Output","text":"<p>Images are saved with timestamp:</p> <pre><code>generated_images/\n\u2514\u2500\u2500 image_20260123_123456.png\n</code></pre>"},{"location":"cli/image_gen/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 General error 2 Invalid arguments"},{"location":"cli/image_gen/#see-also","title":"See Also","text":"<ul> <li>Image Generation - Image generation guide</li> <li>Authentication - API key setup</li> </ul>"},{"location":"cli/video_gen/","title":"CLI Reference: video_gen.py","text":"<p>Complete command-line reference for video generation.</p>"},{"location":"cli/video_gen/#synopsis","title":"Synopsis","text":"<pre><code>python video_gen.py PROMPT [OPTIONS]\n</code></pre>"},{"location":"cli/video_gen/#arguments","title":"Arguments","text":""},{"location":"cli/video_gen/#required","title":"Required","text":"Argument Description <code>PROMPT</code> Text description of the video to generate"},{"location":"cli/video_gen/#options","title":"Options","text":""},{"location":"cli/video_gen/#model-output","title":"Model &amp; Output","text":"Option Type Default Description <code>--model</code> string veo-3.1-generate-preview Model to use <code>--duration</code> int 5 Video duration (5-8 seconds) <code>--aspect-ratio</code> string 16:9 16:9, 9:16, or 1:1 <code>--output</code> path generated_videos/ Output directory"},{"location":"cli/video_gen/#presets","title":"Presets","text":"Option Type Default Description <code>--preset</code> string - quick, quality, extend, budget"},{"location":"cli/video_gen/#authentication","title":"Authentication","text":"Option Type Default Description <code>--key</code> string $GOOGLE_API_KEY API key or OAuth token <code>--project</code> string default Config project name"},{"location":"cli/video_gen/#images","title":"Images","text":"Option Type Default Description <code>--image</code> path - First frame image <code>--last-frame</code> path - Last frame image <code>--reference-image</code> PATH:TYPE - Reference image (asset/style)"},{"location":"cli/video_gen/#video-extension","title":"Video Extension","text":"Option Type Default Description <code>--extend-video</code> path/URI - Video to extend <code>--storage-uri</code> gs:// - GCS bucket for uploads"},{"location":"cli/video_gen/#mask-operations","title":"Mask Operations","text":"Option Type Default Description <code>--video</code> path - Source video for mask ops <code>--mask</code> path - Mask image <code>--mask-mode</code> string - insert or remove <code>--resize-mode</code> string - Resize mode for mask"},{"location":"cli/video_gen/#remix-mode","title":"Remix Mode","text":"Option Type Default Description <code>--remix</code> path - Source video to remix <code>--remix-last-frame</code> flag - Also extract last frame <code>--remix-start</code> M:SS 0:00 Start time for extraction <code>--remix-end</code> M:SS end End time for extraction"},{"location":"cli/video_gen/#cost-metadata","title":"Cost &amp; Metadata","text":"Option Type Default Description <code>--estimate-cost</code> flag - Show cost without generating <code>--no-metadata</code> flag - Don't save metadata file"},{"location":"cli/video_gen/#debug","title":"Debug","text":"Option Type Default Description <code>--verbose</code> flag - Show detailed output <code>--dry-run</code> flag - Show request without sending <code>--show-defaults</code> flag - Show current defaults and exit (v2.25)"},{"location":"cli/video_gen/#examples","title":"Examples","text":""},{"location":"cli/video_gen/#basic","title":"Basic","text":"<pre><code># Simple text-to-video\npython video_gen.py \"A cat walking in a garden\"\n\n# With options\npython video_gen.py \"A sunset over mountains\" \\\n  --duration 8 \\\n  --aspect-ratio 16:9\n</code></pre>"},{"location":"cli/video_gen/#using-presets","title":"Using Presets","text":"<pre><code># Fast preview\npython video_gen.py \"Quick test\" --preset quick\n\n# Best quality\npython video_gen.py \"Final render\" --preset quality\n\n# Video extension\npython video_gen.py \"Continue scene\" --preset extend --extend-video input.mp4\n</code></pre>"},{"location":"cli/video_gen/#image-to-video","title":"Image-to-Video","text":"<pre><code># Animate an image\npython video_gen.py \"The character starts walking\" --image hero.png\n\n# With first and last frames\npython video_gen.py \"Transition effect\" \\\n  --image start.jpg \\\n  --last-frame end.jpg\n</code></pre>"},{"location":"cli/video_gen/#reference-images","title":"Reference Images","text":"<pre><code># Preserve subject (asset)\npython video_gen.py \"Person waving\" \\\n  --reference-image avatar.png:asset\n\n# Apply style\npython video_gen.py \"Cityscape\" \\\n  --reference-image painting.jpg:style \\\n  --model veo-2.0-exp\n</code></pre>"},{"location":"cli/video_gen/#video-extension_1","title":"Video Extension","text":"<pre><code># Extend with auto-upload\npython video_gen.py \"Continue the action\" \\\n  --extend-video previous.mp4 \\\n  --storage-uri gs://my-bucket/videos \\\n  --model veo-2.0\n</code></pre>"},{"location":"cli/video_gen/#mask-operations_1","title":"Mask Operations","text":"<pre><code># Insert object\npython video_gen.py \"Add a bird\" \\\n  --video scene.mp4 \\\n  --mask bird_area.png \\\n  --mask-mode insert\n\n# Remove object\npython video_gen.py \"Remove watermark\" \\\n  --video scene.mp4 \\\n  --mask watermark.png \\\n  --mask-mode remove\n</code></pre>"},{"location":"cli/video_gen/#remix-mode_1","title":"Remix Mode","text":"<pre><code># Simple remix (first frame only)\npython video_gen.py \"Make the cat run faster\" --remix cat_walking.mp4\n\n# With first and last frames (better control)\npython video_gen.py \"Transform to anime style\" \\\n  --remix video.mp4 \\\n  --remix-last-frame\n\n# Select specific time range\npython video_gen.py \"Add dramatic lighting\" \\\n  --remix long_video.mp4 \\\n  --remix-start 0:10 \\\n  --remix-end 0:18\n\n# Dry run to test frame extraction\npython video_gen.py \"Test\" --remix video.mp4 --remix-last-frame --dry-run\n</code></pre>"},{"location":"cli/video_gen/#environment-variables","title":"Environment Variables","text":"Variable Description <code>GOOGLE_API_KEY</code> Default API key <code>GOOGLE_APPLICATION_CREDENTIALS</code> Service account JSON path"},{"location":"cli/video_gen/#config-file","title":"Config File","text":"<p>Create <code>config.json</code> for multi-project support:</p> <pre><code>{\n  \"main_projects\": {\n    \"default\": {\n      \"api_key\": \"AIzaSy...\",\n      \"gcs_bucket\": \"my-bucket\"\n    }\n  }\n}\n</code></pre> <pre><code>python video_gen.py \"prompt\" --project default\n</code></pre>"},{"location":"cli/video_gen/#smart-defaults-v2251","title":"Smart Defaults (v2.25.1)","text":"<p>When extending a video, settings are automatically inherited from the source video's metadata:</p>"},{"location":"cli/video_gen/#automatic-inheritance","title":"Automatic Inheritance","text":"<pre><code># Original video was created with veo-2.0, 1080p, project-1\npython video_gen.py \"Continue the scene\" --extend-video video_20260201_123456_0.mp4\n\n# Output:\n# \u2139 Found source metadata for inheritance\n# \u2139 Inherited project from source metadata: project-1\n# \u2139 Inherited model from metadata: veo-2.0\n# \u2139 Inherited resolution from metadata: 1080p\n</code></pre> <p>Video Extension Models</p> <p>Video extension is supported by <code>veo-2.0</code>, <code>veo-2.0-exp</code>, and <code>veo-3.1-generate-preview</code>.</p>"},{"location":"cli/video_gen/#priority-chain","title":"Priority Chain","text":"<p>Settings are resolved in this order:</p> <ol> <li>CLI Arguments (highest) - Explicitly specified options</li> <li>Source Metadata - From <code>--extend-video</code> source</li> <li>config.json - Project settings</li> <li>Code Defaults (lowest) - Built-in fallbacks</li> </ol>"},{"location":"cli/video_gen/#inheritable-fields","title":"Inheritable Fields","text":"Field Description <code>model</code> Video generation model <code>resolution</code> Output resolution (720p, 1080p) <code>aspect_ratio</code> 16:9, 9:16, 1:1 <code>storage_uri</code> GCS bucket for uploads <code>location</code> GCP region <code>project_id</code> GCP project ID"},{"location":"cli/video_gen/#override-inheritance","title":"Override Inheritance","text":"<p>You can always override inherited values:</p> <pre><code># Override model from metadata\npython video_gen.py \"Continue\" \\\n  --extend-video video.mp4 \\\n  --model veo-2.0\n</code></pre>"},{"location":"cli/video_gen/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 General error 2 Invalid arguments 3 API error"},{"location":"cli/video_gen/#see-also","title":"See Also","text":"<ul> <li>Video Overview - Video generation guide</li> <li>Generation Modes - All 9 modes explained</li> <li>Presets - Preset configurations</li> </ul>"},{"location":"getting-started/authentication/","title":"Authentication","text":"<p>Claude Code Media Generator supports multiple authentication methods for Google APIs.</p> <p>Using Claude Code Skill?</p> <p>If you have the <code>/generative</code> skill installed, use the built-in setup wizard:</p> <pre><code>/generative config setup\n</code></pre> <p>This will guide you through API configuration step-by-step.</p>"},{"location":"getting-started/authentication/#authentication-methods-overview","title":"Authentication Methods Overview","text":"Method Type Best For Interactive API Key Static Key Quick start, Gemini API No OAuth2 (gcloud) OAuth 2.0 Full Vertex AI access Yes (browser) Service Account OAuth 2.0 JWT Server/automation No"},{"location":"getting-started/authentication/#method-1-api-key-recommended-for-start","title":"Method 1: API Key (Recommended for Start)","text":""},{"location":"getting-started/authentication/#get-your-api-key","title":"Get Your API Key","text":"<ol> <li>Go to Google AI Studio</li> <li>Click Get API Key</li> <li>Create a new key or use existing</li> </ol>"},{"location":"getting-started/authentication/#api-key-types","title":"API Key Types","text":"Prefix Type Works With <code>AIzaSy...</code> Gemini API Key Gemini API endpoint <code>AQ.Ab8R...</code> Vertex AI Key Vertex AI endpoint (limited)"},{"location":"getting-started/authentication/#set-api-key","title":"Set API Key","text":"Environment VariableCommand LineConfig File <pre><code>export GOOGLE_API_KEY=\"AIzaSy...\"\n</code></pre> <pre><code>python video_gen.py \"prompt\" --key \"AIzaSy...\"\n</code></pre> <pre><code>{\n  \"main_projects\": {\n    \"default\": {\n      \"api_key\": \"AIzaSy...\"\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/authentication/#method-2-oauth2-via-gcloud-full-access","title":"Method 2: OAuth2 via gcloud (Full Access)","text":""},{"location":"getting-started/authentication/#setup","title":"Setup","text":"<pre><code># Install gcloud CLI\n# https://cloud.google.com/sdk/docs/install\n\n# Login to Google Cloud\ngcloud auth login\n\n# Set application default credentials\ngcloud auth application-default login\n\n# Get access token (for testing)\ngcloud auth application-default print-access-token\n</code></pre>"},{"location":"getting-started/authentication/#usage","title":"Usage","text":"<pre><code># Get token\nTOKEN=$(gcloud auth application-default print-access-token)\n\n# Use with video_gen.py\npython video_gen.py \"prompt\" --key \"$TOKEN\"\n</code></pre>"},{"location":"getting-started/authentication/#method-3-service-account-automation","title":"Method 3: Service Account (Automation)","text":""},{"location":"getting-started/authentication/#create-service-account","title":"Create Service Account","text":"<ol> <li>Go to Google Cloud Console</li> <li>Navigate to IAM &amp; Admin \u2192 Service Accounts</li> <li>Click Create Service Account</li> <li>Grant roles: <code>Vertex AI User</code>, <code>Storage Object Admin</code></li> <li>Download JSON key file</li> </ol>"},{"location":"getting-started/authentication/#usage_1","title":"Usage","text":"<pre><code># Set credentials path\nexport GOOGLE_APPLICATION_CREDENTIALS=\"/path/to/key.json\"\n\n# video_gen.py will auto-detect\npython video_gen.py \"prompt\"\n</code></pre>"},{"location":"getting-started/authentication/#endpoint-compatibility-matrix","title":"Endpoint Compatibility Matrix","text":"Auth Method Gemini API Vertex AI API Key (<code>AIzaSy...</code>) Vertex AI Key (<code>AQ...</code>)  Limited OAuth2 Token Service Account"},{"location":"getting-started/authentication/#config-file-multi-project","title":"Config File (Multi-Project)","text":"<pre><code>{\n  \"main_projects\": {\n    \"default\": {\n      \"api_key\": \"AIzaSy...\",\n      \"gcs_bucket\": \"my-bucket\",\n      \"project_id\": \"my-project\"\n    },\n    \"work\": {\n      \"api_key\": \"AIzaSy...\",\n      \"gcs_bucket\": \"work-bucket\"\n    }\n  }\n}\n</code></pre> <pre><code># Use specific project\npython video_gen.py \"prompt\" --project work\n</code></pre>"},{"location":"getting-started/authentication/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/authentication/#invalid-api-key","title":"\"Invalid API key\"","text":"<ul> <li>Check key prefix: <code>AIzaSy...</code> for Gemini API</li> <li>Ensure key is not expired or revoked</li> </ul>"},{"location":"getting-started/authentication/#permission-denied","title":"\"Permission denied\"","text":"<ul> <li>Enable Vertex AI API in Cloud Console</li> <li>Check billing is enabled</li> </ul>"},{"location":"getting-started/authentication/#token-expired","title":"\"Token expired\"","text":"<ul> <li>Re-run <code>gcloud auth application-default login</code></li> </ul>"},{"location":"getting-started/authentication/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start - Generate your first video</li> <li>GCS Storage - Set up cloud storage</li> <li>Using Skills - Use the <code>/generative</code> skill</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#system-requirements","title":"System Requirements","text":"<ul> <li>Python 3.8+</li> <li>pip package manager</li> <li>Google Account with billing enabled (for video generation)</li> <li>Claude Code (recommended for skill usage)</li> </ul>"},{"location":"getting-started/installation/#choose-your-installation-method","title":"Choose Your Installation Method","text":"Skill (Recommended) Script (Advanced) <p>The easiest way to use this project - install the <code>/generative</code> skill for Claude Code.</p> <p>For automation, CI/CD, or use without Claude Code.</p>"},{"location":"getting-started/installation/#step-1-clone-repository","title":"Step 1: Clone Repository","text":"<pre><code>git clone https://github.com/DarKWinGTM/claude-code-media-generator.git\ncd claude-code-media-generator\n</code></pre>"},{"location":"getting-started/installation/#step-2-install-dependencies","title":"Step 2: Install Dependencies","text":"<pre><code>pip install requests google-auth google-auth-oauthlib\n</code></pre>"},{"location":"getting-started/installation/#step-3-install-skill","title":"Step 3: Install Skill","text":"<pre><code># Create skill directory\nmkdir -p ~/.claude/skills/generative\n\n# Copy skill file\ncp .claude/skills/generative/SKILL.md ~/.claude/skills/generative/\n\n# Copy scripts to your working directory\ncp video_gen.py image_gen.py config.py video_utils.py /path/to/your/project/\n</code></pre>"},{"location":"getting-started/installation/#step-4-restart-claude-code","title":"Step 4: Restart Claude Code","text":"<p>Restart Claude Code to detect the new skill.</p>"},{"location":"getting-started/installation/#step-5-verify","title":"Step 5: Verify","text":"<pre><code>/generative info\n</code></pre> <p> Skill Configuration</p>"},{"location":"getting-started/installation/#step-1-clone-repository_1","title":"Step 1: Clone Repository","text":"<pre><code>git clone https://github.com/DarKWinGTM/claude-code-media-generator.git\ncd claude-code-media-generator\n</code></pre>"},{"location":"getting-started/installation/#step-2-install-dependencies_1","title":"Step 2: Install Dependencies","text":"<pre><code># Core dependencies\npip install requests google-auth google-auth-oauthlib\n\n# For GCS uploads (optional)\npip install google-cloud-storage\n</code></pre>"},{"location":"getting-started/installation/#step-3-verify","title":"Step 3: Verify","text":"<pre><code># Check Python version\npython3 --version\n\n# Test video_gen.py help\npython video_gen.py --help\n</code></pre> <p> Advanced Usage</p>"},{"location":"getting-started/installation/#file-structure","title":"File Structure","text":"<pre><code>claude-code-media-generator/\n\u251c\u2500\u2500 video_gen.py        # Video generation CLI\n\u251c\u2500\u2500 image_gen.py        # Image generation CLI\n\u251c\u2500\u2500 check_api.py        # API verification tool\n\u251c\u2500\u2500 config.py           # Configuration module\n\u251c\u2500\u2500 video_utils.py      # Video utilities\n\u251c\u2500\u2500 config.json         # Your configuration\n\u251c\u2500\u2500 .claude/\n\u2502   \u2514\u2500\u2500 skills/\n\u2502       \u2514\u2500\u2500 generative/\n\u2502           \u2514\u2500\u2500 SKILL.md  # Skill definition (1,500+ lines)\n\u251c\u2500\u2500 generated_videos/   # Output directory\n\u2514\u2500\u2500 generated_images/   # Output directory\n</code></pre>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Authentication - Set up your API key</li> <li>Quick Start - Generate your first video</li> <li>Using Skills - Learn about the <code>/generative</code> skill</li> <li>Agent - Auto-detect media creation intent (recommended)</li> </ul>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":"<p>Generate your first video and image in minutes.</p>"},{"location":"getting-started/quick-start/#prerequisites","title":"Prerequisites","text":"<ul> <li> Python 3.8+ installed</li> <li> Dependencies installed (<code>pip install requests google-auth</code>)</li> <li> API key obtained (see Authentication)</li> </ul>"},{"location":"getting-started/quick-start/#choose-your-method","title":"Choose Your Method","text":"Using Skill (Recommended) Using Script (Advanced) <p>The easiest way to generate media - just type and go!</p> <p>For automation or when not using Claude Code.</p>"},{"location":"getting-started/quick-start/#generate-an-image","title":"Generate an Image","text":"<pre><code>/generative image \"A beautiful sunset over mountains\"\n</code></pre> <p>Output: <pre><code>\ud83d\uddbc\ufe0f Generating image...\n\u2705 Image saved: generated_images/image_20260123_123456.png\n</code></pre></p>"},{"location":"getting-started/quick-start/#generate-a-video","title":"Generate a Video","text":"<pre><code>/generative video \"Ocean waves crashing on the beach\"\n</code></pre> <p>Output: <pre><code>\ud83c\udfac Generating video...\n\u2705 Video saved: generated_videos/video_20260123_123456.mp4\n</code></pre></p>"},{"location":"getting-started/quick-start/#with-options","title":"With Options","text":"<pre><code># Higher quality video\n/generative video \"A cat walking in a garden\" --preset quality\n\n# Different aspect ratio\n/generative image \"Portrait of a robot\" --aspect-ratio 9:16\n</code></pre> <p> More Skill Examples</p>"},{"location":"getting-started/quick-start/#generate-an-image_1","title":"Generate an Image","text":"<pre><code># Set API key\nexport GOOGLE_API_KEY=\"AIzaSy...\"\n\n# Generate image\npython image_gen.py \"A futuristic city at sunset\"\n</code></pre> <p>Output: <pre><code>\ud83d\uddbc\ufe0f Image Generation via Gemini\nModel: gemini-3-pro-image-preview\n...\n\u2705 Image saved: generated_images/image_20260123_123456.png\n</code></pre></p>"},{"location":"getting-started/quick-start/#generate-a-video_1","title":"Generate a Video","text":"<pre><code># Generate video\npython video_gen.py \"A cat walking in a garden\"\n</code></pre> <p>Output: <pre><code>\ud83c\udfac Video Generation via Veo API\nMode: text_to_video\nModel: veo-3.1-generate-preview\n...\n\u2705 Video saved: generated_videos/video_20260123_123456.mp4\n</code></pre></p>"},{"location":"getting-started/quick-start/#with-options_1","title":"With Options","text":"<pre><code># Higher quality, longer duration\npython video_gen.py \"A cat walking in a garden\" \\\n  --model veo-3.1-generate-preview \\\n  --duration 8 \\\n  --aspect-ratio 16:9\n\n# Use preset\npython video_gen.py \"A cat walking\" --preset quality\n</code></pre> <p> Advanced Usage</p>"},{"location":"getting-started/quick-start/#cost-estimation","title":"Cost Estimation","text":"<p>Before generating, check the cost:</p>  Skill Script <pre><code>/generative video \"prompt\" --estimate-cost\n</code></pre> <pre><code>python video_gen.py \"prompt\" --estimate-cost\n</code></pre>"},{"location":"getting-started/quick-start/#using-presets","title":"Using Presets","text":"<p>Presets provide optimized settings for different use cases:</p> Preset Use Case Model Duration <code>quick</code> Fast preview veo-3.1-fast 5s <code>quality</code> Best quality veo-3.1-generate 8s <code>extend</code> Video extension veo-2.0 8s <code>budget</code> Cost saving veo-2.0 5s  Skill Script <pre><code>/generative video \"A cat walking\" --preset quality\n</code></pre> <pre><code>python video_gen.py \"A cat walking\" --preset quality\n</code></pre>"},{"location":"getting-started/quick-start/#common-first-issues","title":"Common First Issues","text":""},{"location":"getting-started/quick-start/#billing-not-enabled","title":"\"Billing not enabled\"","text":"<ul> <li>Video generation requires billing</li> <li>Free tier only for images (Gemini 2.0 Flash)</li> </ul>"},{"location":"getting-started/quick-start/#model-not-found","title":"\"Model not found\"","text":"<ul> <li>Check model name spelling</li> <li>Use <code>/generative info</code> or <code>python check_api.py</code> to list available models</li> </ul>"},{"location":"getting-started/quick-start/#rate-limit-exceeded","title":"\"Rate limit exceeded\"","text":"<ul> <li>Wait a few seconds and retry</li> <li>Consider using <code>--preset budget</code></li> </ul>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":"<ul> <li>Using Skills - Master the <code>/generative</code> skill</li> <li>Generation Modes - Explore all 8 video modes</li> <li>Video Models - Compare Veo 2.0 vs 3.1</li> <li>Presets - Learn about presets</li> <li>GCS Storage - Set up cloud storage</li> </ul>"},{"location":"guides/gcs-storage/","title":"GCS Storage Guide","text":"<p>Google Cloud Storage integration for video generation.</p>"},{"location":"guides/gcs-storage/#why-use-gcs","title":"Why Use GCS?","text":"Benefit Description Video Extension Required for extending videos reliably Larger Files No base64 size limits Faster Processing Direct GCS-to-API transfer Persistent Storage Keep generated videos in cloud"},{"location":"guides/gcs-storage/#setup","title":"Setup","text":""},{"location":"guides/gcs-storage/#1-create-a-gcs-bucket","title":"1. Create a GCS Bucket","text":"<pre><code># Install gcloud CLI if needed\n# https://cloud.google.com/sdk/docs/install\n\n# Create bucket\ngsutil mb gs://your-bucket-name\n\n# Set location (optional)\ngsutil mb -l us-central1 gs://your-bucket-name\n</code></pre>"},{"location":"guides/gcs-storage/#2-set-permissions","title":"2. Set Permissions","text":"<p>For Vertex AI to access your bucket:</p> <pre><code># Grant access to Vertex AI service account\ngsutil iam ch serviceAccount:service-PROJECT_NUMBER@gcp-sa-aiplatform.iam.gserviceaccount.com:objectViewer gs://your-bucket-name\n</code></pre>"},{"location":"guides/gcs-storage/#usage","title":"Usage","text":""},{"location":"guides/gcs-storage/#with-video_genpy","title":"With video_gen.py","text":"<pre><code># Generate video and store in GCS\npython video_gen.py \"A sunset\" --storage-uri gs://your-bucket/videos\n\n# Extend video (auto-uploads local file to GCS)\npython video_gen.py \"Continue scene\" \\\n  --extend-video local_video.mp4 \\\n  --storage-uri gs://your-bucket/videos\n</code></pre>"},{"location":"guides/gcs-storage/#with-config-file","title":"With Config File","text":"<p>Add to <code>config.json</code>:</p> <pre><code>{\n  \"main_projects\": {\n    \"default\": {\n      \"api_key\": \"AIzaSy...\",\n      \"gcs_bucket\": \"gs://your-bucket/videos\"\n    }\n  }\n}\n</code></pre> <p>Then use automatically:</p> <pre><code>python video_gen.py \"A sunset\"  # Uses config GCS bucket\n</code></pre>"},{"location":"guides/gcs-storage/#storage-uri-format","title":"Storage URI Format","text":"<pre><code>gs://BUCKET_NAME/PATH/\n\nExamples:\ngs://my-videos/\ngs://my-videos/generated/\ngs://my-project-bucket/ai-videos/2026/\n</code></pre>"},{"location":"guides/gcs-storage/#auto-upload-feature","title":"Auto-Upload Feature","text":"<p>When you provide <code>--storage-uri</code>:</p> <ol> <li>Local files are uploaded to GCS before API call</li> <li>Generated videos are stored in GCS</li> <li>Videos are also downloaded locally</li> </ol> <pre><code>Local file \u2192 Upload to GCS \u2192 API uses gcsUri \u2192 Generated in GCS \u2192 Download local\n</code></pre>"},{"location":"guides/gcs-storage/#checking-your-bucket","title":"Checking Your Bucket","text":"<pre><code># List contents\ngsutil ls gs://your-bucket/\n\n# Check file details\ngsutil ls -l gs://your-bucket/video.mp4\n\n# Download file\ngsutil cp gs://your-bucket/video.mp4 ./local_copy.mp4\n</code></pre>"},{"location":"guides/gcs-storage/#cost-considerations","title":"Cost Considerations","text":"Service Cost Storage ~$0.02/GB/month Upload Free Download ~$0.12/GB Operations Minimal <p>Auto-Delete Old Files</p> <p>Set up lifecycle rules to auto-delete old files</p> <pre><code># Create lifecycle rule (delete after 30 days)\ngsutil lifecycle set lifecycle.json gs://your-bucket\n</code></pre>"},{"location":"guides/gcs-storage/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/gcs-storage/#permission-denied","title":"\"Permission denied\"","text":"<pre><code># Check bucket permissions\ngsutil iam get gs://your-bucket\n\n# Add yourself as owner\ngsutil iam ch user:your@email.com:objectAdmin gs://your-bucket\n</code></pre>"},{"location":"guides/gcs-storage/#bucket-not-found","title":"\"Bucket not found\"","text":"<pre><code># Verify bucket exists\ngsutil ls gs://your-bucket\n\n# Create if missing\ngsutil mb gs://your-bucket\n</code></pre>"},{"location":"guides/gcs-storage/#gsutil-not-found","title":"\"gsutil not found\"","text":"<pre><code># Install Google Cloud SDK\ncurl https://sdk.cloud.google.com | bash\n\n# Or use pip\npip install google-cloud-storage\n</code></pre>"},{"location":"guides/gcs-storage/#alternative-rest-api","title":"Alternative: REST API","text":"<p>If gsutil isn't available, the script can use REST API:</p> <pre><code># Handled automatically in video_gen.py\n# Uses google-cloud-storage library\n</code></pre>"},{"location":"guides/gcs-storage/#learn-more","title":"Learn More","text":"<ul> <li>Video Extension - Why GCS is important</li> <li>Authentication - GCS authentication</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"guides/presets/","title":"Presets","text":"<p>Quick configuration presets for common use cases.</p>"},{"location":"guides/presets/#available-presets","title":"Available Presets","text":"Preset Model Duration Use Case <code>quick</code> veo-3.1-fast 5s Fast preview, drafts <code>quality</code> veo-3.1-generate 8s Production, final render <code>extend</code> veo-2.0 8s Video extension <code>budget</code> veo-2.0 5s Cost saving"},{"location":"guides/presets/#usage","title":"Usage","text":"<pre><code>python video_gen.py \"Your prompt\" --preset PRESET_NAME\n</code></pre>"},{"location":"guides/presets/#preset-details","title":"Preset Details","text":""},{"location":"guides/presets/#quick","title":"quick","text":"<p>Purpose: Fast preview and iteration</p> <pre><code>python video_gen.py \"A cat walking\" --preset quick\n</code></pre> Setting Value Model veo-3.1-fast-generate-preview Duration 5 seconds Audio  Yes Speed Fast Cost $$ Medium <p>Best for:</p> <ul> <li>Quick concept validation</li> <li>Drafts and iterations</li> <li>Time-sensitive projects</li> </ul>"},{"location":"guides/presets/#quality","title":"quality","text":"<p>Purpose: Best possible output</p> <pre><code>python video_gen.py \"A cinematic sunset\" --preset quality\n</code></pre> Setting Value Model veo-3.1-generate-preview Duration 8 seconds Audio  Yes Speed Medium Cost $$$ Higher <p>Best for:</p> <ul> <li>Final production videos</li> <li>Portfolio pieces</li> <li>Client deliverables</li> </ul>"},{"location":"guides/presets/#extend","title":"extend","text":"<p>Purpose: Video extension workflow</p> <pre><code>python video_gen.py \"Continue the scene\" \\\n  --preset extend \\\n  --extend-video previous.mp4\n</code></pre> Setting Value Model veo-2.0 Duration 8 seconds Audio  No Extension  Supported Cost $$ Medium <p>Best for:</p> <ul> <li>Extending existing videos</li> <li>Creating longer sequences</li> <li>Chaining multiple clips</li> </ul>"},{"location":"guides/presets/#budget","title":"budget","text":"<p>Purpose: Cost-effective generation</p> <pre><code>python video_gen.py \"Simple animation\" --preset budget\n</code></pre> Setting Value Model veo-2.0 Duration 5 seconds Audio  No Speed Medium Cost $ Lower <p>Best for:</p> <ul> <li>High volume generation</li> <li>Testing and experiments</li> <li>Budget-conscious projects</li> </ul>"},{"location":"guides/presets/#combining-with-options","title":"Combining with Options","text":"<p>Presets set defaults but can be overridden:</p> <pre><code># Use quality preset but change duration\npython video_gen.py \"Prompt\" --preset quality --duration 5\n\n# Use extend preset with custom model\npython video_gen.py \"Prompt\" --preset extend --model veo-2.0-exp\n</code></pre>"},{"location":"guides/presets/#preset-comparison","title":"Preset Comparison","text":"<pre><code>Quality: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 Best output\nQuick:   \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591 Good balance\nBudget:  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591 Cost effective\nExtend:  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591 Extension focused\n</code></pre>"},{"location":"guides/presets/#cost-comparison","title":"Cost Comparison","text":"Preset Est. Cost per Video quality ~$0.50 quick ~$0.25 extend ~$0.20 budget ~$0.15 <p>Check Exact Pricing</p> <p>Use <code>--estimate-cost</code> to see exact pricing before generating.</p>"},{"location":"guides/presets/#custom-presets","title":"Custom Presets","text":"<p>For custom configurations, use <code>config.json</code>:</p> <pre><code>{\n  \"presets\": {\n    \"my_custom\": {\n      \"model\": \"veo-3.1-generate-preview\",\n      \"duration\": 6,\n      \"aspect_ratio\": \"9:16\"\n    }\n  }\n}\n</code></pre>"},{"location":"guides/presets/#learn-more","title":"Learn More","text":"<ul> <li>Video Models - Model details</li> <li>CLI: video_gen.py - Full CLI reference</li> <li>Video Extension - Extension workflow</li> </ul>"},{"location":"guides/troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and solutions.</p>"},{"location":"guides/troubleshooting/#authentication-issues","title":"Authentication Issues","text":""},{"location":"guides/troubleshooting/#invalid-api-key","title":"\"Invalid API key\"","text":"<p>Problem: API key is not valid or expired</p> <p>Solutions:</p> <ol> <li>Check key prefix: <code>AIzaSy...</code> for Gemini API</li> <li>Regenerate key at Google AI Studio</li> <li>Ensure key is not quoted incorrectly</li> </ol> <pre><code># Check key format\necho $GOOGLE_API_KEY | head -c 10\n# Should show: AIzaSy...\n</code></pre>"},{"location":"guides/troubleshooting/#permission-denied-403-forbidden","title":"\"Permission denied\" / \"403 Forbidden\"","text":"<p>Problem: API access not authorized</p> <p>Solutions:</p> <ol> <li>Enable Vertex AI API in Cloud Console</li> <li>Check billing is enabled</li> <li>Verify API key has correct permissions</li> </ol> <pre><code># For Vertex AI, use OAuth instead of API key\ngcloud auth application-default login\nTOKEN=$(gcloud auth application-default print-access-token)\npython video_gen.py \"test\" --key \"$TOKEN\"\n</code></pre>"},{"location":"guides/troubleshooting/#401-unauthorized","title":"\"401 Unauthorized\"","text":"<p>Problem: Authentication failed</p> <p>Solutions:</p> <ol> <li>Vertex AI keys (<code>AQ...</code>) need OAuth for some operations</li> <li>Token may be expired - refresh it</li> </ol> <pre><code># Refresh OAuth token\ngcloud auth application-default login\n</code></pre>"},{"location":"guides/troubleshooting/#video-generation-issues","title":"Video Generation Issues","text":""},{"location":"guides/troubleshooting/#model-not-found","title":"\"Model not found\"","text":"<p>Problem: Specified model doesn't exist</p> <p>Solutions:</p> <ol> <li>Check model name spelling</li> <li>List available models</li> </ol> <pre><code>python check_api.py --key \"$GOOGLE_API_KEY\"\n</code></pre> <p>Common models:</p> <ul> <li><code>veo-3.1-generate-preview</code></li> <li><code>veo-3.1-fast-generate-preview</code></li> <li><code>veo-2.0</code></li> </ul>"},{"location":"guides/troubleshooting/#rate-limit-exceeded","title":"\"Rate limit exceeded\"","text":"<p>Problem: Too many requests</p> <p>Solutions:</p> <ol> <li>Wait 30-60 seconds between requests</li> <li>Use <code>--preset budget</code> for lower cost</li> <li>Batch requests during off-peak hours</li> </ol>"},{"location":"guides/troubleshooting/#billing-not-enabled","title":"\"Billing not enabled\"","text":"<p>Problem: Video generation requires billing</p> <p>Solution:</p> <ol> <li>Go to Cloud Console</li> <li>Enable billing for your project</li> <li>Link a payment method</li> </ol> <p>Free Tier</p> <p>Image generation with Gemini 2.0 Flash is free tier, but video generation requires billing.</p>"},{"location":"guides/troubleshooting/#video-extension-issues","title":"Video Extension Issues","text":""},{"location":"guides/troubleshooting/#video-is-empty","title":"\"video is empty\"","text":"<p>Problem: External URL used for extension</p> <p>Cause: API doesn't support HTTP/HTTPS URLs</p> <p>Solution: Download video first, then use local file</p> <pre><code># Download\ncurl -o local.mp4 \"https://example.com/video.mp4\"\n\n# Use local file\npython video_gen.py \"Continue\" --extend-video local.mp4\n</code></pre>"},{"location":"guides/troubleshooting/#fps-mismatch","title":"\"fps mismatch\"","text":"<p>Problem: Source video is not 24fps</p> <p>Solution: Convert to 24fps using ffmpeg</p> <pre><code># Check current fps\nffprobe -v error -select_streams v:0 -show_entries stream=r_frame_rate input.mp4\n\n# Convert to 24fps\nffmpeg -i input.mp4 -r 24 -c:v libx264 output_24fps.mp4\n\n# Use converted file\npython video_gen.py \"Continue\" --extend-video output_24fps.mp4\n</code></pre>"},{"location":"guides/troubleshooting/#model-does-not-support-video_extension","title":"\"Model does not support video_extension\"","text":"<p>Problem: Using veo-3.1 for extension</p> <p>Solution: Use veo-2.0 for video extension</p> <pre><code>python video_gen.py \"Continue\" \\\n  --extend-video input.mp4 \\\n  --model veo-2.0\n</code></pre>"},{"location":"guides/troubleshooting/#reference-image-issues","title":"Reference Image Issues","text":""},{"location":"guides/troubleshooting/#too-many-references","title":"\"Too many references\"","text":"<p>Problem: Exceeded reference image limits</p> <p>Limits:</p> <ul> <li>Maximum 3 asset images</li> <li>Maximum 1 style image</li> <li>Cannot mix asset and style</li> </ul> <p>Solution: Reduce number of references</p> <pre><code># Use max 3 assets\npython video_gen.py \"prompt\" \\\n  --reference-image img1.png:asset \\\n  --reference-image img2.png:asset \\\n  --reference-image img3.png:asset\n</code></pre>"},{"location":"guides/troubleshooting/#does-not-support-this-mix","title":"\"does not support this mix\"","text":"<p>Problem: Mixing asset and style references</p> <p>Solution: Use only one type per request</p> <pre><code># \u274c Wrong\n--reference-image face.png:asset --reference-image style.jpg:style\n\n# \u2705 Correct - assets only\n--reference-image face1.png:asset --reference-image face2.png:asset\n\n# \u2705 Correct - style only\n--reference-image painting.jpg:style\n</code></pre>"},{"location":"guides/troubleshooting/#reference-type-not-supported","title":"\"Reference type not supported\"","text":"<p>Problem: Style reference on wrong model</p> <p>Solution: Use <code>veo-2.0-exp</code> for style</p> <pre><code>python video_gen.py \"prompt\" \\\n  --reference-image style.jpg:style \\\n  --model veo-2.0-exp\n</code></pre>"},{"location":"guides/troubleshooting/#gcs-issues","title":"GCS Issues","text":""},{"location":"guides/troubleshooting/#bucket-not-found","title":"\"Bucket not found\"","text":"<p>Problem: GCS bucket doesn't exist</p> <p>Solution:</p> <pre><code># Create bucket\ngsutil mb gs://your-bucket-name\n</code></pre>"},{"location":"guides/troubleshooting/#permission-denied-on-bucket","title":"\"Permission denied on bucket\"","text":"<p>Problem: No access to GCS bucket</p> <p>Solution:</p> <pre><code># Grant access\ngsutil iam ch user:your@email.com:objectAdmin gs://your-bucket\n</code></pre>"},{"location":"guides/troubleshooting/#gsutil-not-found","title":"\"gsutil not found\"","text":"<p>Problem: gcloud SDK not installed</p> <p>Solution:</p> <pre><code># Install gcloud\ncurl https://sdk.cloud.google.com | bash\n\n# Or use Python package\npip install google-cloud-storage\n</code></pre>"},{"location":"guides/troubleshooting/#general-issues","title":"General Issues","text":""},{"location":"guides/troubleshooting/#timeout","title":"\"Timeout\"","text":"<p>Problem: Request took too long</p> <p>Solutions:</p> <ol> <li>Video generation can take 60-180 seconds</li> <li>Check internet connection</li> <li>Try again - may be temporary</li> </ol>"},{"location":"guides/troubleshooting/#output-file-not-created","title":"\"Output file not created\"","text":"<p>Problem: Video generation failed silently</p> <p>Solutions:</p> <ol> <li>Check <code>--verbose</code> output for errors</li> <li>Verify output directory exists</li> <li>Check disk space</li> </ol> <pre><code>python video_gen.py \"prompt\" --verbose\n</code></pre>"},{"location":"guides/troubleshooting/#import-error-requests","title":"\"Import error: requests\"","text":"<p>Problem: Missing dependencies</p> <p>Solution:</p> <pre><code>pip install requests google-auth google-auth-oauthlib\n</code></pre>"},{"location":"guides/troubleshooting/#getting-help","title":"Getting Help","text":"<ol> <li>Check this troubleshooting guide</li> <li>Run with <code>--verbose</code> for details</li> <li>Check Changelog for known issues</li> <li>Open issue on GitHub</li> </ol>"},{"location":"guides/troubleshooting/#learn-more","title":"Learn More","text":"<ul> <li>Authentication - Auth setup guide</li> <li>Video Extension - Extension requirements</li> <li>GCS Storage - GCS configuration</li> </ul>"},{"location":"image/","title":"Image Generation","text":"<p>Generate AI images using Google Gemini and Imagen models.</p>"},{"location":"image/#overview","title":"Overview","text":"<p>Image generation uses <code>generateContent</code> API method (synchronous) and supports text-to-image generation with various aspect ratios and resolutions.</p>"},{"location":"image/#supported-models","title":"Supported Models","text":"Model Quality Cost per Image gemini-3-pro-image-preview Best (Default) $0.134 imagen-3 Good $0.03 imagen-4 Good $0.04 <p>Default Model</p> <p><code>gemini-3-pro-image-preview</code> is the default model for best quality.</p>"},{"location":"image/#basic-usage","title":"Basic Usage","text":"<pre><code># Simple image generation\npython image_gen.py \"A futuristic city at sunset\"\n\n# With options\npython image_gen.py \"A cat sitting on a couch\" \\\n  --aspect-ratio 16:9 \\\n  --image-size 2K\n</code></pre>"},{"location":"image/#command-line-options","title":"Command Line Options","text":"Option Values Default Description <code>--aspect-ratio</code> 1:1, 16:9, 9:16, 4:3, 3:4 1:1 Image aspect ratio <code>--image-size</code> 1K, 2K 1K Image resolution <code>--model</code> gemini-3-pro-image-preview Default Model to use <code>--estimate-cost</code> Flag - Show cost without generating <code>--project</code> Project name default Config project to use"},{"location":"image/#aspect-ratios","title":"Aspect Ratios","text":"Ratio Best For <code>1:1</code> Social media, avatars, icons <code>16:9</code> Widescreen, desktop wallpaper <code>9:16</code> Mobile, stories, vertical video <code>4:3</code> Traditional photo format <code>3:4</code> Portrait photos"},{"location":"image/#examples","title":"Examples","text":""},{"location":"image/#social-media","title":"Social Media","text":"<pre><code># Instagram square\npython image_gen.py \"A coffee cup with latte art\" --aspect-ratio 1:1\n\n# Instagram story\npython image_gen.py \"Mountain landscape\" --aspect-ratio 9:16\n</code></pre>"},{"location":"image/#desktop-wallpaper","title":"Desktop Wallpaper","text":"<pre><code>python image_gen.py \"Abstract geometric patterns, purple and blue\" \\\n  --aspect-ratio 16:9 \\\n  --image-size 2K\n</code></pre>"},{"location":"image/#documentationdiagrams","title":"Documentation/Diagrams","text":"<pre><code>python image_gen.py \"Architecture diagram for microservices\" \\\n  --doc README.md\n</code></pre>"},{"location":"image/#cost-estimation","title":"Cost Estimation","text":"<p>Preview cost before generating:</p> <pre><code>python image_gen.py \"A beautiful sunset\" --estimate-cost\n</code></pre> <p>Output: <pre><code>\ud83d\udcb0 Cost Estimate:\n   Model: gemini-3-pro-image-preview\n   Count: 1\n   Price: $0.134 per image\n   Total: $0.134\n</code></pre></p>"},{"location":"image/#output","title":"Output","text":"<p>Images are saved to <code>generated_images/</code> directory:</p> <pre><code>generated_images/\n\u251c\u2500\u2500 image_20260123_123456.png\n\u251c\u2500\u2500 image_20260123_123500.png\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"image/#using-with-documents","title":"Using with Documents","text":"<p>Generate images based on document content:</p> <pre><code>python image_gen.py \"Diagram of the system\" --doc design.md\n</code></pre> <p>The script reads the document and incorporates context into the prompt.</p>"},{"location":"image/#api-differences-from-video","title":"API Differences from Video","text":"Aspect Image Video API Method generateContent predictLongRunning Response Synchronous Asynchronous (polling) Free Tier  Gemini 2.0 Flash  None Generation Time ~5-15 seconds ~60-180 seconds"},{"location":"image/#troubleshooting","title":"Troubleshooting","text":""},{"location":"image/#unknown-provider","title":"\"Unknown provider\"","text":"<p>Some models may not be available:</p> <pre><code># Use default model instead\npython image_gen.py \"prompt\"  # Uses gemini-3-pro-image-preview\n</code></pre>"},{"location":"image/#rate-limit-exceeded","title":"\"Rate limit exceeded\"","text":"<p>Wait a few seconds between requests or reduce frequency.</p>"},{"location":"image/#image-not-generated","title":"Image not generated","text":"<ul> <li>Check API key is valid</li> <li>Ensure prompt follows content guidelines</li> <li>Try simplifying the prompt</li> </ul>"},{"location":"image/#learn-more","title":"Learn More","text":"<ul> <li>Quick Start - Getting started guide</li> <li>Authentication - API key setup</li> <li>CLI Reference: image_gen.py - Full CLI reference</li> </ul>"},{"location":"issue/veo-video-generation-support/","title":"\ud83c\udfac Feature Request: Add Veo Video Generation Support (Similar to Image Generation)","text":""},{"location":"issue/veo-video-generation-support/#summary","title":"\ud83d\udccb Summary","text":"<p>Add support for Google's Veo 3.1 video generation models to CLIProxyAPI, following the same architecture pattern as the existing <code>gemini-3-pro-image-preview</code> image generation support.</p> <p>This would enable users to generate videos through CLIProxyAPI using the same client format with <code>modalities: [\"video\", \"text\"]</code> and <code>video_config</code>, just like how image generation currently works.</p> <p>GitHub Issue: https://github.com/router-for-me/CLIProxyAPIPlus/issues/94</p>"},{"location":"issue/veo-video-generation-support/#current-state-image-generation","title":"\ud83c\udfaf Current State (Image Generation)","text":"<p>Currently working perfectly: <pre><code># image_gen.py - Image Generation (\u2705 Working)\nPOST http://127.0.0.1:8317/v1/chat/completions\nAuthorization: Bearer ccs-internal-managed\n\n{\n  \"model\": \"gemini-3-pro-image-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"A cute cat\"}],\n  \"modalities\": [\"image\", \"text\"],\n  \"image_config\": {\n    \"aspect_ratio\": \"1:1\",\n    \"image_size\": \"1K\"\n  }\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"choices\": [{\n    \"message\": {\n      \"images\": [{\n        \"image_url\": {\"url\": \"data:image/png;base64,...\"}\n      }]\n    }\n  }]\n}\n</code></pre></p>"},{"location":"issue/veo-video-generation-support/#reference-implementation-image_genpy","title":"\ud83d\udcbb Reference Implementation (image_gen.py)","text":"<p>CLIProxyAPI \u0e43\u0e0a\u0e49 format translation mechanism \u0e02\u0e2d\u0e07\u0e15\u0e31\u0e27\u0e40\u0e2d\u0e07 - \u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e1c\u0e48\u0e32\u0e19 OpenRouter</p>"},{"location":"issue/veo-video-generation-support/#key-code-sections","title":"Key Code Sections","text":"<p>1. Authentication (lines 41-44) <pre><code>HEADERS = {\n    \"Authorization\": \"Bearer ccs-internal-managed\",\n    \"Content-Type\": \"application/json\"\n}\n</code></pre></p> <p>2. Request Payload (lines 94-107) <pre><code>payload = {\n    \"model\": model,\n    \"messages\": [\n        {\n            \"role\": \"user\",\n            \"content\": prompt\n        }\n    ],\n    \"modalities\": [\"image\", \"text\"],\n    \"image_config\": {\n        \"aspect_ratio\": aspect_ratio,\n        \"image_size\": image_size\n    }\n}\n</code></pre></p> <p>3. Response Handling (lines 129-189) <pre><code>result = response.json()\n\nif result.get(\"choices\"):\n    message = result[\"choices\"][0].get(\"message\", {})\n\n    if message.get(\"images\"):\n        for i, image_obj in enumerate(message[\"images\"]):\n            image_url = image_obj.get(\"image_url\", {}).get(\"url\", \"\")\n\n            if image_url:\n                # Save base64 image data\n                saved_path = save_image(image_url, output_dir, i)\n</code></pre></p>"},{"location":"issue/veo-video-generation-support/#requested-feature-video-generation","title":"\ud83c\udfac Requested Feature (Video Generation)","text":"<p>Desired behavior: <pre><code># video_gen.py - Video Generation (\ud83c\udfaf Desired)\nPOST http://127.0.0.1:8317/v1/chat/completions\nAuthorization: Bearer ccs-internal-managed\n\n{\n  \"model\": \"veo-3.1-generate-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"A cat playing with a ball\"}],\n  \"modalities\": [\"video\", \"text\"],\n  \"video_config\": {\n    \"duration_seconds\": \"8\",\n    \"aspect_ratio\": \"16:9\",\n    \"resolution\": \"720p\"\n  }\n}\n</code></pre></p> <p>Expected Response: <pre><code>{\n  \"choices\": [{\n    \"message\": {\n      \"videos\": [{\n        \"video_url\": {\"url\": \"data:video/mp4;base64,...\"}\n      }]\n    }\n  }]\n}\n</code></pre></p>"},{"location":"issue/veo-video-generation-support/#google-veo-api-details","title":"\ud83d\udcca Google Veo API Details","text":""},{"location":"issue/veo-video-generation-support/#official-rest-api-format","title":"Official REST API Format","text":"<p>Endpoint: <pre><code>POST https://generativelanguage.googleapis.com/v1beta/models/veo-3.1-generate-preview:predictLongRunning\n</code></pre></p> <p>Request Format (Google Native): <pre><code>{\n  \"instances\": [{\n    \"prompt\": \"A cinematic shot of a majestic lion in the savannah\"\n  }],\n  \"parameters\": {\n    \"aspectRatio\": \"16:9\",\n    \"resolution\": \"720p\",\n    \"durationSeconds\": \"8\"\n  }\n}\n</code></pre></p> <p>Response (Async Operation): <pre><code>{\n  \"name\": \"operations/veo-3.1-generate-preview/123456789\",\n  \"done\": false,\n  \"metadata\": {\n    \"@type\": \"type.googleapis.com/google.api.Operation\"\n  }\n}\n</code></pre></p> <p>Poll for Completion: <pre><code>GET https://generativelanguage.googleapis.com/v1beta/{operation_name}\n</code></pre></p> <p>Final Response: <pre><code>{\n  \"name\": \"operations/...\",\n  \"done\": true,\n  \"response\": {\n    \"generateVideoResponse\": {\n      \"generatedSamples\": [{\n        \"video\": {\n          \"uri\": \"https://generativelanguage.googleapis.com/v1beta/...\"\n        }\n      }]\n    }\n  }\n}\n</code></pre></p>"},{"location":"issue/veo-video-generation-support/#supported-veo-models","title":"Supported Veo Models","text":"Model Type Resolution Duration <code>veo-3.1-generate-preview</code> Preview 720p, 1080p 4s, 6s, 8s <code>veo-3.1-fast-generate-preview</code> Fast Preview 720p, 1080p 4s, 6s, 8s <code>veo-3.0-generate-001</code> Stable 720p, 1080p 8s <code>veo-3.0-fast-generate-001</code> Fast Stable 720p, 1080p 8s"},{"location":"issue/veo-video-generation-support/#key-parameters","title":"Key Parameters","text":"Parameter Type Values Description <code>prompt</code> string - Text description for video <code>aspectRatio</code> string <code>\"16:9\"</code>, <code>\"9:16\"</code> Video aspect ratio <code>resolution</code> string <code>\"720p\"</code>, <code>\"1080p\"</code> Video resolution <code>durationSeconds</code> string <code>\"4\"</code>, <code>\"6\"</code>, <code>\"8\"</code> Video length in seconds <code>negativePrompt</code> string - What NOT to include"},{"location":"issue/veo-video-generation-support/#proposed-implementation","title":"\ud83c\udfd7\ufe0f Proposed Implementation","text":""},{"location":"issue/veo-video-generation-support/#1-client-format-input-cliproxyapi-format","title":"1. Client Format (Input) - CLIProxyAPI Format","text":"<p>Video Generation Request: <pre><code>{\n  \"model\": \"veo-3.1-generate-preview\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"Prompt text here\"}],\n  \"modalities\": [\"video\", \"text\"],\n  \"video_config\": {\n    \"duration_seconds\": \"8\",\n    \"aspect_ratio\": \"16:9\",\n    \"resolution\": \"720p\",\n    \"negative_prompt\": \"cartoon, drawing, low quality\"\n  }\n}\n</code></pre></p>"},{"location":"issue/veo-video-generation-support/#2-translation-logic-go","title":"2. Translation Logic (Go)","text":"<p>CLIProxyAPI Format \u2192 Google Veo Format: <pre><code>func translateVideoRequest(req CLIProxyAPIRequest) VeoRequest {\n    config := req.VideoConfig\n\n    return VeoRequest{\n        Instances: []VeoInstance{\n            {Prompt: extractPrompt(req.Messages)},\n        },\n        Parameters: VeoParameters{\n            AspectRatio: translateAspectRatio(config.AspectRatio),\n            Resolution: config.Resolution,\n            DurationSeconds: config.DurationSeconds,\n            NegativePrompt: config.NegativePrompt,\n        },\n    }\n}\n</code></pre></p>"},{"location":"issue/veo-video-generation-support/#3-response-translation","title":"3. Response Translation","text":"<p>Google Veo \u2192 CLIProxyAPI Format: <pre><code>func translateVideoResponse(resp VeoResponse) CLIProxyAPIResponse {\n    video := resp.Response.GenerateVideoResponse.GeneratedSamples[0].Video\n\n    return CLIProxyAPIResponse{\n        Choices: []Choice{\n            {\n                Message: Message{\n                    Videos: []Video{\n                        {\n                            VideoURL: VideoURL{\n                                URL: \"data:video/mp4;base64,\" + video.VideoBytes,\n                            },\n                        },\n                    },\n                },\n            },\n        },\n    }\n}\n</code></pre></p>"},{"location":"issue/veo-video-generation-support/#4-async-operation-handling","title":"4. Async Operation Handling","text":"<p>Video generation is asynchronous - needs polling:</p> <pre><code>func waitForVideoOperation(operationName string) (*VeoResponse, error) {\n    for {\n        resp := getOperation(operationName)\n\n        if resp.Done {\n            return resp.Response, nil\n        }\n\n        time.Sleep(10 * time.Second)\n    }\n}\n</code></pre>"},{"location":"issue/veo-video-generation-support/#5-model-routing","title":"5. Model Routing","text":"<p>Add to routing table: <pre><code>var modelRoutes = map[string]string{\n    // Image models (existing)\n    \"gemini-3-pro-image-preview\": \"imagen-3.0-generate-001\",\n\n    // Video models (new)\n    \"veo-3.1-generate-preview\": \"veo-3.1-generate-preview:predictLongRunning\",\n    \"veo-3.1-fast-generate-preview\": \"veo-3.1-fast-generate-preview:predictLongRunning\",\n    \"veo-3.0-generate-001\": \"veo-3.0-generate-001:predictLongRunning\",\n    \"veo-3.0-fast-generate-001\": \"veo-3.0-fast-generate-001:predictLongRunning\",\n}\n</code></pre></p>"},{"location":"issue/veo-video-generation-support/#architecture-comparison","title":"\ud83d\udcd0 Architecture Comparison","text":""},{"location":"issue/veo-video-generation-support/#image-generation-current","title":"Image Generation (Current)","text":"<pre><code>Client Request (CLIProxyAPI format)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nQuery CCS for OAuth token\n    \u2193\nGoogle Imagen API (synchronous)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nClient Response (CLIProxyAPI format)\n</code></pre>"},{"location":"issue/veo-video-generation-support/#video-generation-proposed","title":"Video Generation (Proposed)","text":"<pre><code>Client Request (CLIProxyAPI format)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nQuery CCS for OAuth token\n    \u2193\nGoogle Veo API (asynchronous)\n    \u2193\nCLIProxyAPI Poller (poll until done)\n    \u2193\nCLIProxyAPI Translator\n    \u2193\nClient Response (CLIProxyAPI format)\n</code></pre>"},{"location":"issue/veo-video-generation-support/#key-differences-from-image-generation","title":"\ud83d\udd27 Key Differences from Image Generation","text":"Aspect Image Generation Video Generation Response Type Synchronous Asynchronous (Long-running operation) Processing Time ~5-30 seconds 1-5 minutes Polling Required No Yes Response Format Direct base64 URI + async polling Output Size ~100KB-2MB ~5-20MB Endpoint <code>:predict</code> <code>:predictLongRunning</code>"},{"location":"issue/veo-video-generation-support/#acceptance-criteria","title":"\u2705 Acceptance Criteria","text":""},{"location":"issue/veo-video-generation-support/#must-have","title":"Must Have","text":"<ul> <li> Support <code>veo-3.1-generate-preview</code> model</li> <li> Accept CLIProxyAPI format with <code>modalities: [\"video\", \"text\"]</code></li> <li> Accept <code>video_config</code> parameters:</li> <li><code>duration_seconds</code></li> <li><code>aspect_ratio</code></li> <li><code>resolution</code></li> <li><code>negative_prompt</code></li> <li> Translate CLIProxyAPI \u2192 Google Veo format</li> <li> Handle async operation (polling mechanism)</li> <li> Translate response back to CLIProxyAPI format</li> <li> Return video as base64 data URI (<code>data:video/mp4;base64,...</code>)</li> <li> Use OAuth authentication from CCS (same as image)</li> <li> Route through <code>gemini</code> provider channel</li> </ul>"},{"location":"issue/veo-video-generation-support/#nice-to-have","title":"Nice to Have","text":"<ul> <li> Support <code>veo-3.1-fast-generate-preview</code> (faster generation)</li> <li> Support <code>veo-3.0-generate-001</code> (stable version)</li> <li> Support image-to-video generation</li> <li> Support video extension</li> <li> Progress reporting during polling</li> </ul>"},{"location":"issue/veo-video-generation-support/#references","title":"\ud83d\udcda References","text":""},{"location":"issue/veo-video-generation-support/#related-discussion","title":"Related Discussion","text":"<p>Discussion #378: Image gen not supported/enabled for gemini-3-pro-image-preview?</p> <p>This discussion contains working code examples for image generation via CLIProxyAPI, which served as the reference implementation for this video generation feature request.</p>"},{"location":"issue/veo-video-generation-support/#reference-implementation","title":"Reference Implementation","text":"<p>File: <code>image_gen.py</code></p> <p>Key Sections: - Lines 41-44: CCS OAuth authentication headers - Lines 94-107: Request payload structure - Lines 129-189: Response parsing and image extraction</p>"},{"location":"issue/veo-video-generation-support/#google-official-documentation","title":"Google Official Documentation","text":"<ul> <li>Video API Docs: https://ai.google.dev/gemini-api/docs/video</li> <li>REST API: <code>POST /v1beta/models/veo-3.1-generate-preview:predictLongRunning</code></li> <li>Async Operations: Poll <code>GET /v1beta/{operation_name}</code> until <code>done: true</code></li> </ul>"},{"location":"issue/veo-video-generation-support/#additional-notes","title":"\ud83d\udcdd Additional Notes","text":""},{"location":"issue/veo-video-generation-support/#authentication","title":"Authentication","text":"<p>Video generation should use the same OAuth authentication as image generation: - Token source: <code>~/.ccs/cliproxy/auth/gemini-*.json</code> - Header: <code>Authorization: Bearer ccs-internal-managed</code> - Provider: <code>gemini</code> channel</p>"},{"location":"issue/veo-video-generation-support/#compatibility","title":"Compatibility","text":"<ul> <li>Backward compatible: Does not break existing image generation</li> <li>Same endpoint: <code>/v1/chat/completions</code></li> <li>Same auth method: <code>ccs-internal-managed</code></li> <li>New modality: <code>video</code> (in addition to existing <code>image</code>, <code>text</code>)</li> </ul>"},{"location":"issue/veo-video-generation-support/#error-handling","title":"Error Handling","text":"<ul> <li>Handle operation timeout</li> <li>Handle quota exceeded</li> <li>Handle polling failures</li> <li>Handle video generation failures</li> </ul>"},{"location":"issue/veo-video-generation-support/#thank-you","title":"\ud83d\ude4f Thank You","text":"<p>This feature would enable video generation capabilities through CLIProxyAPI using the same clean, consistent interface that makes image generation so easy to use!</p> <p>Labels: <code>enhancement</code>, <code>video generation</code>, <code>veo</code>, <code>feature request</code> Priority: Medium Complexity: Medium (requires async polling, similar architecture to existing image generation) Status: Open - https://github.com/router-for-me/CLIProxyAPIPlus/issues/94</p>"},{"location":"skills/agent/","title":"Generative Media Navigator Agent","text":"<p>The Generative Media Navigator is a Claude Code agent that automatically detects when you want to create videos or images, then invokes the <code>/generative</code> skill for you.</p>"},{"location":"skills/agent/#skill-agent-architecture","title":"Skill + Agent Architecture","text":"Component Purpose Type Install <code>/generative</code> Skill Execute generation commands Skill \u2705 Required Generative Media Navigator Auto-detect intent, invoke skill Agent \u2705 Recommended <p>Recommended Setup</p> <p>Install both the Skill and Agent for the complete experience. The agent provides natural language understanding on top of the skill's execution capabilities.</p> <p>Dependency</p> <p>The agent requires the <code>/generative</code> skill to be installed first. See Skill Installation.</p>"},{"location":"skills/agent/#how-it-works","title":"How It Works","text":"<pre><code>User: \"Create a video of a cat walking on the moon\"\n  \u2193\nAgent detects: video intent, prompt = \"cat walking on the moon\"\n  \u2193\nAgent invokes: /generative video \"cat walking on the moon\"\n  \u2193\nResult returned to user\n</code></pre>"},{"location":"skills/agent/#intent-detection","title":"Intent Detection","text":"<p>The agent recognizes these patterns:</p> <p>Video Keywords:</p> Trigger Phrase Intent create video, make video Video generation I want a video, generate video Video generation make a clip, create animation Video generation <p>Image Keywords:</p> Trigger Phrase Intent create image, make image Image generation I want an image, generate image Image generation create a picture, make a photo Image generation"},{"location":"skills/agent/#installation","title":"Installation","text":""},{"location":"skills/agent/#prerequisites","title":"Prerequisites","text":"<ul> <li>\u2705 Claude Code installed</li> <li>\u2705 <code>/generative</code> skill installed (see Installation)</li> </ul>"},{"location":"skills/agent/#linux-macos","title":"Linux / macOS","text":"<pre><code># Create agents directory\nmkdir -p ~/.claude/agents\n\n# Copy agent file from repository\ncp .claude/agents/generative-media-navigator.md ~/.claude/agents/\n\n# Restart Claude Code\n</code></pre>"},{"location":"skills/agent/#windows-powershell","title":"Windows (PowerShell)","text":"<pre><code># Create agents directory\nNew-Item -ItemType Directory -Force -Path \"$env:USERPROFILE\\.claude\\agents\"\n\n# Copy agent file\nCopy-Item \".\\.claude\\agents\\generative-media-navigator.md\" `\n   -Destination \"$env:USERPROFILE\\.claude\\agents\\\"\n\n# Restart Claude Code\n</code></pre>"},{"location":"skills/agent/#verification","title":"Verification","text":"<p>After installation, test with natural language:</p> <pre><code>You: \"Create a video of a cat walking on the moon\"\nAgent: [Detects video intent \u2192 invokes /generative video \"cat walking on the moon\"]\n\nYou: \"Create an image of a beautiful sunset\"\nAgent: [Detects image intent \u2192 invokes /generative image \"beautiful sunset\"]\n\nYou: \"Make a video showing ocean waves\"\nAgent: [Detects video intent \u2192 invokes /generative video \"ocean waves\"]\n</code></pre>"},{"location":"skills/agent/#when-agent-does-not-act","title":"When Agent Does NOT Act","text":"<p>The agent will not auto-invoke when:</p> <ul> <li>Asking about previous generated content (\"How did the video I made earlier turn out?\")</li> <li>Troubleshooting or checking status</li> <li>Request is ambiguous (will ask for clarification)</li> <li>User explicitly says they don't want to generate</li> </ul>"},{"location":"skills/agent/#directory-structure","title":"Directory Structure","text":"<p>After full installation (Skill + Agent):</p> <pre><code>~/.claude/\n\u251c\u2500\u2500 agents/\n\u2502   \u2514\u2500\u2500 generative-media-navigator.md   \u2190 Agent (enhancement)\n\u2514\u2500\u2500 skills/\n    \u2514\u2500\u2500 generative/\n        \u2514\u2500\u2500 SKILL.md                      \u2190 Skill (required)\n</code></pre>"},{"location":"skills/agent/#agent-configuration","title":"Agent Configuration","text":"<p>The agent uses these settings:</p> Setting Value Description <code>name</code> <code>generative-media-navigator</code> Unique identifier <code>tools</code> <code>Bash, Read, Glob, Grep, AskUserQuestion, Skill</code> Available tools <code>model</code> <code>inherit</code> Uses parent model <code>color</code> <code>purple</code> UI indicator color"},{"location":"skills/agent/#updating","title":"Updating","text":"<pre><code># Pull latest changes\ncd claude-code-media-generator\ngit pull\n\n# Update agent file\n# Linux/macOS:\ncp .claude/agents/generative-media-navigator.md ~/.claude/agents/\n\n# Windows (PowerShell):\nCopy-Item \".\\.claude\\agents\\generative-media-navigator.md\" `\n   -Destination \"$env:USERPROFILE\\.claude\\agents\\\" -Force\n\n# Restart Claude Code\n</code></pre>"},{"location":"skills/agent/#related","title":"Related","text":"<ul> <li>Skill Overview - About the <code>/generative</code> skill</li> <li>Commands - All skill commands</li> <li>Configuration - API setup</li> </ul>"},{"location":"skills/commands/","title":"Skill Commands Reference","text":"<p>Complete reference for all <code>/generative</code> skill commands.</p>"},{"location":"skills/commands/#main-commands","title":"Main Commands","text":"Command Description <code>/generative image \"prompt\"</code> Generate image from text <code>/generative video \"prompt\"</code> Generate video from text <code>/generative info</code> Show capabilities overview <code>/generative config</code> Configuration management <code>/generative help</code> Detailed help system"},{"location":"skills/commands/#image-generation","title":"Image Generation","text":""},{"location":"skills/commands/#basic-usage","title":"Basic Usage","text":"<pre><code>/generative image \"A beautiful sunset over mountains\"\n</code></pre>"},{"location":"skills/commands/#with-options","title":"With Options","text":"<pre><code># Specify aspect ratio\n/generative image \"A portrait of a robot\" --aspect-ratio 9:16\n\n# Higher resolution\n/generative image \"Landscape photography\" --image-size 2K\n\n# Multiple images\n/generative image \"Abstract art\" --count 4\n</code></pre>"},{"location":"skills/commands/#image-parameters","title":"Image Parameters","text":"Parameter Options Default <code>--aspect-ratio</code> <code>1:1</code>, <code>16:9</code>, <code>9:16</code>, <code>4:3</code>, <code>3:4</code> <code>1:1</code> <code>--image-size</code> <code>1K</code>, <code>2K</code> <code>1K</code> <code>--count</code> <code>1-4</code> <code>1</code> <code>--model</code> <code>gemini-2.0-flash</code>, <code>imagen-3.0</code> Auto"},{"location":"skills/commands/#video-generation","title":"Video Generation","text":""},{"location":"skills/commands/#basic-usage_1","title":"Basic Usage","text":"<pre><code>/generative video \"Ocean waves crashing on the beach\"\n</code></pre>"},{"location":"skills/commands/#with-options_1","title":"With Options","text":"<pre><code># Higher quality\n/generative video \"Cinematic sunset\" --preset quality\n\n# Specific duration\n/generative video \"A cat walking\" --duration 8\n\n# With aspect ratio\n/generative video \"Vertical video for social media\" --aspect-ratio 9:16\n</code></pre>"},{"location":"skills/commands/#video-parameters","title":"Video Parameters","text":"Parameter Options Default <code>--preset</code> <code>quick</code>, <code>quality</code>, <code>extend</code>, <code>budget</code> <code>quick</code> <code>--duration</code> <code>5</code>, <code>6</code>, <code>7</code>, <code>8</code> <code>5</code> <code>--aspect-ratio</code> <code>16:9</code>, <code>9:16</code> <code>16:9</code> <code>--model</code> See Video Models <code>veo-3.1-generate-preview</code>"},{"location":"skills/commands/#help-system","title":"Help System","text":""},{"location":"skills/commands/#main-help","title":"Main Help","text":"<pre><code>/generative help\n</code></pre>"},{"location":"skills/commands/#topic-specific-help","title":"Topic-Specific Help","text":"Command Description <code>/generative help image</code> Image generation guide <code>/generative help video</code> Video generation guide <code>/generative help examples</code> 10+ usage examples <code>/generative help modes</code> All 8 video modes explained <code>/generative help models</code> Model comparison <code>/generative help presets</code> Preset configurations"},{"location":"skills/commands/#configuration-commands","title":"Configuration Commands","text":""},{"location":"skills/commands/#setup-wizard","title":"Setup Wizard","text":"<pre><code>/generative config setup\n</code></pre> <p>Guided setup that helps you configure:</p> <ol> <li>API Type - Gemini API or Vertex AI</li> <li>API Key - Your authentication key</li> <li>Project ID - Google Cloud project (for Vertex AI)</li> <li>gcloud CLI - Optional installation</li> </ol>"},{"location":"skills/commands/#other-config-commands","title":"Other Config Commands","text":"Command Description <code>/generative config show</code> Show current settings <code>/generative config gemini</code> Setup Gemini API <code>/generative config vertex</code> Setup Vertex AI <code>/generative config gcloud</code> Setup gcloud CLI <code>/generative config reset</code> Reset to defaults"},{"location":"skills/commands/#info-command","title":"Info Command","text":"<pre><code>/generative info\n</code></pre> <p>Shows:</p> <ul> <li>Available models</li> <li>Supported features</li> <li>Current configuration status</li> <li>API connection status</li> </ul>"},{"location":"skills/commands/#advanced-video-modes","title":"Advanced Video Modes","text":"<p>For advanced video generation modes, use specific parameters:</p>"},{"location":"skills/commands/#image-to-video","title":"Image-to-Video","text":"<pre><code>/generative video \"Animate this image\" --image /path/to/image.jpg\n</code></pre>"},{"location":"skills/commands/#video-extension","title":"Video Extension","text":"<pre><code>/generative video \"Continue this video\" --extend /path/to/video.mp4\n</code></pre>"},{"location":"skills/commands/#reference-style","title":"Reference Style","text":"<pre><code>/generative video \"Apply this style\" --style-image /path/to/style.jpg\n</code></pre>"},{"location":"skills/commands/#reference-asset","title":"Reference Asset","text":"<pre><code>/generative video \"Use this character\" --reference-image /path/to/character.jpg\n</code></pre>"},{"location":"skills/commands/#tips-best-practices","title":"Tips &amp; Best Practices","text":""},{"location":"skills/commands/#1-be-descriptive","title":"1. Be Descriptive","text":"<pre><code># Good - descriptive prompt\n/generative video \"A golden retriever running through a sunlit meadow, slow motion, cinematic\"\n\n# Less effective - vague prompt\n/generative video \"dog running\"\n</code></pre>"},{"location":"skills/commands/#2-use-presets","title":"2. Use Presets","text":"<pre><code># Quick preview\n/generative video \"My prompt\" --preset quick\n\n# Best quality\n/generative video \"My prompt\" --preset quality\n</code></pre>"},{"location":"skills/commands/#3-check-costs-first","title":"3. Check Costs First","text":"<pre><code># Estimate cost before generating\n/generative video \"My prompt\" --estimate-cost\n</code></pre>"},{"location":"skills/commands/#next-steps","title":"Next Steps","text":"<ul> <li>Examples - Real usage examples</li> <li>Configuration - Detailed setup guide</li> <li>Video Modes - All 8 video generation modes</li> </ul>"},{"location":"skills/configuration/","title":"Skill Configuration","text":"<p>Complete guide to configuring the <code>/generative</code> skill.</p>"},{"location":"skills/configuration/#quick-setup","title":"Quick Setup","text":"<p>The easiest way to configure the skill is using the setup wizard:</p> <pre><code>/generative config setup\n</code></pre> <p>This interactive wizard guides you through:</p> <ol> <li>API Type Selection - Choose Gemini API or Vertex AI</li> <li>API Key Setup - Enter your authentication key</li> <li>Project Configuration - Set Google Cloud project ID</li> <li>gcloud CLI - Optional installation for Vertex AI</li> </ol>"},{"location":"skills/configuration/#configuration-methods","title":"Configuration Methods","text":""},{"location":"skills/configuration/#method-1-setup-wizard-recommended","title":"Method 1: Setup Wizard (Recommended)","text":"<pre><code>/generative config setup\n</code></pre> <p>Interactive, beginner-friendly, handles all settings.</p>"},{"location":"skills/configuration/#method-2-direct-commands","title":"Method 2: Direct Commands","text":"<pre><code># Setup Gemini API\n/generative config gemini\n\n# Setup Vertex AI\n/generative config vertex\n\n# Install gcloud CLI\n/generative config gcloud\n</code></pre>"},{"location":"skills/configuration/#method-3-view-current-config","title":"Method 3: View Current Config","text":"<pre><code>/generative config show\n</code></pre>"},{"location":"skills/configuration/#api-types","title":"API Types","text":""},{"location":"skills/configuration/#gemini-api-easier","title":"Gemini API (Easier)","text":"<p>Best for: Quick start, simple usage, image generation</p> <pre><code>/generative config gemini\n</code></pre> <p>Requirements: - Google AI Studio API key - No Google Cloud project needed for images - Billing required for video generation</p> <p>Get API Key: 1. Go to Google AI Studio 2. Click \"Get API Key\" 3. Create or select a project 4. Copy the key</p>"},{"location":"skills/configuration/#vertex-ai-full-features","title":"Vertex AI (Full Features)","text":"<p>Best for: Production use, GCS storage, advanced features</p> <pre><code>/generative config vertex\n</code></pre> <p>Requirements: - Google Cloud project with billing enabled - Service account or gcloud CLI authentication - Vertex AI API enabled</p> <p>Setup Steps: 1. Create Google Cloud project 2. Enable Vertex AI API 3. Enable billing 4. Create service account (or use gcloud CLI) 5. Configure with <code>/generative config vertex</code></p>"},{"location":"skills/configuration/#configuration-file","title":"Configuration File","text":"<p>The skill stores configuration in <code>config.json</code>:</p> <pre><code>{\n  \"api_type\": \"gemini\",\n  \"api_key\": \"AIzaSy...\",\n  \"project_id\": \"my-project-123\",\n  \"region\": \"us-central1\",\n  \"default_model\": \"veo-3.1-generate-preview\",\n  \"storage_uri\": \"gs://my-project-media-output/\"\n}\n</code></pre> <p>Location: Current working directory</p>"},{"location":"skills/configuration/#configuration-options","title":"Configuration Options","text":""},{"location":"skills/configuration/#core-settings","title":"Core Settings","text":"Setting Description Example <code>api_type</code> API type <code>gemini</code> or <code>vertex</code> <code>api_key</code> Authentication key <code>AIzaSy...</code> <code>project_id</code> Google Cloud project <code>my-project-123</code> <code>region</code> Vertex AI region <code>us-central1</code>"},{"location":"skills/configuration/#default-settings","title":"Default Settings","text":"Setting Description Default <code>default_model</code> Default video model <code>veo-3.1-generate-preview</code> <code>default_preset</code> Default preset <code>quick</code> <code>storage_uri</code> GCS storage URI (optional)"},{"location":"skills/configuration/#gcs-storage-configuration","title":"GCS Storage Configuration","text":"<p>For video extension and cloud storage:</p>"},{"location":"skills/configuration/#bucket-naming-convention","title":"Bucket Naming Convention","text":"<p>Important: Bucket Naming</p> <p>When using Vertex AI API Key, your GCS bucket MUST follow this pattern:</p> <pre><code>gs://YOUR_PROJECT_ID-media-output/\n</code></pre>"},{"location":"skills/configuration/#setup-gcs","title":"Setup GCS","text":"<pre><code># Configure storage URI\n/generative config storage gs://my-project-id-media-output/videos/\n</code></pre> <p>Or add to <code>config.json</code>:</p> <pre><code>{\n  \"storage_uri\": \"gs://my-project-id-media-output/videos/\"\n}\n</code></pre>"},{"location":"skills/configuration/#environment-variables","title":"Environment Variables","text":"<p>You can also use environment variables:</p> <pre><code># Set API key\nexport GOOGLE_API_KEY=\"AIzaSy...\"\n\n# Set project ID\nexport GOOGLE_CLOUD_PROJECT=\"my-project-123\"\n\n# Set region\nexport GOOGLE_CLOUD_REGION=\"us-central1\"\n</code></pre> <p>Priority Order: 1. Command-line arguments (highest) 2. <code>config.json</code> file 3. Environment variables 4. Default values (lowest)</p>"},{"location":"skills/configuration/#reset-configuration","title":"Reset Configuration","text":"<p>To reset all settings to defaults:</p> <pre><code>/generative config reset\n</code></pre> <p>This will: - Remove <code>config.json</code> - Clear cached settings - Require re-configuration</p>"},{"location":"skills/configuration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"skills/configuration/#invalid-api-key","title":"\"Invalid API key\"","text":"<pre><code># Verify your API key\n/generative config show\n\n# Re-run setup\n/generative config setup\n</code></pre>"},{"location":"skills/configuration/#permission-denied","title":"\"Permission denied\"","text":"<p>For Vertex AI: <pre><code># Ensure gcloud is authenticated\ngcloud auth application-default login\n\n# Check project permissions\ngcloud projects get-iam-policy YOUR_PROJECT_ID\n</code></pre></p>"},{"location":"skills/configuration/#model-not-found","title":"\"Model not found\"","text":"<pre><code># Check available models\n/generative info\n\n# Ensure Vertex AI API is enabled\ngcloud services enable aiplatform.googleapis.com\n</code></pre>"},{"location":"skills/configuration/#billing-not-enabled","title":"\"Billing not enabled\"","text":"<p>Video generation requires billing: 1. Go to Google Cloud Console 2. Enable billing for your project 3. Link a payment method</p>"},{"location":"skills/configuration/#security-best-practices","title":"Security Best Practices","text":""},{"location":"skills/configuration/#1-protect-your-api-key","title":"1. Protect Your API Key","text":"<pre><code># Don't commit config.json to git\necho \"config.json\" &gt;&gt; .gitignore\n</code></pre>"},{"location":"skills/configuration/#2-use-environment-variables-in-cicd","title":"2. Use Environment Variables in CI/CD","text":"<pre><code># GitHub Actions example\nenv:\n  GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}\n</code></pre>"},{"location":"skills/configuration/#3-rotate-keys-regularly","title":"3. Rotate Keys Regularly","text":"<p>For production use, rotate API keys periodically: 1. Generate new key in Google AI Studio 2. Update configuration 3. Revoke old key</p>"},{"location":"skills/configuration/#next-steps","title":"Next Steps","text":"<ul> <li>Commands Reference - All skill commands</li> <li>Examples - Usage examples</li> <li>GCS Storage Guide - Detailed GCS setup</li> <li>Authentication - API key details</li> </ul>"},{"location":"skills/examples/","title":"Skill Examples","text":"<p>Real-world examples of using the <code>/generative</code> skill for various use cases.</p>"},{"location":"skills/examples/#quick-examples","title":"Quick Examples","text":""},{"location":"skills/examples/#generate-a-simple-image","title":"Generate a Simple Image","text":"<pre><code>/generative image \"A serene lake at sunrise with mountains in the background\"\n</code></pre> <p>Result: A beautiful landscape image saved to <code>generated_images/</code></p>"},{"location":"skills/examples/#generate-a-simple-video","title":"Generate a Simple Video","text":"<pre><code>/generative video \"Ocean waves gently rolling onto a sandy beach\"\n</code></pre> <p>Result: A 5-second video saved to <code>generated_videos/</code></p>"},{"location":"skills/examples/#image-examples","title":"Image Examples","text":""},{"location":"skills/examples/#portrait-photography","title":"Portrait Photography","text":"<pre><code>/generative image \"Professional headshot of a young woman, studio lighting, neutral background\" --aspect-ratio 3:4\n</code></pre>"},{"location":"skills/examples/#landscape-photography","title":"Landscape Photography","text":"<pre><code>/generative image \"Dramatic mountain landscape at golden hour, snow-capped peaks, wide angle\" --aspect-ratio 16:9 --image-size 2K\n</code></pre>"},{"location":"skills/examples/#product-photography","title":"Product Photography","text":"<pre><code>/generative image \"Sleek smartphone on a marble surface, soft shadows, minimalist style\" --aspect-ratio 1:1\n</code></pre>"},{"location":"skills/examples/#abstract-art","title":"Abstract Art","text":"<pre><code>/generative image \"Abstract fluid art with vibrant blue and gold colors, swirling patterns\" --count 4\n</code></pre>"},{"location":"skills/examples/#social-media-content","title":"Social Media Content","text":"<pre><code>/generative image \"Motivational quote background, gradient sunset colors, minimalist\" --aspect-ratio 9:16\n</code></pre>"},{"location":"skills/examples/#video-examples","title":"Video Examples","text":""},{"location":"skills/examples/#cinematic-scenes","title":"Cinematic Scenes","text":"<pre><code>/generative video \"Cinematic shot of a city skyline at night, lights twinkling, slow camera pan\" --preset quality --duration 8\n</code></pre>"},{"location":"skills/examples/#nature-wildlife","title":"Nature &amp; Wildlife","text":"<pre><code>/generative video \"A butterfly landing on a flower in a meadow, macro shot, soft bokeh background\" --preset quality\n</code></pre>"},{"location":"skills/examples/#product-showcase","title":"Product Showcase","text":"<pre><code>/generative video \"360-degree rotation of a luxury watch on a velvet surface, dramatic lighting\" --aspect-ratio 1:1\n</code></pre>"},{"location":"skills/examples/#social-media-vertical","title":"Social Media (Vertical)","text":"<pre><code>/generative video \"Trendy fashion outfit reveal, vertical format for Instagram Reels\" --aspect-ratio 9:16 --duration 5\n</code></pre>"},{"location":"skills/examples/#fast-preview","title":"Fast Preview","text":"<pre><code>/generative video \"Quick test of a sunset timelapse\" --preset quick\n</code></pre>"},{"location":"skills/examples/#budget-friendly","title":"Budget-Friendly","text":"<pre><code>/generative video \"Simple animation for a presentation\" --preset budget\n</code></pre>"},{"location":"skills/examples/#advanced-examples","title":"Advanced Examples","text":""},{"location":"skills/examples/#image-to-video-animation","title":"Image-to-Video Animation","text":"<pre><code># Animate an existing image\n/generative video \"Animate this landscape photo with moving clouds and flowing water\" --image ./my-photo.jpg\n</code></pre>"},{"location":"skills/examples/#video-extension","title":"Video Extension","text":"<pre><code># Extend an existing video by 7 seconds\n/generative video \"Continue the action smoothly\" --extend ./my-video.mp4\n</code></pre>"},{"location":"skills/examples/#style-transfer","title":"Style Transfer","text":"<pre><code># Apply artistic style from a reference image\n/generative video \"A city street scene in this artistic style\" --style-image ./van-gogh.jpg\n</code></pre>"},{"location":"skills/examples/#subject-preservation","title":"Subject Preservation","text":"<pre><code># Use a character across multiple generations\n/generative video \"This character walking through a park\" --reference-image ./my-character.png\n</code></pre>"},{"location":"skills/examples/#workflow-examples","title":"Workflow Examples","text":""},{"location":"skills/examples/#create-marketing-content","title":"Create Marketing Content","text":"<pre><code># Step 1: Generate hero image\n/generative image \"Modern SaaS dashboard interface, clean design, blue accent colors\" --aspect-ratio 16:9 --image-size 2K\n\n# Step 2: Create promotional video\n/generative video \"Animated showcase of the dashboard with smooth transitions\" --preset quality --duration 8\n\n# Step 3: Generate social media versions\n/generative image \"Same dashboard concept, vertical format\" --aspect-ratio 9:16\n</code></pre>"},{"location":"skills/examples/#create-a-video-series","title":"Create a Video Series","text":"<pre><code># Part 1: Opening scene\n/generative video \"Sunrise over a peaceful village, establishing shot\" --preset quality\n\n# Part 2: Extend the scene\n/generative video \"Camera slowly moves through the village streets\" --extend ./part1.mp4\n\n# Part 3: Continue story\n/generative video \"Arriving at a cozy caf\u00e9\" --extend ./part2.mp4\n</code></pre>"},{"location":"skills/examples/#batch-generation","title":"Batch Generation","text":"<pre><code># Generate multiple variations\n/generative image \"Abstract background for presentation\" --count 4\n\n# Pick the best one and create video version\n/generative video \"Animate this abstract background with subtle motion\" --image ./best-image.png\n</code></pre>"},{"location":"skills/examples/#tips-for-better-results","title":"Tips for Better Results","text":""},{"location":"skills/examples/#1-detailed-prompts-work-better","title":"1. Detailed Prompts Work Better","text":"<pre><code># Instead of:\n/generative video \"a dog\"\n\n# Try:\n/generative video \"A golden retriever puppy playing fetch in a sunny park, slow motion capture, warm afternoon light, shallow depth of field\"\n</code></pre>"},{"location":"skills/examples/#2-specify-camera-movement","title":"2. Specify Camera Movement","text":"<pre><code>/generative video \"Aerial drone shot flying over a tropical beach, camera slowly descending toward the water\"\n</code></pre>"},{"location":"skills/examples/#3-include-lighting-details","title":"3. Include Lighting Details","text":"<pre><code>/generative video \"Portrait of a person with dramatic Rembrandt lighting, dark background, moody atmosphere\"\n</code></pre>"},{"location":"skills/examples/#4-reference-artistic-styles","title":"4. Reference Artistic Styles","text":"<pre><code>/generative video \"Cyberpunk city at night in the style of Blade Runner, neon lights, rain-soaked streets\"\n</code></pre>"},{"location":"skills/examples/#5-use-quality-keywords","title":"5. Use Quality Keywords","text":"<pre><code>/generative video \"Ultra HD, 4K quality, professional cinematography, cinematic color grading\"\n</code></pre>"},{"location":"skills/examples/#cost-conscious-examples","title":"Cost-Conscious Examples","text":""},{"location":"skills/examples/#quick-tests-lowest-cost","title":"Quick Tests (Lowest Cost)","text":"<pre><code># Use quick preset for testing ideas\n/generative video \"Test prompt\" --preset quick\n\n# Estimate cost before full quality\n/generative video \"My final prompt\" --estimate-cost\n</code></pre>"},{"location":"skills/examples/#budget-production","title":"Budget Production","text":"<pre><code># Use budget preset for production\n/generative video \"Promotional video\" --preset budget --duration 5\n</code></pre>"},{"location":"skills/examples/#quality-when-it-matters","title":"Quality When It Matters","text":"<pre><code># Reserve quality preset for final output\n/generative video \"Hero video for website\" --preset quality --duration 8\n</code></pre>"},{"location":"skills/examples/#next-steps","title":"Next Steps","text":"<ul> <li>Commands Reference - Full command documentation</li> <li>Configuration - Setup and API configuration</li> <li>Video Modes - All 8 video generation modes</li> </ul>"},{"location":"skills/overview/","title":"Using Skills","text":"<p>The <code>/generative</code> skill provides AI-assisted video and image generation directly in Claude Code - the easiest way to use this project.</p>"},{"location":"skills/overview/#why-use-skills","title":"Why Use Skills?","text":"Method Ease of Use Best For Skill (<code>/generative</code>)  Easiest Most users, quick generation Script (<code>python video_gen.py</code>)  Manual Automation, CI/CD, advanced users <p>Recommended</p> <p>If you're using Claude Code, the <code>/generative</code> skill is the recommended way to generate media. It handles everything automatically - no need to remember command-line arguments.</p>"},{"location":"skills/overview/#what-is-the-generative-skill","title":"What is the /generative Skill?","text":"<p>The <code>/generative</code> skill is a Claude Code skill that:</p> <ul> <li> Understands natural language - Just describe what you want</li> <li> Auto-configures - Sets up optimal parameters automatically</li> <li> Handles errors - Provides helpful error messages</li> <li> Quick access - Type <code>/generative</code> and go</li> </ul>"},{"location":"skills/overview/#quick-start","title":"Quick Start","text":""},{"location":"skills/overview/#1-install-the-skill","title":"1. Install the Skill","text":"<pre><code># Clone repository\ngit clone https://github.com/DarKWinGTM/claude-code-media-generator.git\ncd claude-code-media-generator\n\n# Install skill\nmkdir -p ~/.claude/skills/generative\ncp .claude/skills/generative/SKILL.md ~/.claude/skills/generative/\n\n# Install dependencies\npip install requests google-auth\n\n# Restart Claude Code\n</code></pre>"},{"location":"skills/overview/#2-configure-api","title":"2. Configure API","text":"<pre><code># In Claude Code, run:\n/generative config setup\n</code></pre> <p>The wizard will guide you through API configuration.</p>"},{"location":"skills/overview/#3-generate-media","title":"3. Generate Media","text":"<pre><code># Generate an image\n/generative image \"A beautiful sunset over mountains\"\n\n# Generate a video\n/generative video \"Ocean waves crashing on the beach\"\n</code></pre>"},{"location":"skills/overview/#skill-vs-script-comparison","title":"Skill vs Script Comparison","text":""},{"location":"skills/overview/#using-skill-recommended","title":"Using Skill (Recommended)","text":"<pre><code># Natural language - skill figures out the rest\n/generative video \"Create a cinematic sunset with warm colors\"\n\n# The skill automatically:\n# - Chooses appropriate model (veo-3.1)\n# - Sets optimal duration (5-8s)\n# - Applies quality settings\n# - Handles API calls\n</code></pre>"},{"location":"skills/overview/#using-script-advanced","title":"Using Script (Advanced)","text":"<pre><code># Manual - you specify everything\npython video_gen.py \"A cinematic sunset\" \\\n  --model veo-3.1-generate-preview \\\n  --duration 8 \\\n  --aspect-ratio 16:9 \\\n  --preset quality\n</code></pre>"},{"location":"skills/overview/#what-gets-installed","title":"What Gets Installed","text":"Component Location Purpose <code>SKILL.md</code> <code>~/.claude/skills/generative/</code> Skill definition (1,500+ lines) <code>video_gen.py</code> Working directory Video generation CLI <code>image_gen.py</code> Working directory Image generation CLI <code>config.py</code> Working directory Configuration module <code>video_utils.py</code> Working directory Video utilities"},{"location":"skills/overview/#next-steps","title":"Next Steps","text":"<ul> <li>Agent - Auto-detect media creation intent (recommended)</li> <li>Commands Reference - All <code>/generative</code> commands</li> <li>Examples - Usage examples</li> <li>Configuration - Setup and configuration options</li> </ul>"},{"location":"video/extension/","title":"Video Extension","text":"<p>Extend existing videos with AI-generated content.</p>"},{"location":"video/extension/#overview","title":"Overview","text":"<p>Video extension allows you to continue an existing video with new AI-generated content. The AI analyzes the last frames and generates continuation based on your prompt.</p>"},{"location":"video/extension/#requirements","title":"Requirements","text":""},{"location":"video/extension/#critical-requirements","title":"Critical Requirements","text":"Requirement Details Frame Rate Source video MUST be 24fps Model veo-2.0, veo-2.0-exp, or veo-3.1-generate-preview Source Local file or GCS URI (NOT external URLs)"},{"location":"video/extension/#why-24fps","title":"Why 24fps?","text":"<p>The Veo API only accepts 24fps videos for extension. Videos with different frame rates will fail with \"fps mismatch\" error.</p>"},{"location":"video/extension/#basic-usage","title":"Basic Usage","text":"<pre><code># Extend a local video\npython video_gen.py \"The cat runs faster\" \\\n  --extend-video previous_video.mp4 \\\n  --model veo-2.0\n\n# Extend with GCS storage\npython video_gen.py \"Continue the scene\" \\\n  --extend-video previous_video.mp4 \\\n  --storage-uri gs://my-bucket/videos \\\n  --model veo-2.0\n</code></pre>"},{"location":"video/extension/#source-options","title":"Source Options","text":""},{"location":"video/extension/#local-file","title":"Local File","text":"<pre><code>python video_gen.py \"Continue scene\" \\\n  --extend-video /path/to/video.mp4\n</code></pre> <p>The script will:</p> <ol> <li>Check if video is 24fps</li> <li>Upload to GCS if <code>--storage-uri</code> provided</li> <li>Use base64 encoding if no GCS</li> </ol>"},{"location":"video/extension/#gcs-uri","title":"GCS URI","text":"<pre><code>python video_gen.py \"Continue scene\" \\\n  --extend-video gs://my-bucket/videos/source.mp4\n</code></pre> <p>Direct GCS URI is faster - no upload needed.</p>"},{"location":"video/extension/#with-reference-images","title":"With Reference Images","text":"<p>Combine extension with reference images:</p> <pre><code>python video_gen.py \"The person continues walking\" \\\n  --extend-video previous.mp4 \\\n  --reference-image avatar.png:asset \\\n  --model veo-2.0\n</code></pre>"},{"location":"video/extension/#with-last-frame","title":"With Last Frame","text":"<p>Specify where the video should end:</p> <pre><code>python video_gen.py \"Transform to sunset\" \\\n  --extend-video daytime.mp4 \\\n  --last-frame sunset.jpg \\\n  --model veo-2.0\n</code></pre>"},{"location":"video/extension/#workflow-creating-long-videos","title":"Workflow: Creating Long Videos","text":"<p>Chain multiple extensions to create longer videos:</p> <pre><code># Step 1: Generate initial video\npython video_gen.py \"A person walking\" --preset quality\n# Output: video_001.mp4\n\n# Step 2: Extend first video\npython video_gen.py \"The person starts running\" \\\n  --extend-video video_001.mp4 --model veo-2.0\n# Output: video_002.mp4\n\n# Step 3: Extend again\npython video_gen.py \"The person jumps over obstacle\" \\\n  --extend-video video_002.mp4 --model veo-2.0\n# Output: video_003.mp4\n\n# Combine with ffmpeg\nffmpeg -i \"concat:video_001.mp4|video_002.mp4|video_003.mp4\" -c copy final.mp4\n</code></pre>"},{"location":"video/extension/#common-issues","title":"Common Issues","text":""},{"location":"video/extension/#fps-mismatch","title":"\"fps mismatch\"","text":"<p>Problem: Source video is not 24fps</p> <p>Solution: Convert to 24fps using ffmpeg:</p> <pre><code>ffmpeg -i input.mp4 -r 24 -c:v libx264 output_24fps.mp4\n</code></pre>"},{"location":"video/extension/#video-is-empty","title":"\"video is empty\"","text":"<p>Problem: External URL used (not supported)</p> <p>Solution: Download video first, then use local file:</p> <pre><code># Download video\ncurl -o local_video.mp4 \"https://example.com/video.mp4\"\n\n# Convert to 24fps if needed\nffmpeg -i local_video.mp4 -r 24 local_24fps.mp4\n\n# Use local file\npython video_gen.py \"Continue\" --extend-video local_24fps.mp4\n</code></pre>"},{"location":"video/extension/#model-does-not-support-video_extension","title":"\"Model does not support video_extension\"","text":"<p>Problem: Using unsupported model (e.g., veo-3.0)</p> <p>Solution: Use supported models:</p> <pre><code>python video_gen.py \"Continue\" \\\n  --extend-video input.mp4 \\\n  --model veo-3.1-generate-preview  # or veo-2.0\n</code></pre> <p>Supported models for video extension: - <code>veo-3.1-generate-preview</code> \u2705 - <code>veo-2.0</code> \u2705 - <code>veo-2.0-exp</code> \u2705</p>"},{"location":"video/extension/#smart-defaults-new-in-v2251","title":"Smart Defaults (New in v2.25.1)","text":"<p>When extending a video, settings are automatically inherited from the source video's metadata:</p>"},{"location":"video/extension/#how-it-works","title":"How It Works","text":"<pre><code># Original video was created with:\n# - model: veo-2.0\n# - resolution: 1080p\n# - storage-uri: gs://my-bucket/videos\n\n# Just specify the prompt - settings are inherited\npython video_gen.py \"Continue the scene\" --extend-video video_20260201_123456_0.mp4\n\n# Output:\n# \u2139 Found source metadata for inheritance\n# \u2139 Inherited model from metadata: veo-2.0\n# \u2139 Inherited resolution from metadata: 1080p\n# \u2139 Inherited storage_uri from metadata: gs://my-bucket/videos\n</code></pre>"},{"location":"video/extension/#priority-chain","title":"Priority Chain","text":"<p>Settings are resolved in this order:</p> <ol> <li>CLI Arguments (highest) - What you type</li> <li>Source Metadata - From the source video</li> <li>config.json - Your project settings</li> <li>Code Defaults (lowest) - Built-in fallbacks</li> </ol>"},{"location":"video/extension/#override-when-needed","title":"Override When Needed","text":"<p>You can always override inherited values:</p> <pre><code># Override model (ignore metadata)\npython video_gen.py \"Continue\" \\\n  --extend-video video.mp4 \\\n  --model veo-2.0-exp\n\n# Override resolution\npython video_gen.py \"Continue\" \\\n  --extend-video video.mp4 \\\n  --resolution 720p\n</code></pre> <p>Chained Extensions</p> <p>Smart Defaults work perfectly for chained extensions. Each video inherits from its predecessor: <pre><code>video_001.mp4 \u2192 video_002.mp4 \u2192 video_003.mp4\n# All use same model, resolution, storage settings\n</code></pre></p>"},{"location":"video/extension/#auto-upload-feature","title":"Auto-Upload Feature","text":"<p>When <code>--storage-uri</code> is provided, local files are automatically uploaded:</p> <pre><code>python video_gen.py \"Continue scene\" \\\n  --extend-video local_video.mp4 \\\n  --storage-uri gs://my-bucket/uploads\n</code></pre> <p>Flow: <pre><code>Local file \u2192 Upload to GCS \u2192 Use gcsUri in API \u2192 Generate \u2192 Download\n</code></pre></p>"},{"location":"video/extension/#best-practices","title":"Best Practices","text":""},{"location":"video/extension/#do","title":"Do","text":"<ul> <li> Use Veo-generated videos (always 24fps)</li> <li> Use <code>--storage-uri</code> for reliable uploads</li> <li> Use supported models (<code>veo-2.0</code>, <code>veo-2.0-exp</code>, or <code>veo-3.1-generate-preview</code>)</li> <li> Keep prompts consistent with source video</li> </ul>"},{"location":"video/extension/#dont","title":"Don't","text":"<ul> <li> Use external URLs directly</li> <li> Use unsupported models (e.g., veo-3.0)</li> <li> Use videos with non-24fps frame rate</li> <li> Create drastic scene changes</li> </ul>"},{"location":"video/extension/#planned-features-v225","title":"Planned Features (v2.25)","text":"<p>Future version will support:</p> <pre><code># Planned: Auto-download and convert external URLs\npython video_gen.py \"Continue\" \\\n  --extend-video-from-url \"https://example.com/video.mp4\"\n</code></pre> <p>This will:</p> <ol> <li>Download video from URL</li> <li>Convert to 24fps using ffmpeg</li> <li>Upload to GCS</li> <li>Proceed with extension</li> </ol>"},{"location":"video/extension/#learn-more","title":"Learn More","text":"<ul> <li>Generation Modes - All generation modes</li> <li>Video Models - Model comparison</li> <li>Reference Images - Using references with extension</li> <li>GCS Storage - Setting up GCS</li> </ul>"},{"location":"video/models/","title":"Video Models","text":"<p>Comparison of available Veo models.</p>"},{"location":"video/models/#available-models","title":"Available Models","text":""},{"location":"video/models/#veo-31-generate-preview-recommended","title":"veo-3.1-generate-preview (Recommended)","text":"Feature Value Audio  Yes - generates with sound Quality Best - highest resolution Video Extension  Supported Cost $$$ Higher <p>Best for: Final production, videos with audio, video extension</p> <pre><code>python video_gen.py \"A waterfall\" --model veo-3.1-generate-preview\n</code></pre>"},{"location":"video/models/#veo-31-fast-generate-preview","title":"veo-3.1-fast-generate-preview","text":"Feature Value Audio  Yes Quality Good - faster generation Video Extension  Not supported Cost $$ Medium <p>Best for: Quick previews, drafts</p> <pre><code>python video_gen.py \"A waterfall\" --model veo-3.1-fast-generate-preview\n# Or use preset\npython video_gen.py \"A waterfall\" --preset quick\n</code></pre>"},{"location":"video/models/#veo-20","title":"veo-2.0","text":"Feature Value Audio  No Quality Good Video Extension  Supported Cost $$ Medium <p>Best for: Video extension without audio, chaining videos</p> <pre><code>python video_gen.py \"A waterfall\" --model veo-2.0\n# Also supports video extension\npython video_gen.py \"Continue scene\" --extend-video input.mp4 --model veo-2.0\n</code></pre>"},{"location":"video/models/#veo-20-exp","title":"veo-2.0-exp","text":"Feature Value Audio  No Quality Good Video Extension  Supported Reference Style  Supported Cost $$ Medium <p>Best for: Style transfer, experimental features</p> <pre><code>python video_gen.py \"A cityscape\" \\\n  --model veo-2.0-exp \\\n  --reference-image painting.jpg:style\n</code></pre>"},{"location":"video/models/#feature-comparison-matrix","title":"Feature Comparison Matrix","text":"Feature veo-3.1 veo-3.1-fast veo-2.0 veo-2.0-exp Audio Generation Video Extension Reference Style Reference Asset Insert/Remove Objects Generation Speed Medium Fast Medium Medium Quality Best Good Good Good"},{"location":"video/models/#model-selection-guide","title":"Model Selection Guide","text":"<pre><code>Need audio?\n  \u2192 YES: veo-3.1-generate-preview (also supports extension)\n  \u2192 NO: Continue below\n\nNeed video extension?\n  \u2192 YES: veo-3.1-generate-preview, veo-2.0, or veo-2.0-exp\n  \u2192 NO: Continue below\n\nNeed style transfer?\n  \u2192 YES: veo-2.0-exp\n  \u2192 NO: Continue below\n\nNeed fast preview?\n  \u2192 YES: veo-3.1-fast-generate-preview\n  \u2192 NO: veo-3.1-generate-preview\n</code></pre>"},{"location":"video/models/#using-presets","title":"Using Presets","text":"<p>Presets automatically select the best model:</p> Preset Model Duration Use Case <code>quick</code> veo-3.1-fast 5s Fast preview <code>quality</code> veo-3.1-generate 8s Production <code>extend</code> veo-3.1-generate 7s Video extension <code>budget</code> veo-3.0-fast 5s Cost saving <pre><code>python video_gen.py \"A waterfall\" --preset quality\n</code></pre>"},{"location":"video/models/#api-endpoints","title":"API Endpoints","text":"Model Gemini API Vertex AI veo-3.1-generate-preview veo-3.1-fast-generate-preview veo-2.0 veo-2.0-exp"},{"location":"video/models/#learn-more","title":"Learn More","text":"<ul> <li>Video Overview - Video generation overview</li> <li>Generation Modes - All generation modes</li> <li>Presets - Using presets</li> </ul>"},{"location":"video/modes/","title":"Video Generation Modes","text":"<p>All 9 video generation modes explained with examples.</p>"},{"location":"video/modes/#text-to-video","title":"Text-to-Video","text":"<p>Generate video from text prompt only.</p> <p>Usage: <pre><code>python video_gen.py \"A cat walking in a garden\"\n</code></pre></p> <p>Parameters:</p> <ul> <li><code>prompt</code> - Description of the video (required)</li> <li><code>--duration</code> - 5-8 seconds (default: 5)</li> <li><code>--aspect-ratio</code> - 16:9, 9:16, 1:1 (default: 16:9)</li> </ul> <p>Best for: Simple scenes, abstract concepts, quick prototypes</p>"},{"location":"video/modes/#image-to-video","title":"Image-to-Video","text":"<p>Animate a static image into video.</p> <p>Usage: <pre><code>python video_gen.py \"The cat starts dancing\" --image cat.jpg\n</code></pre></p> <p>Parameters:</p> <ul> <li><code>prompt</code> - Description of motion (required)</li> <li><code>--image</code> - First frame image (required)</li> </ul> <p>Supported formats: JPEG, PNG, WebP</p> <p>Best for: Animating photos, product demos, character animation</p>"},{"location":"video/modes/#first-last-frames","title":"First &amp; Last Frames","text":"<p>Create video that interpolates between two images.</p> <p>Usage: <pre><code>python video_gen.py \"Smooth transition\" \\\n  --image start.jpg \\\n  --last-frame end.jpg\n</code></pre></p> <p>Parameters:</p> <ul> <li><code>--image</code> - First frame (required)</li> <li><code>--last-frame</code> - Last frame (required)</li> </ul> <p>Best for: Morphing effects, transitions, storytelling</p>"},{"location":"video/modes/#video-extension","title":"Video Extension","text":"<p>Extend an existing video with new content.</p> <p>Usage: <pre><code>python video_gen.py \"The cat runs faster\" \\\n  --extend-video previous_video.mp4 \\\n  --model veo-2.0\n</code></pre></p> <p>Parameters:</p> <ul> <li><code>--extend-video</code> - Source video to extend (required)</li> <li><code>--storage-uri</code> - GCS bucket for upload (recommended)</li> </ul> <p>Requirements</p> <ul> <li>Source video MUST be 24fps</li> <li>Use GCS URI or local file (external URLs not supported)</li> <li>Use model with video_extension support (veo-2.0)</li> </ul> <p>Best for: Creating longer videos, continuing scenes</p> <p>See Video Extension for detailed guide.</p>"},{"location":"video/modes/#reference-asset","title":"Reference Asset","text":"<p>Use up to 3 reference images to preserve subject identity.</p> <p>Usage: <pre><code># Single reference\npython video_gen.py \"A person waving\" \\\n  --reference-image avatar.png:asset\n\n# Multiple references (same subject, different angles)\npython video_gen.py \"A person waving\" \\\n  --reference-image front.png:asset \\\n  --reference-image side.png:asset \\\n  --reference-image back.png:asset\n</code></pre></p> <p>Parameters:</p> <ul> <li><code>--reference-image PATH:asset</code> - Reference image with type</li> <li>Maximum 3 asset images</li> </ul> <p>Best for: Consistent character, product videos</p> <p>See Reference Images for detailed guide.</p>"},{"location":"video/modes/#reference-style","title":"Reference Style","text":"<p>Apply visual style from a reference image.</p> <p>Usage: <pre><code>python video_gen.py \"A cityscape\" \\\n  --reference-image painting.jpg:style \\\n  --model veo-2.0-exp\n</code></pre></p> <p>Parameters:</p> <ul> <li><code>--reference-image PATH:style</code> - Style reference image</li> <li>Maximum 1 style image</li> <li>Only supported on <code>veo-2.0-exp</code> model</li> </ul> <p>Best for: Style transfer, artistic effects</p>"},{"location":"video/modes/#insert-objects","title":"Insert Objects","text":"<p>Add new objects to existing video using mask.</p> <p>Usage: <pre><code>python video_gen.py \"Add a flying bird\" \\\n  --video source.mp4 \\\n  --mask bird_area.png \\\n  --mask-mode insert\n</code></pre></p> <p>Parameters:</p> <ul> <li><code>--video</code> - Source video (required)</li> <li><code>--mask</code> - Mask image defining insert area (required)</li> <li><code>--mask-mode insert</code> - Set mode to insert (required)</li> </ul> <p>Best for: Adding elements, VFX</p>"},{"location":"video/modes/#remove-objects","title":"Remove Objects","text":"<p>Remove objects from existing video using mask.</p> <p>Usage: <pre><code>python video_gen.py \"Remove the watermark\" \\\n  --video source.mp4 \\\n  --mask watermark_area.png \\\n  --mask-mode remove\n</code></pre></p> <p>Parameters:</p> <ul> <li><code>--video</code> - Source video (required)</li> <li><code>--mask</code> - Mask image defining remove area (required)</li> <li><code>--mask-mode remove</code> - Set mode to remove (required)</li> </ul> <p>Best for: Removing unwanted elements, cleanup</p>"},{"location":"video/modes/#remix-mode","title":"Remix Mode","text":"<p>Extract frames from an existing video and regenerate with a new prompt.</p> <p>Usage: <pre><code># Simple remix (first frame only \u2192 Image-to-Video)\npython video_gen.py \"Make the cat run faster\" --remix cat_walking.mp4\n\n# With last frame (\u2192 First &amp; Last Frames mode)\npython video_gen.py \"Transform to anime style\" --remix video.mp4 --remix-last-frame\n\n# Long video - select section (0:10 to 0:18)\npython video_gen.py \"Add dramatic lighting\" --remix long_video.mp4 --remix-start 0:10 --remix-end 0:18\n</code></pre></p> <p>Parameters:</p> <ul> <li><code>--remix VIDEO</code> - Source video to remix (required)</li> <li><code>--remix-last-frame</code> - Also extract last frame for better control</li> <li><code>--remix-start M:SS</code> - Start time for frame extraction</li> <li><code>--remix-end M:SS</code> - End time for frame extraction</li> </ul> <p>How it works:</p> <ol> <li>Extracts frame(s) from the source video</li> <li>Uses extracted frame(s) as input for generation</li> <li>First frame only \u2192 Image-to-Video mode</li> <li>First + Last frames \u2192 First &amp; Last Frames mode</li> </ol> <p>Best for: Restyling videos, creating variations, extracting key frames</p>"},{"location":"video/modes/#mode-detection","title":"Mode Detection","text":"<p>The script automatically detects mode based on provided arguments:</p> Arguments Detected Mode prompt only text_to_video prompt + --image image_to_video prompt + --image + --last-frame first_and_last_frames prompt + --extend-video video_extension prompt + --reference-image:asset reference_asset prompt + --reference-image:style reference_style prompt + --video + --mask-mode insert insert_objects prompt + --video + --mask-mode remove remove_objects prompt + --remix remix_mode (\u2192 image_to_video) prompt + --remix + --remix-last-frame remix_mode (\u2192 first_and_last_frames)"},{"location":"video/modes/#model-compatibility","title":"Model Compatibility","text":"Mode veo-3.1 veo-3.1-fast veo-2.0 veo-2.0-exp text_to_video image_to_video first_and_last video_extension reference_asset reference_style insert_objects remove_objects remix_mode"},{"location":"video/modes/#learn-more","title":"Learn More","text":"<ul> <li>Video Overview - Back to overview</li> <li>Video Models - Detailed model comparison</li> <li>Reference Images - Reference image guide</li> <li>Video Extension - Video extension guide</li> </ul>"},{"location":"video/overview/","title":"Video Generation Overview","text":"<p>Generate AI videos using Google Veo models with 8 different generation modes.</p>"},{"location":"video/overview/#supported-models","title":"Supported Models","text":"Model Audio Extension Quality Cost veo-3.1-generate-preview  Yes  Yes Best $$$ veo-3.1-fast-generate-preview  Yes  No Good $$ veo-2.0  No  Yes Good $$ veo-2.0-exp  No  Yes Good $$ <p>Recommended</p> <p>Use <code>veo-3.1-generate-preview</code> for best quality with audio.</p>"},{"location":"video/overview/#generation-modes","title":"Generation Modes","text":"Mode Description Required Inputs Text-to-Video Generate from text only Prompt Image-to-Video Animate from image Prompt + Image First &amp; Last Frames Interpolate two images Prompt + 2 Images Video Extension Extend existing video Prompt + Video Reference Asset Preserve subject Prompt + 1-3 Images Reference Style Apply style Prompt + Style Image Insert Objects Add to video Prompt + Video + Mask Remove Objects Remove from video Prompt + Video + Mask"},{"location":"video/overview/#quick-examples","title":"Quick Examples","text":"<pre><code># Text-to-Video\npython video_gen.py \"A cat walking in a garden\"\n\n# Image-to-Video\npython video_gen.py \"The cat starts running\" --image cat.jpg\n\n# Video Extension\npython video_gen.py \"Continue the scene\" --extend-video previous.mp4\n\n# Reference Asset (preserve subject)\npython video_gen.py \"A person dancing\" --reference-image avatar.png:asset\n</code></pre>"},{"location":"video/overview/#output-specifications","title":"Output Specifications","text":"Setting Options Duration 5s, 6s, 7s, 8s (default: 5s) Aspect Ratio 16:9, 9:16, 1:1 Resolution 720p (16:9), 1280x720 Frame Rate 24 fps Format MP4"},{"location":"video/overview/#api-method","title":"API Method","text":"<p>Video generation uses <code>predictLongRunning</code> (asynchronous):</p> <pre><code>Request \u2192 Operation ID \u2192 Poll for completion \u2192 Download video\n</code></pre> <p>Typical generation time: 60-180 seconds</p>"},{"location":"video/overview/#cost-overview","title":"Cost Overview","text":"Model Per Video (5s) veo-3.1-generate-preview ~$0.50 veo-3.1-fast-generate-preview ~$0.25 veo-2.0 ~$0.20 <p>Cost Estimation</p> <p>Use <code>--estimate-cost</code> to preview cost before generating.</p>"},{"location":"video/overview/#smart-defaults-new-in-v2251","title":"Smart Defaults (New in v2.25.1)","text":"<p>When extending a video, settings are automatically inherited from the source:</p> <pre><code># Settings inherited automatically from source video\npython video_gen.py \"Continue the scene\" --extend-video video.mp4\n\n# \u2139 Inherited model from metadata: veo-2.0\n# \u2139 Inherited resolution from metadata: 1080p\n</code></pre> <p>Video Extension Models</p> <p>Video extension is supported by <code>veo-2.0</code>, <code>veo-2.0-exp</code>, and <code>veo-3.1-generate-preview</code>.</p> <p>See CLI Reference - Smart Defaults for details.</p>"},{"location":"video/overview/#learn-more","title":"Learn More","text":"<ul> <li>Generation Modes - All 8 modes in detail</li> <li>Video Models - Model comparison</li> <li>Reference Images - Using reference images</li> <li>Video Extension - Extending videos</li> </ul>"},{"location":"video/reference-images/","title":"Reference Images","text":"<p>Guide to using reference images for subject preservation and style transfer.</p>"},{"location":"video/reference-images/#overview","title":"Overview","text":"<p>Reference images help the AI understand what you want:</p> <ul> <li>Reference Asset - Preserve subject identity (face, product, character)</li> <li>Reference Style - Apply visual style (art style, color palette)</li> </ul>"},{"location":"video/reference-images/#unified-format-v224","title":"Unified Format (v2.24)","text":"<p>Use <code>--reference-image PATH:TYPE</code> format:</p> <pre><code># Asset type (default if not specified)\n--reference-image avatar.png:asset\n\n# Style type\n--reference-image painting.jpg:style\n\n# Without type (defaults to asset)\n--reference-image avatar.png\n</code></pre>"},{"location":"video/reference-images/#reference-asset","title":"Reference Asset","text":"<p>Preserve subject identity across the video.</p>"},{"location":"video/reference-images/#single-reference","title":"Single Reference","text":"<pre><code>python video_gen.py \"A person waving hello\" \\\n  --reference-image avatar.png:asset\n</code></pre>"},{"location":"video/reference-images/#multiple-references-max-3","title":"Multiple References (Max 3)","text":"<p>Use multiple images of the same subject from different angles:</p> <pre><code>python video_gen.py \"A person dancing\" \\\n  --reference-image front.png:asset \\\n  --reference-image side.png:asset \\\n  --reference-image back.png:asset\n</code></pre>"},{"location":"video/reference-images/#best-practices","title":"Best Practices","text":"<ul> <li> Use clear, well-lit photos</li> <li> Show the subject from different angles</li> <li> Keep consistent lighting across references</li> <li> Don't mix different subjects</li> <li> Don't use blurry images</li> </ul>"},{"location":"video/reference-images/#reference-style","title":"Reference Style","text":"<p>Apply visual style from a reference image.</p> <pre><code>python video_gen.py \"A cityscape at sunset\" \\\n  --reference-image impressionist_painting.jpg:style \\\n  --model veo-2.0-exp\n</code></pre>"},{"location":"video/reference-images/#requirements","title":"Requirements","text":"<p>Model Requirement</p> <ul> <li>Only supported on <code>veo-2.0-exp</code> model</li> <li>Maximum 1 style image per request</li> <li>Cannot mix with asset references</li> </ul>"},{"location":"video/reference-images/#best-practices_1","title":"Best Practices","text":"<ul> <li> Use distinctive art styles</li> <li> Choose high-quality style references</li> <li> Match style to content theme</li> <li> Don't use photos as style (use asset instead)</li> </ul>"},{"location":"video/reference-images/#api-limitations","title":"API Limitations","text":""},{"location":"video/reference-images/#cannot-mix-types","title":"Cannot Mix Types","text":"<p>The API does not support mixing asset and style in the same request:</p> <pre><code># \u274c This will fail\npython video_gen.py \"A person\" \\\n  --reference-image avatar.png:asset \\\n  --reference-image painting.jpg:style\n\n# Error: \"does not support this mix\"\n</code></pre>"},{"location":"video/reference-images/#solution-use-one-type","title":"Solution: Use One Type","text":"<pre><code># \u2705 Assets only\npython video_gen.py \"A person dancing\" \\\n  --reference-image front.png:asset \\\n  --reference-image side.png:asset\n\n# \u2705 Style only\npython video_gen.py \"A landscape\" \\\n  --reference-image watercolor.jpg:style\n</code></pre>"},{"location":"video/reference-images/#limits-summary","title":"Limits Summary","text":"Type Maximum Model Support Asset 3 images All Veo models Style 1 image veo-2.0-exp only Mixed  Not allowed -"},{"location":"video/reference-images/#with-video-extension","title":"With Video Extension","text":"<p>You can combine reference images with video extension:</p> <pre><code>python video_gen.py \"The person continues walking\" \\\n  --extend-video previous.mp4 \\\n  --reference-image avatar.png:asset \\\n  --model veo-2.0\n</code></pre>"},{"location":"video/reference-images/#legacy-parameters-deprecated","title":"Legacy Parameters (Deprecated)","text":"<p>The following are deprecated but still work:</p> <pre><code># Deprecated - still works\n--reference-asset avatar.png\n--reference-style painting.jpg\n\n# Recommended - use instead\n--reference-image avatar.png:asset\n--reference-image painting.jpg:style\n</code></pre>"},{"location":"video/reference-images/#troubleshooting","title":"Troubleshooting","text":""},{"location":"video/reference-images/#reference-type-not-supported","title":"\"Reference type not supported\"","text":"<ul> <li>Check model compatibility</li> <li>Style only works with veo-2.0-exp</li> </ul>"},{"location":"video/reference-images/#too-many-references","title":"\"Too many references\"","text":"<ul> <li>Maximum 3 asset images</li> <li>Maximum 1 style image</li> </ul>"},{"location":"video/reference-images/#mixed-types-not-supported","title":"\"Mixed types not supported\"","text":"<ul> <li>Use only asset OR only style in one request</li> <li>Cannot combine both</li> </ul>"},{"location":"video/reference-images/#learn-more","title":"Learn More","text":"<ul> <li>Generation Modes - All generation modes</li> <li>Video Models - Model compatibility</li> <li>Video Extension - Combining with extension</li> </ul>"}]}